"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){var e="poly-",o=t(document);t.fn.polyEditor=function(n){if(!n.image)throw new Error("Missing image");var a,i,r,s=t(new Image).attr({src:n.image,"class":e+"image"}).attr("class",e+"image-element"),l=t(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr({"class":e+"svg-element",version:"1.1",xmlns:"http://www.w3.org/2000/svg"}),f=t.mk("div").attr("class",e+"svg-wrap").append(l),c=this.first().addClass(e+"wrap"),p=t.mk("span").attr("title","Mouse position").attr("class",e+"mousepos").text("?, ?"),u=t.mk("span").attr("title","Image top left").attr("class",e+"imgtl").text("?, ?"),d=t.mk("span").attr("title","Image center").attr("class",e+"imgc").text("?, ?"),m=t.mk("span").attr("title","Wrapper center").attr("class",e+"wrapc").text("?, ?"),h=t.mk("cpan").attr("class",e+"imgc-expected"),g=function(t,e){var o=y(),n=t.left,a=t.top,i=o.left,r=o.top,s=i+e*(n-i),l=r+e*(a-r);return{top:l,left:s}},v=function(t){var e=b();return{top:t.top-e.top,left:t.left-e.left}},w=function(t,e){var o=b();return{top:t.top-o.top+e.height/2,left:t.left-o.left+e.width/2}},y=function(){return{top:i/2,left:a/2}},b=function(){var t=c.offset();return t.top-=(i-c.outerHeight())/2,t.left-=(a-c.outerWidth())/2,t},k=function(){D.text(t.roundTo(100*z,2)+"%"),document.activeElement.blur(),H[z<=.1?"disable":"enable"](),E[z>=2.5?"disable":"enable"]()},x=function(e,o,n){if(k(),"number"==typeof e){u.text(t.roundTo(e,2)+","+t.roundTo(o,2));var a=w(s.offset(),n);d.text(t.roundTo(a.top,2)+","+t.roundTo(a.left,2)),h.css({top:a.top-5,left:a.left-5});var i=y();m.text(t.roundTo(i.top,2)+","+t.roundTo(i.left,2))}},z=1,T=function(e){var o=s.data("size");if("object"===("undefined"==typeof o?"undefined":_typeof(o))){var n=t.rangeLimit(e,!1,.1,2.5),a=void 0,i=void 0;n!==z?(a=t.scaleResize(o.width,o.height,{scale:n}),i=z,z=a.scale):(a={width:s.width(),height:s.height()},i=z);var r=s.offset(),l=g(v(r),n/i);I.add(s).css({top:l.top,left:l.left,width:a.width,height:a.height}),x(l.top,l.left,a)}},D=t.mk("span").attr({"class":e+"zoom-perc",contenteditable:!0}).text("100%").on("keydown",function(e){if(t.isKey(Key.Enter,e)){e.preventDefault();var o=parseFloat(D.text(),10);isNaN(o)||T(o/100),x()}}).on("mousedown",function(){D.data("mousedown",!0)}).on("mouseup",function(){D.data("mousedown",!1)}).on("click",function(){D.data("focused")!==!0&&(D.data("focused",!0),D.select())}).on("dblclick",function(t){t.preventDefault(),D.select()}).on("blur",function(){D.data("mousedown")||D.data("focused",!1),0===D.html().trim().length&&k(),t.clearSelection()}),S=t.mk("button").attr("class",e+"zoom-fit typcn typcn typcn-arrow-minimise").on("click",function(e){var o=s.data("size");if("object"===("undefined"==typeof o?"undefined":_typeof(o))){e.preventDefault();var n=o.width>o.height,r=t.scaleResize(o.width,o.height,n?{height:i}:{width:a}),l=n?0:(i-r.height)/2,f=n?(a-r.width)/2:0;I.add(s).css({top:l,left:f,width:r.width,height:r.height}),z=r.scale,T(z)}}),E=t.mk("button").attr("class",e+"zoom-in typcn typcn-zoom-in").on("click",function(t){t.preventDefault(),T((Math.floor(10*z)+1)/10)}),H=t.mk("button").attr("class",e+"zoom-out typcn typcn-zoom-out").on("click",function(t){t.preventDefault(),T((Math.floor(10*z)-1)/10)}),M=t.mk("div").attr("class",e+"actions "+e+"actions-tl").append(E,H,S,D).on("mousedown",function(t){t.stopPropagation(),D.triggerHandler("blur")}),j=t.mk("div").attr("class",e+"actions "+e+"actions-bl").append(u,d,m,p).on("mousedown",function(t){t.stopPropagation(),D.triggerHandler("blur")}),I=t.mk("div").attr("class",e+"image-overlay").appendTo(c),N=t.mk("div").attr("class",e+"loader").html("Loading&hellip;"),W=t.throttle(250,function(){a=c.innerWidth(),i=c.innerHeight(),"number"==typeof z&&T(z);var t=y();m.text(t.top+","+t.left),l.attr("viewBox","0 0 "+a+" "+i)});return $w.on("resize",W),W(),c.append(M,j,N,h,f),s.on("load",function(){I.css("opacity",0),s.appendTo(c).data("size",{width:s.width(),height:s.height()}),N.detach(),S.triggerHandler("click"),I.fadeTo(500,1);var e=void 0,n=void 0;r=t.throttle(100,function(t){t.preventDefault();var o={top:t.pageY,left:t.pageX},a=b(),i=e.top+(o.top-n.top)-a.top,r=e.left+(o.left-n.left)-a.left;I.add(s).css({top:i,left:r});var l={width:s.width(),height:s.height()};x(i,r,l)}),o.on("mousedown",function(a){t(a.target).is(I)&&(a.preventDefault(),e=I.offset(),n={top:a.pageY,left:a.pageX},o.on("mousemove",r))}),o.on("mouseup mouseleave blur",function(){o.off("mousemove",r)})}),o.on("mousemove",t.throttle(50,function(t){var e=b();p.text(t.pageX-e.left+","+(t.pageY-e.top))})),{destroy:function(){"function"==typeof r&&o.off("mousemove",r),$w.off("resize",W),c.empty().removeClass(e+"wrap")}}}}(jQuery);
//# sourceMappingURL=poly-editor.min.js.map
