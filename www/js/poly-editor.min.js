!function(t){"use strict";var e="poly-",o=t(document);t.fn.polyEditor=function(n){if(!n.image)throw new Error("Missing image");var a,i,r,l,c=t(new Image).attr({src:n.image,"class":e+"image"}).attr("class",e+"image-element"),s=this.first().addClass(e+"wrap"),f=t.mk("span").attr("title","Image top left").attr("class",e+"imgtl").text("?, ?"),p=t.mk("span").attr("title","Image center").attr("class",e+"imgc").text("?, ?"),u=t.mk("span").attr("title","Wrapper center").attr("class",e+"wrapc").text("?, ?"),d=t.mk("cpan").attr("class",e+"imgc-expected"),h=function(t,e){return{top:t.top-r.top+e.height/2,left:t.left-r.left+e.width/2}},m=function(){return{top:a/2,left:i/2}},g=function(e,o,n){if(y.text(t.roundTo(100*v,2)+"%"),document.activeElement.blur(),"number"==typeof e){f.text(t.roundTo(e,2)+","+t.roundTo(o,2));var a=c.offset(),i=h(a,n);p.text(t.roundTo(i.top,2)+","+t.roundTo(i.left,2)),d.css({top:i.top-5,left:i.left-5});var r=m();u.text(t.roundTo(r.top,2)+","+t.roundTo(r.left,2))}},v=0,w=function(e){var o=c.data("size");if("object"==typeof o){var n=t.scaleResize(o.width,o.height,{scale:t.rangeLimit(e,!1,.01,2.5)}),r={top:(a-n.height)/2,left:(i-n.width)/2},l=h(r,n),s=m(),f={top:s.top-l.top,left:s.left-l.left};console.log(s,l),v=n.scale;var p=l.top+f.top*v,u=l.left+f.left*v;z.add(c).css({top:p,left:u,width:n.width,height:n.height}),g(p,u,n)}},y=t.mk("span").attr({"class":e+"zoom-perc",contenteditable:!0}).text("100%").on("keydown",function(e){if(t.isKey(Key.Enter,e)){e.preventDefault();var o=parseFloat(y.text(),10);isNaN(o)||w(o/100),g()}}).on("click",function(){y.select()}).on("blur",function(){t.clearSelection()}),k=t.mk("button").attr("class",e+"zoom-fit typcn typcn typcn-arrow-minimise").on("click",function(e){var o=c.data("size");if("object"==typeof o){e.preventDefault();var n=o.width>o.height,r=t.scaleResize(o.width,o.height,n?{height:a}:{width:i}),l=n?0:(a-r.height)/2,s=n?(i-r.width)/2:0;z.add(c).css({top:l,left:s,width:r.width,height:r.height}),v=r.scale,g(l,s,r)}}),b=t.mk("div").attr("class",e+"actions "+e+"actions-bl").append(t.mk("button").attr("class",e+"zoom-in typcn typcn-zoom-in").on("click",function(t){t.preventDefault(),w((Math.floor(10*v)+1)/10)}),t.mk("button").attr("class",e+"zoom-out typcn typcn-zoom-out").on("click",function(t){t.preventDefault(),w((Math.floor(10*v)-1)/10)}),k,y,f,p,u).on("mousedown",function(t){t.stopPropagation(),y.triggerHandler("blur")}),z=t.mk("div").attr("class",e+"image-overlay").appendTo(s),x=t.mk("div").attr("class",e+"loader").html("Loading&hellip;"),T=t.throttle(250,function(t){a=s.innerHeight(),i=s.innerWidth(),r=s.offset(),r.top-=(a-s.outerHeight())/2,r.left-=(i-s.outerWidth())/2,"number"==typeof v&&w(v);var e=m();u.text(e.top+","+e.left)});return $w.on("resize",T),T(),s.append(b,x,d),c.on("load",function(){z.css("opacity",0),c.appendTo(s).data("size",{width:c.width(),height:c.height()}),x.detach(),k.triggerHandler("click"),z.fadeTo(500,1);var e,n;l=t.throttle(100,function(t){t.preventDefault();var o={top:t.pageY,left:t.pageX},a=e.top+(o.top-n.top)-r.top,i=e.left+(o.left-n.left)-r.left;z.add(c).css({top:a,left:i}),g(a,i,{width:c.width(),height:c.height()})}),o.on("mousedown",function(a){t(a.target).is(z)&&(a.preventDefault(),e=z.offset(),n={top:a.pageY,left:a.pageX},o.on("mousemove",l))}),o.on("mouseup mouseleave blur",function(){o.off("mousemove",l)})}),{destroy:function(){"function"==typeof l&&o.off("mousemove",l),$w.off("resize",T),s.empty().removeClass(e+"wrap")}}}}(jQuery);
//# sourceMappingURL=poly-editor.min.js.map
