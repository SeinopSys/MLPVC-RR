{"version":3,"sources":["user.js"],"names":["DocReady","push","$signoutBtn","$","find","on","e","preventDefault","title","$btn","this","$li","closest","$browser","parent","browser","text","trim","$platform","next","children","platform","length","index","current","test","last","trigger","SessionID","parseInt","attr","isNaN","isFinite","Dialog","fail","confirm","sure","wait","post","mkAjaxHandler","status","remove","close","message","success","setTimeout","window","location","reload"],"mappings":"AAAAA,SAASC,KAAK,WACb,GAAIC,GAAcC,EAAE,WACpBA,GAAE,iBAAiBC,KAAK,iBAAiBC,GAAG,QAAQ,SAASC,GAC5DA,EAAEC,gBAEF,IAAIC,GAAQ,mBACXC,EAAON,EAAEO,MACTC,EAAMF,EAAKG,QAAQ,MACnBC,EAAWJ,EAAKK,SAChBC,EAAUF,EAASG,OAAOC,OAC1BC,EAAYL,EAASM,OAAOC,SAAS,UACrCC,EAAWH,EAAUI,OAAS,WAAWJ,EAAUF,OAAOC,OAAO,QAAU,EAG5E,IAAoB,IAAhBN,EAAIY,QAAc,CACrB,GAAIC,GAAU,WAAWC,KAAKZ,EAASC,SAASM,WAAWM,OAAOV,OAClE,IAAIQ,EACH,MAAOtB,GAAYyB,QAAQ,SAG7B,GAAIC,GAAYC,SAASpB,EAAKqB,KAAK,YAEnC,OAAyB,mBAAdF,IAA6BG,MAAMH,KAAeI,SAASJ,GAC9DzB,EAAE8B,OAAOC,KAAK1B,EAAM,0EAE5BL,GAAE8B,OAAOE,QAAQ3B,EAAM,iCAAkCO,EAAQ,QAAQM,EAAS,iBAAiB,SAASe,GACtGA,IAELjC,EAAE8B,OAAOI,KAAK7B,EAAM,oBAAoBO,GAExCZ,EAAEmC,KAAK,oBAAoBV,EAAWzB,EAAEoC,cAAc,WACjD7B,KAAK8B,QACR7B,EAAI8B,SACJtC,EAAE8B,OAAOS,SAELvC,EAAE8B,OAAOC,KAAK1B,EAAME,KAAKiC,iBAIjCxC,EAAE,uBAAuBE,GAAG,QAAQ,WACnC,GAAIG,GAAQ,4BAEZL,GAAE8B,OAAOE,QAAQ3B,EAAM,+CAA+C,SAAS4B,GACzEA,IAELjC,EAAE8B,OAAOI,KAAK7B,EAAM,eAEpBL,EAAEmC,KAAK,sBAAsBnC,EAAEoC,cAAc,WACxC7B,KAAK8B,QACRrC,EAAE8B,OAAOW,QAAQpC,EAAME,KAAKiC,SAC5BE,WAAW,WACVC,OAAOC,SAASC,UACf,MAEE7C,EAAE8B,OAAOC,KAAK1B,EAAME,KAAKiC,iBAIjCxC,EAAE,WAAWE,GAAG,QAAQ,WACvB,GAAIG,GAAQ,2BACZL,GAAE8B,OAAOE,QAAQ3B,EAAM,gDAAgD,SAAS4B,GAC1EA,IAELjC,EAAE8B,OAAOI,KAAK7B,EAAM,yBAEpBL,EAAEmC,KAAK,kBAAmBnC,EAAEoC,cAAc,WACrC7B,KAAK8B,QACRrC,EAAE8B,OAAOW,QAAQpC,EAAME,KAAKiC,SAC5BE,WAAW,WACVC,OAAOC,SAASC,UACf,MAEE7C,EAAE8B,OAAOC,KAAK1B,EAAME,KAAKiC","file":"user.min.js","sourcesContent":["DocReady.push(function User(){\r\n\tvar $signoutBtn = $('#signout');\r\n\t$('.session-list').find('button.remove').on('click',function(e){\r\n\t\te.preventDefault();\r\n\r\n\t\tvar title = 'Removing session',\r\n\t\t\t$btn = $(this),\r\n\t\t\t$li = $btn.closest('li'),\r\n\t\t\t$browser = $btn.parent(),\r\n\t\t\tbrowser = $browser.text().trim(),\r\n\t\t\t$platform = $browser.next().children('strong'),\r\n\t\t\tplatform = $platform.length ? ' on <em>'+$platform.text().trim()+'</em>' : '';\r\n\r\n\t\t// First item is sometimes the current session, trigger logout button instead\r\n\t\tif ($li.index() === 0){\r\n\t\t\tvar current = /current/i.test($browser.parent().children().last().text());\r\n\t\t\tif (current)\r\n\t\t\t\treturn $signoutBtn.trigger('click');\r\n\t\t}\r\n\r\n\t\tvar SessionID = parseInt($btn.attr('data-sid'));\r\n\r\n\t\tif (typeof SessionID === 'undefined' || isNaN(SessionID) || !isFinite(SessionID))\r\n\t\t\treturn $.Dialog.fail(title,'Could not locate Session ID, please reload the page and try again.');\r\n\r\n\t\t$.Dialog.confirm(title,'You\\'ll be logged out form <em>'+browser+'</em>'+platform+'.<br>Continue?',function(sure){\r\n\t\t\tif (!sure) return;\r\n\r\n\t\t\t$.Dialog.wait(title,'Signing out from '+browser);\r\n\r\n\t\t\t$.post('/user/sessiondel/'+SessionID, $.mkAjaxHandler(function(){\r\n\t\t\t\tif (this.status){\r\n\t\t\t\t\t$li.remove();\r\n\t\t\t\t\t$.Dialog.close();\r\n\t\t\t\t}\r\n\t\t\t\telse $.Dialog.fail(title,this.message);\r\n\t\t\t}));\r\n\t\t});\r\n\t});\r\n\t$('#signout-everywhere').on('click',function(){\r\n\t\tvar title = 'Sign out from ALL sessions';\r\n\r\n\t\t$.Dialog.confirm(title,\"This will invalidate ALL sessions. Continue?\",function(sure){\r\n\t\t\tif (!sure) return;\r\n\r\n\t\t\t$.Dialog.wait(title,'Signing out');\r\n\r\n\t\t\t$.post('/signout?everywhere',$.mkAjaxHandler(function(){\r\n\t\t\t\tif (this.status){\r\n\t\t\t\t\t$.Dialog.success(title,this.message);\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t},1000);\r\n\t\t\t\t}\r\n\t\t\t\telse $.Dialog.fail(title,this.message);\r\n\t\t\t}));\r\n\t\t});\r\n\t});\r\n\t$('#unlink').on('click',function(){\r\n\t\tvar title = 'Unlink account & sign out';\r\n\t\t$.Dialog.confirm(title,'Are you sure you want to unlink your account?',function(sure){\r\n\t\t\tif (!sure) return;\r\n\r\n\t\t\t$.Dialog.wait(title,'Removing account link');\r\n\r\n\t\t\t$.post('/signout?unlink', $.mkAjaxHandler(function(){\r\n\t\t\t\tif (this.status){\r\n\t\t\t\t\t$.Dialog.success(title,this.message);\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t},1000);\r\n\t\t\t\t}\r\n\t\t\t\telse $.Dialog.fail(title,this.message);\r\n\t\t\t}));\r\n\t\t});\r\n\t});\r\n});\r\n"],"sourceRoot":"/source/"}