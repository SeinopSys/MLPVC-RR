!function(t){function e(e,n){return"function"==typeof n&&(n=n(e)),e.data("ctxmenu-items")instanceof jQuery?n&&e.data("ctxmenu-items").children().first().text(n):e.data("ctxmenu-items",(new jQuery).add(t(document.createElement("li")).text(n||"Context menu"))),e}function n(e,n){if(e){var o=t(document.createElement("li"));if(e===!0)o.addClass("sep");else{var i=t(document.createElement("a"));e.text&&i.text(e.text),e.icon&&i.addClass("typcn typcn-"+e.icon),e.default===!0&&i.css("font-weight","bold"),"function"==typeof e.click&&i.on("click",function(t){t.stopPropagation(),t.preventDefault(),e.click.call(n.get(0),t),c.hide()}),i.appendTo(o)}n.data("ctxmenu-items",n.data("ctxmenu-items").add(o))}}var c=t(document.createElement("div")).attr("id","ctxmenu");c.appendTo(document.body).on("click",function(t){t.stopPropagation()}),t.ctxmenu={},t.ctxmenu.setTitle=function(){return e.apply(this,arguments)},t.fn.ctxmenu=function(o,i){return t(this).each(function(){var a=t(this);e(a,i),t.each(o,function(t,e){n(e,a)}),a.on("contextmenu",function(t){t.preventDefault(),t.stopPropagation(),c.css({top:t.clientY,left:t.clientX}).html(a.data("ctxmenu-items").clone(!0,!0)).show()})})},t.ctxmenu.addItem=t.ctxmenu.addItems=function(c){var o=arguments.length;if(2>o)throw new Error("Invalud number of arguments ("+o+") for $.ctxmenu.addItems");e(c);var i=[].slice.apply(arguments);i.splice(0,1),t.each(i,function(t,e){n(e,c)})},t.ctxmenu.triggerItem=function(t,e){var n=t.data("ctxmenu-items");if(1>e||n.length-1<e)throw new Error("There's no such menu option: "+e);n.eq(e).children("a").triggerHandler("click")},t(document.body).on("click contextmenu",function(){c.hide()}),t(window).on("blur",function(){c.hide()})}(jQuery);