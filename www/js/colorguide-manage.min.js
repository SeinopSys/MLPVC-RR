$(function(){function t(t){if(!document.queryCommandSupported("copy"))return prompt("Copy with Ctrl+C, close with Enter",t),!0;var e=$(document.createElement("textarea")),i=!1;e.css({opacity:0,width:0,height:0,position:"absolute",left:"-10px",top:"-10px",display:"block"}).text(t).appendTo("body").focus(),e.get(0).select();try{i=document.execCommand("copy")}catch(n){}i||$.Dialog.fail("Copy to clipboard","Copying text to clipboard failed!"),setTimeout(function(){e.remove()},1)}var e=window.Color,i=window.color,n=window.TAG_TYPES_ASSOC;$("#list").find("button.edit").on("click",function(){$.Dialog.info("Edit mode triggered","yay")}).next().on("click",function(){$.Dialog.info("Delete pony triggered","yay")});var o=$(document.createElement("form")).attr("id","edit-tag");o.append("<label><span>Tag name (4-30 chars.)</span><input type=text name=name required pattern=^.{4,30}$ maxlength=30></label>");var a=$(document.createElement("select")).attr("name","type");a.append('<option value="" selected>No special type</option>'),$.each(n,function(t,e){a.append("<option value="+t+">"+e+"</option>")}),o.append($(document.createElement("label")).append("<span>Tag type</span><br>",a)),o.append($(document.createElement("label")).append("<span>Tag description (max 255 chars., optional)</span><br><textarea name=title maxlength=255></textarea>")),$(".tags").children().each(function(){$.ctxmenu.addItem($(this),{text:"Edit tag",icon:"pencil",click:function(){var t=$(this),e=t.text().trim(),i=t.attr("class").match(/tag\-(\d+)(?:\s|$)/)[1],n="Editing tag: "+e;$.Dialog.wait(n,"Retrieveing tag details from server"),$.post("/colorguide/gettag/"+i,{},function(t){return"object"!=typeof t?console.log(t)&&$w.trigger("ajaxerror"):void(t.status?$.Dialog.request(n,o.clone(),"edit-tag","Save",function(){var e=$("#edit-tag");e.find("input[name], select[name], textarea[name]").each(function(){var e=$(this);e.val(t[e.attr("name")])}),e.on("submit",function(t){t.preventDefault();var e=$(this).serializeArray(),o={};$.each(e,function(t,e){o[e.name]=e.value}),$.Dialog.wait(n,"Saving changes"),$.post("/colorguide/settag/"+i,o,function(t){if("object"!=typeof t)return console.log(t)&&$w.trigger("ajaxerror");if(t.status){var e=$(".tag-"+t.tid);console.log(e),e.qtip("destroy",!0),t.title?e.attr("title",t.title):e.removeAttr("title"),e.attr("class","tag-"+t.tid+" typ-"+t.type).text(t.name),window.tooltips(),$.Dialog.close()}else $.Dialog.fail(n,t.message)})})}):$.Dialog.fail(n,t.message))})}},{text:"Delete tag (TBI)",icon:"trash",click:function(){$.Dialog.info("Delete tag triggred","yay")}},!0,{text:"Create new tag",icon:"plus",click:function(){var t="Create new tag",e=$(this),i=e.closest("li"),n=i.attr("id").replace(/\D/g,""),a=e.closest("div:not([class])").children("strong").text().trim();$.Dialog.request(t,o.clone(),"edit-tag","Create",function(){var e=$("#edit-tag");e.append($(document.createElement("label")).append("<input type=checkbox name=addto value="+n+'> Add this tag to the appearance "'+a+'" after creation')),$.Dialog.center(),e.on("submit",function(i){i.preventDefault();var n=e.serializeArray(),o={};$.each(n,function(t,e){o[e.name]=e.value}),$.Dialog.wait(t,"Adding tag"),$.post("/colorguide/maketag",o,function(e){return"object"!=typeof e?console.log(e)&&$w.trigger("ajaxerror"):void(e.status?$.Dialog.success(t,e.message,!0):$.Dialog.fail(t,e.message))})})})}},{text:"Enable edit mode (TBI)",icon:"edit",click:function(){$(this).parent().prevAll("strong").children("button.edit").triggerHandler("click")}})}),$("ul.colors").children("li").ctxmenu([{text:"Edit "+i+" group (TBI)",icon:"pencil",click:function(){$.Dialog.info("Edit "+i+" group triggered","yay")}},{text:"Delete "+i+" group (TBI)",icon:"trash",click:function(){$.Dialog.info("Delete "+i+" group triggered","yay")}},{text:"Add new group (TBI)",icon:"folder-add",click:function(){$.Dialog.info("Add new group triggered","yay")}},{text:"Add new "+i+" (TBI)",icon:"plus",click:function(){$.Dialog.info("Add new color triggered","yay")}}],function(t){return e+" group: "+t.children().first().text().trim().replace(":","")}).children("span:not(:first-child)").off("click").on("click",function(e){e.preventDefault(),t(this.innerHTML.trim())}).ctxmenu([{text:"Copy "+i,icon:"clipboard","default":!0,click:function(){t(this.innerHTML.trim())}},{text:"Edit "+i+" (TBI)",icon:"pencil (TBI)",click:function(){$.Dialog.info("Edit "+i+" triggered","yay")}},!0,{text:"Edit "+i+" group (TBI)",icon:"pencil",click:function(){$.ctxmenu.triggerItem($(this).parent(),1)}},{text:"Delete "+i+" group (TBI)",icon:"trash",click:function(){$.ctxmenu.triggerItem($(this).parent(),2)}},{text:"Add new group (TBI)",icon:"folder-add",click:function(){$.ctxmenu.triggerItem($(this).parent(),3)}},{text:"Add new "+i+" (TBI)",icon:"plus",click:function(){$.ctxmenu.triggerItem($(this).parent(),4)}}],function(t){return"Color: "+t.attr("oldtitle")})});
//# sourceMappingURL=colorguide-manage.min.js.map