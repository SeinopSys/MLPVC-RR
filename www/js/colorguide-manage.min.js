$(function(){function t(t){if(!document.queryCommandSupported("copy"))return prompt("Copy with Ctrl+C, close with Enter",t),!0;var e=$(document.createElement("textarea")),i=!1;e.css({opacity:0,width:0,height:0,position:"absolute",left:"-10px",top:"-10px",display:"block"}).text(t).appendTo("body").focus(),e.get(0).select();try{i=document.execCommand("copy")}catch(n){}i||$.Dialog.fail("Copy to clipboard","Copying text to clipboard failed!"),setTimeout(function(){e.remove()},1)}function e(){$(".tags").children(":not(.ctxmenu-bound)").ctxmenu([{text:"Edit tag",icon:"pencil",click:function(){var t=$(this),e=t.text().trim(),i=t.attr("class").match(/tag\-(\d+)(?:\s|$)/)[1],n="Editing tag: "+e;$.Dialog.wait(n,"Retrieveing tag details from server"),$.post("/colorguide/gettag/"+i,{},function(t){return"object"!=typeof t?console.log(t)&&$w.trigger("ajaxerror"):void(t.status?$.Dialog.request(n,c.clone(),"edit-tag","Save",function(){var e=$("#edit-tag");e.find("input[name], select[name], textarea[name]").each(function(){var e=$(this);e.val(t[e.attr("name")])}),e.on("submit",function(t){t.preventDefault();var e=$(this).serializeArray(),o={};$.each(e,function(t,e){o[e.name]=e.value}),$.Dialog.wait(n,"Saving changes"),$.post("/colorguide/settag/"+i,o,function(t){if("object"!=typeof t)return console.log(t)&&$w.trigger("ajaxerror");if(t.status){var e=$(".tag-"+t.tid);console.log(e),e.qtip("destroy",!0),t.title?e.attr("title",t.title):e.removeAttr("title"),e.attr("class","tag-"+t.tid+(t.type?" typ-"+t.type:"")).text(t.name),window.tooltips(),$.Dialog.close()}else $.Dialog.fail(n,t.message)})})}):$.Dialog.fail(n,t.message))})}},{text:"Delete tag (TBI)",icon:"trash",click:function(){$.Dialog.info("Delete tag triggred","yay")}},!0,{text:"Create new tag",icon:"plus",click:function(){var t="Create new tag",i=$(this),n=i.closest("li"),o=i.closest("div:not([class])"),a=o.children(".tags"),r=n.attr("id").replace(/\D/g,""),l=o.children("strong").text().trim();$.Dialog.request(t,c.clone(),"edit-tag","Create",function(){var i=$("#edit-tag");i.append($(document.createElement("label")).append("<input type=checkbox name=addto value="+r+'> Add this tag to the appearance "'+l+'" after creation')),$.Dialog.center(),i.on("submit",function(n){n.preventDefault();var o=i.serializeArray(),c={};$.each(o,function(t,e){c[e.name]=e.value}),$.Dialog.wait(t,"Creating tag"),$.post("/colorguide/maketag",c,function(i){return"object"!=typeof i?console.log(i)&&$w.trigger("ajaxerror"):void(i.status?(i.tags&&(a.children("[data-hasqtip]").qtip("destroy",!0),a.html(i.tags),window.tooltips(),e()),$.Dialog.success(t,i.message,!0)):$.Dialog.fail(t,i.message))})})})}},{text:"Enable edit mode (TBI)",icon:"edit",click:function(){$(this).parent().prevAll("strong").children("button.edit").triggerHandler("click")}}]),i=$("ul.colors").children("li"),i.filter(":not(.ctxmenu-bound)").ctxmenu([{text:"Edit "+o+" group (TBI)",icon:"pencil",click:function(){$.Dialog.info("Edit "+o+" group triggered","yay")}},{text:"Delete "+o+" group (TBI)",icon:"trash",click:function(){$.Dialog.info("Delete "+o+" group triggered","yay")}},{text:"Add new group (TBI)",icon:"folder-add",click:function(){$.Dialog.info("Add new group triggered","yay")}},{text:"Add new "+o+" (TBI)",icon:"plus",click:function(){$.Dialog.info("Add new color triggered","yay")}}],function(t){return n+" group: "+t.children().first().text().trim().replace(":","")}),i.children("span:not(:first-child)").off("click").on("click",function(e){e.preventDefault(),t(this.innerHTML.trim())}).filter(":not(.ctxmenu-bound)").ctxmenu([{text:"Copy "+o,icon:"clipboard","default":!0,click:function(){t(this.innerHTML.trim())}},{text:"Edit "+o+" (TBI)",icon:"pencil (TBI)",click:function(){$.Dialog.info("Edit "+o+" triggered","yay")}},!0,{text:"Edit "+o+" group (TBI)",icon:"pencil",click:function(){$.ctxmenu.triggerItem($(this).parent(),1)}},{text:"Delete "+o+" group (TBI)",icon:"trash",click:function(){$.ctxmenu.triggerItem($(this).parent(),2)}},{text:"Add new group (TBI)",icon:"folder-add",click:function(){$.ctxmenu.triggerItem($(this).parent(),3)}},{text:"Add new "+o+" (TBI)",icon:"plus",click:function(){$.ctxmenu.triggerItem($(this).parent(),4)}}],function(t){return"Color: "+t.attr("oldtitle")})}var i,n=window.Color,o=window.color,a=window.TAG_TYPES_ASSOC;$("#list").find("button.edit").on("click",function(){$.Dialog.info("Edit mode triggered","yay")}).next().on("click",function(){$.Dialog.info("Delete pony triggered","yay")});var c=$(document.createElement("form")).attr("id","edit-tag");c.append("<label><span>Tag name (4-30 chars.)</span><input type=text name=name required pattern=^.{4,30}$ maxlength=30></label>");var r=$(document.createElement("select")).attr("name","type");r.append('<option value="" selected>No special type</option>'),$.each(a,function(t,e){r.append("<option value="+t+">"+e+"</option>")}),c.append($(document.createElement("label")).append("<span>Tag type</span><br>",r)),c.append($(document.createElement("label")).append("<span>Tag description (max 255 chars., optional)</span><br><textarea name=title maxlength=255></textarea>")),e(),window.ctxmenus=function(){e()}});
//# sourceMappingURL=colorguide-manage.min.js.map