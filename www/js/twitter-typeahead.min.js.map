{"version":3,"sources":["twitter-typeahead.js"],"names":["root","factory","define","amd","a0","exports","module","require","jQuery","this","$","_","isMsie","test","navigator","userAgent","match","isBlankString","str","escapeRegExChars","replace","isString","obj","isNumber","isArray","isFunction","isObject","isPlainObject","isUndefined","isElement","nodeType","isJQuery","toStr","s","bind","proxy","each","collection","cb","reverseArgs","index","value","map","filter","grep","every","result","key","val","call","some","mixin","extend","identity","x","clone","getIdGenerator","counter","templatify","template","String","defer","fn","setTimeout","debounce","func","wait","immediate","timeout","later","callNow","context","args","arguments","apply","clearTimeout","throttle","previous","Date","now","remaining","stringify","JSON","noop","VERSION","tokenizers","whitespace","split","nonword","getObjTokenizer","tokenizer","keys","slice","o","tokens","k","concat","LruCache","maxSize","reset","set","get","List","head","tail","Node","prev","next","prototype","node","tailItem","list","size","remove","hash","moveToFront","add","PersistentStorage","namespace","override","prefix","join","ttlKey","keyMatcher","RegExp","ls","LOCAL_STORAGE","_noop","getTime","encode","decode","parseJSON","gatherMatchingKeys","i","len","length","push","window","localStorage","setItem","removeItem","err","_prefix","_ttlKey","clear","isExpired","_safeSet","name","getItem","ttl","Transport","cancelled","lastReq","_send","transport","_get","limiter","_cache","cache","sharedCache","pendingRequestsCount","pendingRequests","maxPendingRequests","setMaxPendingRequests","num","resetCache","_fingerprint","url","type","param","data","done","resp","that","fingerprint","fail","always","onDeckRequestArgs","jqXhr","cancel","SearchIndex","datumTokenizer","queryTokenizer","error","identify","normalizeTokens","token","toLowerCase","newNode","IDS","CHILDREN","unique","array","seen","uniques","getIntersection","arrayA","arrayB","ai","bi","intersection","sort","lenArrayA","lenArrayB","bootstrap","datums","trie","datum","id","chars","ch","shift","ids","search","query","matches","all","values","serialize","Prefetch","prepare","transform","thumbprint","storage","cacheKey","protocol","_settings","dataType","store","location","fromCache","stored","fromNetwork","onError","onResponse","settings","Remote","cancelLastRequest","oParser","parsePrefetch","defaults","callbackToDeferred","ajax","parseRemote","wildcard","rateLimitBy","rateLimitWait","toRemotePrepare","toLimiter","prepareByReplace","prepareByWildcard","encodeURIComponent","idenityPrepare","method","onSuccess","deferred","resolve","reject","Deferred","sorter","initialize","sufficient","local","prefetch","remote","Bloodhound","old","noConflict","__ttAdapter","withAsync","sync","async","withoutAsync","_loadPrefetch","serialized","promise","_initialize","addLocalToIndex","initPromise","force","processRemote","nonDuplicates","r","l","clearPrefetchCache","clearRemoteCache","ttAdapter","WWW","build","www","classes","defaultClassNames","css","buildCss","html","buildHtml","selectors","buildSelectors","c","wrapper","menu","v","position","display","hint","top","left","borderColor","boxShadow","opacity","input","verticalAlign","backgroundColor","inputWithNoHint","zIndex","ltr","right","rtl","backgroundImage","dataset","suggestion","selectable","empty","open","cursor","highlight","EventBus","el","$el","deprecationMap","render","cursorchange","select","autocomplete","_trigger","$e","Event","unshift","trigger","before","isDefaultPrevented","deprecatedType","EventEmitter","on","types","splitter","bindContext","_callbacks","onAsync","onSync","off","callbacks","syncFlush","asyncFlush","getFlush","nextTick","flush","getNextTick","nextTickFn","setImmediate","doc","getRegex","patterns","caseSensitive","wordsOnly","regexStr","escapedPatterns","pattern","tagName","className","hightlightTextNode","textNode","patternNode","wrapperNode","regex","exec","createElement","splitText","appendChild","cloneNode","parentNode","replaceChild","traverse","childNode","TEXT_NODE_TYPE","childNodes","document","Input","$hint","$input","queryWhenFocused","hasFocus","$overflowHelper","buildOverflowHelper","_checkLanguageDirection","setHint","getHint","clearHint","clearHintIfInvalid","visibility","whiteSpace","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","wordSpacing","letterSpacing","textIndent","textRendering","textTransform","insertAfter","areQueriesEquivalent","a","b","normalizeQuery","withModifier","altKey","ctrlKey","metaKey","shiftKey","specialKeyCodeMap",9,27,37,39,13,38,40,"_onBlur","resetInputValue","_onFocus","_onKeydown","keyName","which","keyCode","_managePreventDefault","_shouldTrigger","_onInput","_setQuery","getInputValue","preventDefault","dir","attr","silent","areEquivalent","hasDifferentWhitespace","onBlur","onFocus","onKeydown","onInput","focus","blur","getLangDir","getQuery","setQuery","setInputValue","hasQueryChangedSinceLastFocus","valIsPrefixOfHint","isValid","indexOf","hasOverflow","is","constraint","width","text","isCursorAtEnd","valueLength","selectionStart","range","selection","createRange","moveStart","destroy","Dataset","templates","notFound","source","isValidName","nameGenerator","limit","displayFn","getDisplayFn","displayKey","getTemplates","_resetLastSuggestion","addClass","suggestionTemplate","pending","header","footer","extractData","_overwrite","suggestions","_renderSuggestions","_renderPending","_renderNotFound","_empty","_append","$lastSuggestion","_appendSuggestions","$fragment","_getSuggestionsFragment","children","last","prepend","_getHeader","append","_getFooter","after","fragment","createDocumentFragment","_injectQuery","_query","update","syncCalled","rendered","canceled","isEmpty","Menu","initializeDataset","oDataset","$node","find","first","appendTo","datasets","_onSelectableClick","currentTarget","_onRendered","toggleClass","_allDatasetsEmpty","_onCleared","_propagate","isDatasetEmpty","_getSelectables","_removeCursor","$selectable","getActiveSelectable","removeClass","_ensureVisible","elTop","elBottom","nodeScrollTop","nodeHeight","outerHeight","scrollTop","height","parseInt","onSelectableClick","isOpen","hasClass","close","setLanguageDirection","selectableRelativeToCursor","delta","$selectables","$oldCursor","oldIndex","newIndex","eq","setCursor","getSelectableData","getTopSelectable","updateDataset","isValidUpdate","clearDataset","destroyDataset","DefaultMenu","_show","_hide","hide","Typeahead","onFocused","onBlurred","onEnterKeyed","onTabKeyed","onEscKeyed","onUpKeyed","onDownKeyed","onLeftKeyed","onRightKeyed","onQueryChanged","onWhitespaceChanged","eventBus","minLength","enabled","active","activate","_hacks","_onSelectableClicked","_onAsyncRequested","_onAsyncCanceled","_onAsyncReceived","_onDatasetRendered","_onDatasetCleared","_onLangDirChanged","ctx","methods","$menu","isActive","hasActive","activeElement","has","stopImmediatePropagation","_updateHint","_onFocused","_minLengthMet","_onBlurred","_onEnterKeyed","_onTabKeyed","_onEscKeyed","_onUpKeyed","moveCursor","_onDownKeyed","_onLeftKeyed","_onRightKeyed","_onQueryChanged","e","_onWhitespaceChanged","_openIfActive","escapedQuery","frontMatchRegEx","isEnabled","enable","disable","deactivate","setVal","getVal","$candidate","payload","cancelMove","ttEach","$els","typeahead","buildHintFromInput","removeData","getBackgroundStyles","prop","removeAttr","spellcheck","tabindex","prepInput","attrs","style","backgroundAttachment","backgroundClip","backgroundOrigin","backgroundPosition","backgroundRepeat","backgroundSize","revert","$wrapper","parent","detach","$elOrNull","attach","defaultHint","defaultMenu","MenuConstructor","d","wrap","classNames","t","success","newVal"],"mappings":"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","file":"twitter-typeahead.min.js","sourcesContent":["/*!\r\n * typeahead.js 0.11.1\r\n * https://github.com/twitter/typeahead.js\r\n * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT\r\n */\r\n\r\n(function(root, factory) {\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"bloodhound\", [ \"jquery\" ], function(a0) {\r\n            return root[\"Bloodhound\"] = factory(a0);\r\n        });\r\n    } else if (typeof exports === \"object\") {\r\n        module.exports = factory(require(\"jquery\"));\r\n    } else {\r\n        root[\"Bloodhound\"] = factory(jQuery);\r\n    }\r\n})(this, function($) {\r\n    var _ = function() {\r\n        \"use strict\";\r\n        return {\r\n            isMsie: function() {\r\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\r\n            },\r\n            isBlankString: function(str) {\r\n                return !str || /^\\s*$/.test(str);\r\n            },\r\n            escapeRegExChars: function(str) {\r\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\r\n            },\r\n            isString: function(obj) {\r\n                return typeof obj === \"string\";\r\n            },\r\n            isNumber: function(obj) {\r\n                return typeof obj === \"number\";\r\n            },\r\n            isArray: $.isArray,\r\n            isFunction: $.isFunction,\r\n            isObject: $.isPlainObject,\r\n            isUndefined: function(obj) {\r\n                return typeof obj === \"undefined\";\r\n            },\r\n            isElement: function(obj) {\r\n                return !!(obj && obj.nodeType === 1);\r\n            },\r\n            isJQuery: function(obj) {\r\n                return obj instanceof $;\r\n            },\r\n            toStr: function toStr(s) {\r\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\r\n            },\r\n            bind: $.proxy,\r\n            each: function(collection, cb) {\r\n                $.each(collection, reverseArgs);\r\n                function reverseArgs(index, value) {\r\n                    return cb(value, index);\r\n                }\r\n            },\r\n            map: $.map,\r\n            filter: $.grep,\r\n            every: function(obj, test) {\r\n                var result = true;\r\n                if (!obj) {\r\n                    return result;\r\n                }\r\n                $.each(obj, function(key, val) {\r\n                    if (!(result = test.call(null, val, key, obj))) {\r\n                        return false;\r\n                    }\r\n                });\r\n                return !!result;\r\n            },\r\n            some: function(obj, test) {\r\n                var result = false;\r\n                if (!obj) {\r\n                    return result;\r\n                }\r\n                $.each(obj, function(key, val) {\r\n                    if (result = test.call(null, val, key, obj)) {\r\n                        return false;\r\n                    }\r\n                });\r\n                return !!result;\r\n            },\r\n            mixin: $.extend,\r\n            identity: function(x) {\r\n                return x;\r\n            },\r\n            clone: function(obj) {\r\n                return $.extend(true, {}, obj);\r\n            },\r\n            getIdGenerator: function() {\r\n                var counter = 0;\r\n                return function() {\r\n                    return counter++;\r\n                };\r\n            },\r\n            templatify: function templatify(obj) {\r\n                return $.isFunction(obj) ? obj : template;\r\n                function template() {\r\n                    return String(obj);\r\n                }\r\n            },\r\n            defer: function(fn) {\r\n                setTimeout(fn, 0);\r\n            },\r\n            debounce: function(func, wait, immediate) {\r\n                var timeout, result;\r\n                return function() {\r\n                    var context = this, args = arguments, later, callNow;\r\n                    later = function() {\r\n                        timeout = null;\r\n                        if (!immediate) {\r\n                            result = func.apply(context, args);\r\n                        }\r\n                    };\r\n                    callNow = immediate && !timeout;\r\n                    clearTimeout(timeout);\r\n                    timeout = setTimeout(later, wait);\r\n                    if (callNow) {\r\n                        result = func.apply(context, args);\r\n                    }\r\n                    return result;\r\n                };\r\n            },\r\n            throttle: function(func, wait) {\r\n                var context, args, timeout, result, previous, later;\r\n                previous = 0;\r\n                later = function() {\r\n                    previous = new Date();\r\n                    timeout = null;\r\n                    result = func.apply(context, args);\r\n                };\r\n                return function() {\r\n                    var now = new Date(), remaining = wait - (now - previous);\r\n                    context = this;\r\n                    args = arguments;\r\n                    if (remaining <= 0) {\r\n                        clearTimeout(timeout);\r\n                        timeout = null;\r\n                        previous = now;\r\n                        result = func.apply(context, args);\r\n                    } else if (!timeout) {\r\n                        timeout = setTimeout(later, remaining);\r\n                    }\r\n                    return result;\r\n                };\r\n            },\r\n            stringify: function(val) {\r\n                return _.isString(val) ? val : JSON.stringify(val);\r\n            },\r\n            noop: function() {}\r\n        };\r\n    }();\r\n    var VERSION = \"0.11.1\";\r\n    var tokenizers = function() {\r\n        \"use strict\";\r\n        return {\r\n            nonword: nonword,\r\n            whitespace: whitespace,\r\n            obj: {\r\n                nonword: getObjTokenizer(nonword),\r\n                whitespace: getObjTokenizer(whitespace)\r\n            }\r\n        };\r\n        function whitespace(str) {\r\n            str = _.toStr(str);\r\n            return str ? str.split(/\\s+/) : [];\r\n        }\r\n        function nonword(str) {\r\n            str = _.toStr(str);\r\n            return str ? str.split(/\\W+/) : [];\r\n        }\r\n        function getObjTokenizer(tokenizer) {\r\n            return function setKey(keys) {\r\n                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);\r\n                return function tokenize(o) {\r\n                    var tokens = [];\r\n                    _.each(keys, function(k) {\r\n                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));\r\n                    });\r\n                    return tokens;\r\n                };\r\n            };\r\n        }\r\n    }();\r\n    var LruCache = function() {\r\n        \"use strict\";\r\n        function LruCache(maxSize) {\r\n            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;\r\n            this.reset();\r\n            if (this.maxSize <= 0) {\r\n                this.set = this.get = $.noop;\r\n            }\r\n        }\r\n        _.mixin(LruCache.prototype, {\r\n            set: function set(key, val) {\r\n                var tailItem = this.list.tail, node;\r\n                if (this.size >= this.maxSize) {\r\n                    this.list.remove(tailItem);\r\n                    delete this.hash[tailItem.key];\r\n                    this.size--;\r\n                }\r\n                if (node = this.hash[key]) {\r\n                    node.val = val;\r\n                    this.list.moveToFront(node);\r\n                } else {\r\n                    node = new Node(key, val);\r\n                    this.list.add(node);\r\n                    this.hash[key] = node;\r\n                    this.size++;\r\n                }\r\n            },\r\n            get: function get(key) {\r\n                var node = this.hash[key];\r\n                if (node) {\r\n                    this.list.moveToFront(node);\r\n                    return node.val;\r\n                }\r\n            },\r\n            reset: function reset() {\r\n                this.size = 0;\r\n                this.hash = {};\r\n                this.list = new List();\r\n            }\r\n        });\r\n        function List() {\r\n            this.head = this.tail = null;\r\n        }\r\n        _.mixin(List.prototype, {\r\n            add: function add(node) {\r\n                if (this.head) {\r\n                    node.next = this.head;\r\n                    this.head.prev = node;\r\n                }\r\n                this.head = node;\r\n                this.tail = this.tail || node;\r\n            },\r\n            remove: function remove(node) {\r\n                node.prev ? node.prev.next = node.next : this.head = node.next;\r\n                node.next ? node.next.prev = node.prev : this.tail = node.prev;\r\n            },\r\n            moveToFront: function(node) {\r\n                this.remove(node);\r\n                this.add(node);\r\n            }\r\n        });\r\n        function Node(key, val) {\r\n            this.key = key;\r\n            this.val = val;\r\n            this.prev = this.next = null;\r\n        }\r\n        return LruCache;\r\n    }();\r\n    var PersistentStorage = function() {\r\n        \"use strict\";\r\n        var LOCAL_STORAGE;\r\n        try {\r\n            LOCAL_STORAGE = window.localStorage;\r\n            LOCAL_STORAGE.setItem(\"~~~\", \"!\");\r\n            LOCAL_STORAGE.removeItem(\"~~~\");\r\n        } catch (err) {\r\n            LOCAL_STORAGE = null;\r\n        }\r\n        function PersistentStorage(namespace, override) {\r\n            this.prefix = [ \"__\", namespace, \"__\" ].join(\"\");\r\n            this.ttlKey = \"__ttl__\";\r\n            this.keyMatcher = new RegExp(\"^\" + _.escapeRegExChars(this.prefix));\r\n            this.ls = override || LOCAL_STORAGE;\r\n            !this.ls && this._noop();\r\n        }\r\n        _.mixin(PersistentStorage.prototype, {\r\n            _prefix: function(key) {\r\n                return this.prefix + key;\r\n            },\r\n            _ttlKey: function(key) {\r\n                return this._prefix(key) + this.ttlKey;\r\n            },\r\n            _noop: function() {\r\n                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;\r\n            },\r\n            _safeSet: function(key, val) {\r\n                try {\r\n                    this.ls.setItem(key, val);\r\n                } catch (err) {\r\n                    if (err.name === \"QuotaExceededError\") {\r\n                        this.clear();\r\n                        this._noop();\r\n                    }\r\n                }\r\n            },\r\n            get: function(key) {\r\n                if (this.isExpired(key)) {\r\n                    this.remove(key);\r\n                }\r\n                return decode(this.ls.getItem(this._prefix(key)));\r\n            },\r\n            set: function(key, val, ttl) {\r\n                if (_.isNumber(ttl)) {\r\n                    this._safeSet(this._ttlKey(key), encode(now() + ttl));\r\n                } else {\r\n                    this.ls.removeItem(this._ttlKey(key));\r\n                }\r\n                return this._safeSet(this._prefix(key), encode(val));\r\n            },\r\n            remove: function(key) {\r\n                this.ls.removeItem(this._ttlKey(key));\r\n                this.ls.removeItem(this._prefix(key));\r\n                return this;\r\n            },\r\n            clear: function() {\r\n                var i, keys = gatherMatchingKeys(this.keyMatcher);\r\n                for (i = keys.length; i--; ) {\r\n                    this.remove(keys[i]);\r\n                }\r\n                return this;\r\n            },\r\n            isExpired: function(key) {\r\n                var ttl = decode(this.ls.getItem(this._ttlKey(key)));\r\n                return _.isNumber(ttl) && now() > ttl ? true : false;\r\n            }\r\n        });\r\n        return PersistentStorage;\r\n        function now() {\r\n            return new Date().getTime();\r\n        }\r\n        function encode(val) {\r\n            return JSON.stringify(_.isUndefined(val) ? null : val);\r\n        }\r\n        function decode(val) {\r\n            return $.parseJSON(val);\r\n        }\r\n        function gatherMatchingKeys(keyMatcher) {\r\n            var i, key, keys = [], len = LOCAL_STORAGE.length;\r\n            for (i = 0; i < len; i++) {\r\n                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {\r\n                    keys.push(key.replace(keyMatcher, \"\"));\r\n                }\r\n            }\r\n            return keys;\r\n        }\r\n    }();\r\n    var Transport = function() {\r\n        \"use strict\";\r\n        var pendingRequestsCount = 0, pendingRequests = {}, maxPendingRequests = 6, sharedCache = new LruCache(10);\r\n        function Transport(o) {\r\n            o = o || {};\r\n            this.cancelled = false;\r\n            this.lastReq = null;\r\n            this._send = o.transport;\r\n            this._get = o.limiter ? o.limiter(this._get) : this._get;\r\n            this._cache = o.cache === false ? new LruCache(0) : sharedCache;\r\n        }\r\n        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {\r\n            maxPendingRequests = num;\r\n        };\r\n        Transport.resetCache = function resetCache() {\r\n            sharedCache.reset();\r\n        };\r\n        _.mixin(Transport.prototype, {\r\n            _fingerprint: function fingerprint(o) {\r\n                o = o || {};\r\n                return o.url + o.type + $.param(o.data || {});\r\n            },\r\n            _get: function(o, cb) {\r\n                var that = this, fingerprint, jqXhr;\r\n                fingerprint = this._fingerprint(o);\r\n                if (this.cancelled || fingerprint !== this.lastReq) {\r\n                    return;\r\n                }\r\n                if (jqXhr = pendingRequests[fingerprint]) {\r\n                    jqXhr.done(done).fail(fail);\r\n                } else if (pendingRequestsCount < maxPendingRequests) {\r\n                    pendingRequestsCount++;\r\n                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);\r\n                } else {\r\n                    this.onDeckRequestArgs = [].slice.call(arguments, 0);\r\n                }\r\n                function done(resp) {\r\n                    cb(null, resp);\r\n                    that._cache.set(fingerprint, resp);\r\n                }\r\n                function fail() {\r\n                    cb(true);\r\n                }\r\n                function always() {\r\n                    pendingRequestsCount--;\r\n                    delete pendingRequests[fingerprint];\r\n                    if (that.onDeckRequestArgs) {\r\n                        that._get.apply(that, that.onDeckRequestArgs);\r\n                        that.onDeckRequestArgs = null;\r\n                    }\r\n                }\r\n            },\r\n            get: function(o, cb) {\r\n                var resp, fingerprint;\r\n                cb = cb || $.noop;\r\n                o = _.isString(o) ? {\r\n                    url: o\r\n                } : o || {};\r\n                fingerprint = this._fingerprint(o);\r\n                this.cancelled = false;\r\n                this.lastReq = fingerprint;\r\n                if (resp = this._cache.get(fingerprint)) {\r\n                    cb(null, resp);\r\n                } else {\r\n                    this._get(o, cb);\r\n                }\r\n            },\r\n            cancel: function() {\r\n                this.cancelled = true;\r\n            }\r\n        });\r\n        return Transport;\r\n    }();\r\n    var SearchIndex = window.SearchIndex = function() {\r\n        \"use strict\";\r\n        var CHILDREN = \"c\", IDS = \"i\";\r\n        function SearchIndex(o) {\r\n            o = o || {};\r\n            if (!o.datumTokenizer || !o.queryTokenizer) {\r\n                $.error(\"datumTokenizer and queryTokenizer are both required\");\r\n            }\r\n            this.identify = o.identify || _.stringify;\r\n            this.datumTokenizer = o.datumTokenizer;\r\n            this.queryTokenizer = o.queryTokenizer;\r\n            this.reset();\r\n        }\r\n        _.mixin(SearchIndex.prototype, {\r\n            bootstrap: function bootstrap(o) {\r\n                this.datums = o.datums;\r\n                this.trie = o.trie;\r\n            },\r\n            add: function(data) {\r\n                var that = this;\r\n                data = _.isArray(data) ? data : [ data ];\r\n                _.each(data, function(datum) {\r\n                    var id, tokens;\r\n                    that.datums[id = that.identify(datum)] = datum;\r\n                    tokens = normalizeTokens(that.datumTokenizer(datum));\r\n                    _.each(tokens, function(token) {\r\n                        var node, chars, ch;\r\n                        node = that.trie;\r\n                        chars = token.split(\"\");\r\n                        while (ch = chars.shift()) {\r\n                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());\r\n                            node[IDS].push(id);\r\n                        }\r\n                    });\r\n                });\r\n            },\r\n            get: function get(ids) {\r\n                var that = this;\r\n                return _.map(ids, function(id) {\r\n                    return that.datums[id];\r\n                });\r\n            },\r\n            search: function search(query) {\r\n                var that = this, tokens, matches;\r\n                tokens = normalizeTokens(this.queryTokenizer(query));\r\n                _.each(tokens, function(token) {\r\n                    var node, chars, ch, ids;\r\n                    if (matches && matches.length === 0) {\r\n                        return false;\r\n                    }\r\n                    node = that.trie;\r\n                    chars = token.split(\"\");\r\n                    while (node && (ch = chars.shift())) {\r\n                        node = node[CHILDREN][ch];\r\n                    }\r\n                    if (node && chars.length === 0) {\r\n                        ids = node[IDS].slice(0);\r\n                        matches = matches ? getIntersection(matches, ids) : ids;\r\n                    } else {\r\n                        matches = [];\r\n                        return false;\r\n                    }\r\n                });\r\n                return matches ? _.map(unique(matches), function(id) {\r\n                    return that.datums[id];\r\n                }) : [];\r\n            },\r\n            all: function all() {\r\n                var values = [];\r\n                for (var key in this.datums) {\r\n                    values.push(this.datums[key]);\r\n                }\r\n                return values;\r\n            },\r\n            reset: function reset() {\r\n                this.datums = {};\r\n                this.trie = newNode();\r\n            },\r\n            serialize: function serialize() {\r\n                return {\r\n                    datums: this.datums,\r\n                    trie: this.trie\r\n                };\r\n            }\r\n        });\r\n        return SearchIndex;\r\n        function normalizeTokens(tokens) {\r\n            tokens = _.filter(tokens, function(token) {\r\n                return !!token;\r\n            });\r\n            tokens = _.map(tokens, function(token) {\r\n                return token.toLowerCase();\r\n            });\r\n            return tokens;\r\n        }\r\n        function newNode() {\r\n            var node = {};\r\n            node[IDS] = [];\r\n            node[CHILDREN] = {};\r\n            return node;\r\n        }\r\n        function unique(array) {\r\n            var seen = {}, uniques = [];\r\n            for (var i = 0, len = array.length; i < len; i++) {\r\n                if (!seen[array[i]]) {\r\n                    seen[array[i]] = true;\r\n                    uniques.push(array[i]);\r\n                }\r\n            }\r\n            return uniques;\r\n        }\r\n        function getIntersection(arrayA, arrayB) {\r\n            var ai = 0, bi = 0, intersection = [];\r\n            arrayA = arrayA.sort();\r\n            arrayB = arrayB.sort();\r\n            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;\r\n            while (ai < lenArrayA && bi < lenArrayB) {\r\n                if (arrayA[ai] < arrayB[bi]) {\r\n                    ai++;\r\n                } else if (arrayA[ai] > arrayB[bi]) {\r\n                    bi++;\r\n                } else {\r\n                    intersection.push(arrayA[ai]);\r\n                    ai++;\r\n                    bi++;\r\n                }\r\n            }\r\n            return intersection;\r\n        }\r\n    }();\r\n    var Prefetch = function() {\r\n        \"use strict\";\r\n        var keys;\r\n        keys = {\r\n            data: \"data\",\r\n            protocol: \"protocol\",\r\n            thumbprint: \"thumbprint\"\r\n        };\r\n        function Prefetch(o) {\r\n            this.url = o.url;\r\n            this.ttl = o.ttl;\r\n            this.cache = o.cache;\r\n            this.prepare = o.prepare;\r\n            this.transform = o.transform;\r\n            this.transport = o.transport;\r\n            this.thumbprint = o.thumbprint;\r\n            this.storage = new PersistentStorage(o.cacheKey);\r\n        }\r\n        _.mixin(Prefetch.prototype, {\r\n            _settings: function settings() {\r\n                return {\r\n                    url: this.url,\r\n                    type: \"GET\",\r\n                    dataType: \"json\"\r\n                };\r\n            },\r\n            store: function store(data) {\r\n                if (!this.cache) {\r\n                    return;\r\n                }\r\n                this.storage.set(keys.data, data, this.ttl);\r\n                this.storage.set(keys.protocol, location.protocol, this.ttl);\r\n                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);\r\n            },\r\n            fromCache: function fromCache() {\r\n                var stored = {}, isExpired;\r\n                if (!this.cache) {\r\n                    return null;\r\n                }\r\n                stored.data = this.storage.get(keys.data);\r\n                stored.protocol = this.storage.get(keys.protocol);\r\n                stored.thumbprint = this.storage.get(keys.thumbprint);\r\n                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;\r\n                return stored.data && !isExpired ? stored.data : null;\r\n            },\r\n            fromNetwork: function(cb) {\r\n                var that = this, settings;\r\n                if (!cb) {\r\n                    return;\r\n                }\r\n                settings = this.prepare(this._settings());\r\n                this.transport(settings).fail(onError).done(onResponse);\r\n                function onError() {\r\n                    cb(true);\r\n                }\r\n                function onResponse(resp) {\r\n                    cb(null, that.transform(resp));\r\n                }\r\n            },\r\n            clear: function clear() {\r\n                this.storage.clear();\r\n                return this;\r\n            }\r\n        });\r\n        return Prefetch;\r\n    }();\r\n    var Remote = function() {\r\n        \"use strict\";\r\n        function Remote(o) {\r\n            this.url = o.url;\r\n            this.prepare = o.prepare;\r\n            this.transform = o.transform;\r\n            this.transport = new Transport({\r\n                cache: o.cache,\r\n                limiter: o.limiter,\r\n                transport: o.transport\r\n            });\r\n        }\r\n        _.mixin(Remote.prototype, {\r\n            _settings: function settings() {\r\n                return {\r\n                    url: this.url,\r\n                    type: \"GET\",\r\n                    dataType: \"json\"\r\n                };\r\n            },\r\n            get: function get(query, cb) {\r\n                var that = this, settings;\r\n                if (!cb) {\r\n                    return;\r\n                }\r\n                query = query || \"\";\r\n                settings = this.prepare(query, this._settings());\r\n                return this.transport.get(settings, onResponse);\r\n                function onResponse(err, resp) {\r\n                    err ? cb([]) : cb(that.transform(resp));\r\n                }\r\n            },\r\n            cancelLastRequest: function cancelLastRequest() {\r\n                this.transport.cancel();\r\n            }\r\n        });\r\n        return Remote;\r\n    }();\r\n    var oParser = function() {\r\n        \"use strict\";\r\n        return function parse(o) {\r\n            var defaults, sorter;\r\n            defaults = {\r\n                initialize: true,\r\n                identify: _.stringify,\r\n                datumTokenizer: null,\r\n                queryTokenizer: null,\r\n                sufficient: 5,\r\n                sorter: null,\r\n                local: [],\r\n                prefetch: null,\r\n                remote: null\r\n            };\r\n            o = _.mixin(defaults, o || {});\r\n            !o.datumTokenizer && $.error(\"datumTokenizer is required\");\r\n            !o.queryTokenizer && $.error(\"queryTokenizer is required\");\r\n            sorter = o.sorter;\r\n            o.sorter = sorter ? function(x) {\r\n                return x.sort(sorter);\r\n            } : _.identity;\r\n            o.local = _.isFunction(o.local) ? o.local() : o.local;\r\n            o.prefetch = parsePrefetch(o.prefetch);\r\n            o.remote = parseRemote(o.remote);\r\n            return o;\r\n        };\r\n        function parsePrefetch(o) {\r\n            var defaults;\r\n            if (!o) {\r\n                return null;\r\n            }\r\n            defaults = {\r\n                url: null,\r\n                ttl: 24 * 60 * 60 * 1e3,\r\n                cache: true,\r\n                cacheKey: null,\r\n                thumbprint: \"\",\r\n                prepare: _.identity,\r\n                transform: _.identity,\r\n                transport: null\r\n            };\r\n            o = _.isString(o) ? {\r\n                url: o\r\n            } : o;\r\n            o = _.mixin(defaults, o);\r\n            !o.url && $.error(\"prefetch requires url to be set\");\r\n            o.transform = o.filter || o.transform;\r\n            o.cacheKey = o.cacheKey || o.url;\r\n            o.thumbprint = VERSION + o.thumbprint;\r\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\r\n            return o;\r\n        }\r\n        function parseRemote(o) {\r\n            var defaults;\r\n            if (!o) {\r\n                return;\r\n            }\r\n            defaults = {\r\n                url: null,\r\n                cache: true,\r\n                prepare: null,\r\n                replace: null,\r\n                wildcard: null,\r\n                limiter: null,\r\n                rateLimitBy: \"debounce\",\r\n                rateLimitWait: 300,\r\n                transform: _.identity,\r\n                transport: null\r\n            };\r\n            o = _.isString(o) ? {\r\n                url: o\r\n            } : o;\r\n            o = _.mixin(defaults, o);\r\n            !o.url && $.error(\"remote requires url to be set\");\r\n            o.transform = o.filter || o.transform;\r\n            o.prepare = toRemotePrepare(o);\r\n            o.limiter = toLimiter(o);\r\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\r\n            delete o.replace;\r\n            delete o.wildcard;\r\n            delete o.rateLimitBy;\r\n            delete o.rateLimitWait;\r\n            return o;\r\n        }\r\n        function toRemotePrepare(o) {\r\n            var prepare, replace, wildcard;\r\n            prepare = o.prepare;\r\n            replace = o.replace;\r\n            wildcard = o.wildcard;\r\n            if (prepare) {\r\n                return prepare;\r\n            }\r\n            if (replace) {\r\n                prepare = prepareByReplace;\r\n            } else if (o.wildcard) {\r\n                prepare = prepareByWildcard;\r\n            } else {\r\n                prepare = idenityPrepare;\r\n            }\r\n            return prepare;\r\n            function prepareByReplace(query, settings) {\r\n                settings.url = replace(settings.url, query);\r\n                return settings;\r\n            }\r\n            function prepareByWildcard(query, settings) {\r\n                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));\r\n                return settings;\r\n            }\r\n            function idenityPrepare(query, settings) {\r\n                return settings;\r\n            }\r\n        }\r\n        function toLimiter(o) {\r\n            var limiter, method, wait;\r\n            limiter = o.limiter;\r\n            method = o.rateLimitBy;\r\n            wait = o.rateLimitWait;\r\n            if (!limiter) {\r\n                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);\r\n            }\r\n            return limiter;\r\n            function debounce(wait) {\r\n                return function debounce(fn) {\r\n                    return _.debounce(fn, wait);\r\n                };\r\n            }\r\n            function throttle(wait) {\r\n                return function throttle(fn) {\r\n                    return _.throttle(fn, wait);\r\n                };\r\n            }\r\n        }\r\n        function callbackToDeferred(fn) {\r\n            return function wrapper(o) {\r\n                var deferred = $.Deferred();\r\n                fn(o, onSuccess, onError);\r\n                return deferred;\r\n                function onSuccess(resp) {\r\n                    _.defer(function() {\r\n                        deferred.resolve(resp);\r\n                    });\r\n                }\r\n                function onError(err) {\r\n                    _.defer(function() {\r\n                        deferred.reject(err);\r\n                    });\r\n                }\r\n            };\r\n        }\r\n    }();\r\n    var Bloodhound = function() {\r\n        \"use strict\";\r\n        var old;\r\n        old = window && window.Bloodhound;\r\n        function Bloodhound(o) {\r\n            o = oParser(o);\r\n            this.sorter = o.sorter;\r\n            this.identify = o.identify;\r\n            this.sufficient = o.sufficient;\r\n            this.local = o.local;\r\n            this.remote = o.remote ? new Remote(o.remote) : null;\r\n            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;\r\n            this.index = new SearchIndex({\r\n                identify: this.identify,\r\n                datumTokenizer: o.datumTokenizer,\r\n                queryTokenizer: o.queryTokenizer\r\n            });\r\n            o.initialize !== false && this.initialize();\r\n        }\r\n        Bloodhound.noConflict = function noConflict() {\r\n            window && (window.Bloodhound = old);\r\n            return Bloodhound;\r\n        };\r\n        Bloodhound.tokenizers = tokenizers;\r\n        _.mixin(Bloodhound.prototype, {\r\n            __ttAdapter: function ttAdapter() {\r\n                var that = this;\r\n                return this.remote ? withAsync : withoutAsync;\r\n                function withAsync(query, sync, async) {\r\n                    return that.search(query, sync, async);\r\n                }\r\n                function withoutAsync(query, sync) {\r\n                    return that.search(query, sync);\r\n                }\r\n            },\r\n            _loadPrefetch: function loadPrefetch() {\r\n                var that = this, deferred, serialized;\r\n                deferred = $.Deferred();\r\n                if (!this.prefetch) {\r\n                    deferred.resolve();\r\n                } else if (serialized = this.prefetch.fromCache()) {\r\n                    this.index.bootstrap(serialized);\r\n                    deferred.resolve();\r\n                } else {\r\n                    this.prefetch.fromNetwork(done);\r\n                }\r\n                return deferred.promise();\r\n                function done(err, data) {\r\n                    if (err) {\r\n                        return deferred.reject();\r\n                    }\r\n                    that.add(data);\r\n                    that.prefetch.store(that.index.serialize());\r\n                    deferred.resolve();\r\n                }\r\n            },\r\n            _initialize: function initialize() {\r\n                var that = this, deferred;\r\n                this.clear();\r\n                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);\r\n                return this.initPromise;\r\n                function addLocalToIndex() {\r\n                    that.add(that.local);\r\n                }\r\n            },\r\n            initialize: function initialize(force) {\r\n                return !this.initPromise || force ? this._initialize() : this.initPromise;\r\n            },\r\n            add: function add(data) {\r\n                this.index.add(data);\r\n                return this;\r\n            },\r\n            get: function get(ids) {\r\n                ids = _.isArray(ids) ? ids : [].slice.call(arguments);\r\n                return this.index.get(ids);\r\n            },\r\n            search: function search(query, sync, async) {\r\n                var that = this, local;\r\n                local = this.sorter(this.index.search(query));\r\n                sync(this.remote ? local.slice() : local);\r\n                if (this.remote && local.length < this.sufficient) {\r\n                    this.remote.get(query, processRemote);\r\n                } else if (this.remote) {\r\n                    this.remote.cancelLastRequest();\r\n                }\r\n                return this;\r\n                function processRemote(remote) {\r\n                    var nonDuplicates = [];\r\n                    _.each(remote, function(r) {\r\n                        !_.some(local, function(l) {\r\n                            return that.identify(r) === that.identify(l);\r\n                        }) && nonDuplicates.push(r);\r\n                    });\r\n                    async && async(nonDuplicates);\r\n                }\r\n            },\r\n            all: function all() {\r\n                return this.index.all();\r\n            },\r\n            clear: function clear() {\r\n                this.index.reset();\r\n                return this;\r\n            },\r\n            clearPrefetchCache: function clearPrefetchCache() {\r\n                this.prefetch && this.prefetch.clear();\r\n                return this;\r\n            },\r\n            clearRemoteCache: function clearRemoteCache() {\r\n                Transport.resetCache();\r\n                return this;\r\n            },\r\n            ttAdapter: function ttAdapter() {\r\n                return this.__ttAdapter();\r\n            }\r\n        });\r\n        return Bloodhound;\r\n    }();\r\n    return Bloodhound;\r\n});\r\n\r\n(function(root, factory) {\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"typeahead.js\", [ \"jquery\" ], function(a0) {\r\n            return factory(a0);\r\n        });\r\n    } else if (typeof exports === \"object\") {\r\n        module.exports = factory(require(\"jquery\"));\r\n    } else {\r\n        factory(jQuery);\r\n    }\r\n})(this, function($) {\r\n    var _ = function() {\r\n        \"use strict\";\r\n        return {\r\n            isMsie: function() {\r\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\r\n            },\r\n            isBlankString: function(str) {\r\n                return !str || /^\\s*$/.test(str);\r\n            },\r\n            escapeRegExChars: function(str) {\r\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\r\n            },\r\n            isString: function(obj) {\r\n                return typeof obj === \"string\";\r\n            },\r\n            isNumber: function(obj) {\r\n                return typeof obj === \"number\";\r\n            },\r\n            isArray: $.isArray,\r\n            isFunction: $.isFunction,\r\n            isObject: $.isPlainObject,\r\n            isUndefined: function(obj) {\r\n                return typeof obj === \"undefined\";\r\n            },\r\n            isElement: function(obj) {\r\n                return !!(obj && obj.nodeType === 1);\r\n            },\r\n            isJQuery: function(obj) {\r\n                return obj instanceof $;\r\n            },\r\n            toStr: function toStr(s) {\r\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\r\n            },\r\n            bind: $.proxy,\r\n            each: function(collection, cb) {\r\n                $.each(collection, reverseArgs);\r\n                function reverseArgs(index, value) {\r\n                    return cb(value, index);\r\n                }\r\n            },\r\n            map: $.map,\r\n            filter: $.grep,\r\n            every: function(obj, test) {\r\n                var result = true;\r\n                if (!obj) {\r\n                    return result;\r\n                }\r\n                $.each(obj, function(key, val) {\r\n                    if (!(result = test.call(null, val, key, obj))) {\r\n                        return false;\r\n                    }\r\n                });\r\n                return !!result;\r\n            },\r\n            some: function(obj, test) {\r\n                var result = false;\r\n                if (!obj) {\r\n                    return result;\r\n                }\r\n                $.each(obj, function(key, val) {\r\n                    if (result = test.call(null, val, key, obj)) {\r\n                        return false;\r\n                    }\r\n                });\r\n                return !!result;\r\n            },\r\n            mixin: $.extend,\r\n            identity: function(x) {\r\n                return x;\r\n            },\r\n            clone: function(obj) {\r\n                return $.extend(true, {}, obj);\r\n            },\r\n            getIdGenerator: function() {\r\n                var counter = 0;\r\n                return function() {\r\n                    return counter++;\r\n                };\r\n            },\r\n            templatify: function templatify(obj) {\r\n                return $.isFunction(obj) ? obj : template;\r\n                function template() {\r\n                    return String(obj);\r\n                }\r\n            },\r\n            defer: function(fn) {\r\n                setTimeout(fn, 0);\r\n            },\r\n            debounce: function(func, wait, immediate) {\r\n                var timeout, result;\r\n                return function() {\r\n                    var context = this, args = arguments, later, callNow;\r\n                    later = function() {\r\n                        timeout = null;\r\n                        if (!immediate) {\r\n                            result = func.apply(context, args);\r\n                        }\r\n                    };\r\n                    callNow = immediate && !timeout;\r\n                    clearTimeout(timeout);\r\n                    timeout = setTimeout(later, wait);\r\n                    if (callNow) {\r\n                        result = func.apply(context, args);\r\n                    }\r\n                    return result;\r\n                };\r\n            },\r\n            throttle: function(func, wait) {\r\n                var context, args, timeout, result, previous, later;\r\n                previous = 0;\r\n                later = function() {\r\n                    previous = new Date();\r\n                    timeout = null;\r\n                    result = func.apply(context, args);\r\n                };\r\n                return function() {\r\n                    var now = new Date(), remaining = wait - (now - previous);\r\n                    context = this;\r\n                    args = arguments;\r\n                    if (remaining <= 0) {\r\n                        clearTimeout(timeout);\r\n                        timeout = null;\r\n                        previous = now;\r\n                        result = func.apply(context, args);\r\n                    } else if (!timeout) {\r\n                        timeout = setTimeout(later, remaining);\r\n                    }\r\n                    return result;\r\n                };\r\n            },\r\n            stringify: function(val) {\r\n                return _.isString(val) ? val : JSON.stringify(val);\r\n            },\r\n            noop: function() {}\r\n        };\r\n    }();\r\n    var WWW = function() {\r\n        \"use strict\";\r\n        var defaultClassNames = {\r\n            wrapper: \"twitter-typeahead\",\r\n            input: \"tt-input\",\r\n            hint: \"tt-hint\",\r\n            menu: \"tt-menu\",\r\n            dataset: \"tt-dataset\",\r\n            suggestion: \"tt-suggestion\",\r\n            selectable: \"tt-selectable\",\r\n            empty: \"tt-empty\",\r\n            open: \"tt-open\",\r\n            cursor: \"tt-cursor\",\r\n            highlight: \"tt-highlight\"\r\n        };\r\n        return build;\r\n        function build(o) {\r\n            var www, classes;\r\n            classes = _.mixin({}, defaultClassNames, o);\r\n            www = {\r\n                css: buildCss(),\r\n                classes: classes,\r\n                html: buildHtml(classes),\r\n                selectors: buildSelectors(classes)\r\n            };\r\n            return {\r\n                css: www.css,\r\n                html: www.html,\r\n                classes: www.classes,\r\n                selectors: www.selectors,\r\n                mixin: function(o) {\r\n                    _.mixin(o, www);\r\n                }\r\n            };\r\n        }\r\n        function buildHtml(c) {\r\n            return {\r\n                wrapper: '<span class=\"' + c.wrapper + '\"></span>',\r\n                menu: '<div class=\"' + c.menu + '\"></div>'\r\n            };\r\n        }\r\n        function buildSelectors(classes) {\r\n            var selectors = {};\r\n            _.each(classes, function(v, k) {\r\n                selectors[k] = \".\" + v;\r\n            });\r\n            return selectors;\r\n        }\r\n        function buildCss() {\r\n            var css = {\r\n                wrapper: {\r\n                    position: \"relative\",\r\n                    display: \"inline-block\"\r\n                },\r\n                hint: {\r\n                    position: \"absolute\",\r\n                    top: \"0\",\r\n                    left: \"0\",\r\n                    borderColor: \"transparent\",\r\n                    boxShadow: \"none\",\r\n                    opacity: \"1\"\r\n                },\r\n                input: {\r\n                    position: \"relative\",\r\n                    verticalAlign: \"top\",\r\n                    backgroundColor: \"transparent\"\r\n                },\r\n                inputWithNoHint: {\r\n                    position: \"relative\",\r\n                    verticalAlign: \"top\"\r\n                },\r\n                menu: {\r\n                    position: \"absolute\",\r\n                    top: \"100%\",\r\n                    left: \"0\",\r\n                    zIndex: \"100\",\r\n                    display: \"none\"\r\n                },\r\n                ltr: {\r\n                    left: \"0\",\r\n                    right: \"auto\"\r\n                },\r\n                rtl: {\r\n                    left: \"auto\",\r\n                    right: \" 0\"\r\n                }\r\n            };\r\n            if (_.isMsie()) {\r\n                _.mixin(css.input, {\r\n                    backgroundImage: \"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)\"\r\n                });\r\n            }\r\n            return css;\r\n        }\r\n    }();\r\n    var EventBus = function() {\r\n        \"use strict\";\r\n        var namespace, deprecationMap;\r\n        namespace = \"typeahead:\";\r\n        deprecationMap = {\r\n            render: \"rendered\",\r\n            cursorchange: \"cursorchanged\",\r\n            select: \"selected\",\r\n            autocomplete: \"autocompleted\"\r\n        };\r\n        function EventBus(o) {\r\n            if (!o || !o.el) {\r\n                $.error(\"EventBus initialized without el\");\r\n            }\r\n            this.$el = $(o.el);\r\n        }\r\n        _.mixin(EventBus.prototype, {\r\n            _trigger: function(type, args) {\r\n                var $e;\r\n                $e = $.Event(namespace + type);\r\n                (args = args || []).unshift($e);\r\n                this.$el.trigger.apply(this.$el, args);\r\n                return $e;\r\n            },\r\n            before: function(type) {\r\n                var args, $e;\r\n                args = [].slice.call(arguments, 1);\r\n                $e = this._trigger(\"before\" + type, args);\r\n                return $e.isDefaultPrevented();\r\n            },\r\n            trigger: function(type) {\r\n                var deprecatedType;\r\n                this._trigger(type, [].slice.call(arguments, 1));\r\n                if (deprecatedType = deprecationMap[type]) {\r\n                    this._trigger(deprecatedType, [].slice.call(arguments, 1));\r\n                }\r\n            }\r\n        });\r\n        return EventBus;\r\n    }();\r\n    var EventEmitter = function() {\r\n        \"use strict\";\r\n        var splitter = /\\s+/, nextTick = getNextTick();\r\n        return {\r\n            onSync: onSync,\r\n            onAsync: onAsync,\r\n            off: off,\r\n            trigger: trigger\r\n        };\r\n        function on(method, types, cb, context) {\r\n            var type;\r\n            if (!cb) {\r\n                return this;\r\n            }\r\n            types = types.split(splitter);\r\n            cb = context ? bindContext(cb, context) : cb;\r\n            this._callbacks = this._callbacks || {};\r\n            while (type = types.shift()) {\r\n                this._callbacks[type] = this._callbacks[type] || {\r\n                    sync: [],\r\n                    async: []\r\n                };\r\n                this._callbacks[type][method].push(cb);\r\n            }\r\n            return this;\r\n        }\r\n        function onAsync(types, cb, context) {\r\n            return on.call(this, \"async\", types, cb, context);\r\n        }\r\n        function onSync(types, cb, context) {\r\n            return on.call(this, \"sync\", types, cb, context);\r\n        }\r\n        function off(types) {\r\n            var type;\r\n            if (!this._callbacks) {\r\n                return this;\r\n            }\r\n            types = types.split(splitter);\r\n            while (type = types.shift()) {\r\n                delete this._callbacks[type];\r\n            }\r\n            return this;\r\n        }\r\n        function trigger(types) {\r\n            var type, callbacks, args, syncFlush, asyncFlush;\r\n            if (!this._callbacks) {\r\n                return this;\r\n            }\r\n            types = types.split(splitter);\r\n            args = [].slice.call(arguments, 1);\r\n            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {\r\n                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));\r\n                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));\r\n                syncFlush() && nextTick(asyncFlush);\r\n            }\r\n            return this;\r\n        }\r\n        function getFlush(callbacks, context, args) {\r\n            return flush;\r\n            function flush() {\r\n                var cancelled;\r\n                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {\r\n                    cancelled = callbacks[i].apply(context, args) === false;\r\n                }\r\n                return !cancelled;\r\n            }\r\n        }\r\n        function getNextTick() {\r\n            var nextTickFn;\r\n            if (window.setImmediate) {\r\n                nextTickFn = function nextTickSetImmediate(fn) {\r\n                    setImmediate(function() {\r\n                        fn();\r\n                    });\r\n                };\r\n            } else {\r\n                nextTickFn = function nextTickSetTimeout(fn) {\r\n                    setTimeout(function() {\r\n                        fn();\r\n                    }, 0);\r\n                };\r\n            }\r\n            return nextTickFn;\r\n        }\r\n        function bindContext(fn, context) {\r\n            return fn.bind ? fn.bind(context) : function() {\r\n                fn.apply(context, [].slice.call(arguments, 0));\r\n            };\r\n        }\r\n    }();\r\n    var highlight = function(doc) {\r\n        \"use strict\";\r\n        var defaults = {\r\n            node: null,\r\n            pattern: null,\r\n            tagName: \"strong\",\r\n            className: null,\r\n            wordsOnly: false,\r\n            caseSensitive: false\r\n        };\r\n        return function hightlight(o) {\r\n            var regex;\r\n            o = _.mixin({}, defaults, o);\r\n            if (!o.node || !o.pattern) {\r\n                return;\r\n            }\r\n            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];\r\n            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly);\r\n            traverse(o.node, hightlightTextNode);\r\n            function hightlightTextNode(textNode) {\r\n                var match, patternNode, wrapperNode;\r\n                if (match = regex.exec(textNode.data)) {\r\n                    wrapperNode = doc.createElement(o.tagName);\r\n                    o.className && (wrapperNode.className = o.className);\r\n                    patternNode = textNode.splitText(match.index);\r\n                    patternNode.splitText(match[0].length);\r\n                    wrapperNode.appendChild(patternNode.cloneNode(true));\r\n                    textNode.parentNode.replaceChild(wrapperNode, patternNode);\r\n                }\r\n                return !!match;\r\n            }\r\n            function traverse(el, hightlightTextNode) {\r\n                var childNode, TEXT_NODE_TYPE = 3;\r\n                for (var i = 0; i < el.childNodes.length; i++) {\r\n                    childNode = el.childNodes[i];\r\n                    if (childNode.nodeType === TEXT_NODE_TYPE) {\r\n                        i += hightlightTextNode(childNode) ? 1 : 0;\r\n                    } else {\r\n                        traverse(childNode, hightlightTextNode);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        function getRegex(patterns, caseSensitive, wordsOnly) {\r\n            var escapedPatterns = [], regexStr;\r\n            for (var i = 0, len = patterns.length; i < len; i++) {\r\n                escapedPatterns.push(_.escapeRegExChars(patterns[i]));\r\n            }\r\n            regexStr = wordsOnly ? \"\\\\b(\" + escapedPatterns.join(\"|\") + \")\\\\b\" : \"(\" + escapedPatterns.join(\"|\") + \")\";\r\n            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, \"i\");\r\n        }\r\n    }(window.document);\r\n    var Input = function() {\r\n        \"use strict\";\r\n        var specialKeyCodeMap;\r\n        specialKeyCodeMap = {\r\n            9: \"tab\",\r\n            27: \"esc\",\r\n            37: \"left\",\r\n            39: \"right\",\r\n            13: \"enter\",\r\n            38: \"up\",\r\n            40: \"down\"\r\n        };\r\n        function Input(o, www) {\r\n            o = o || {};\r\n            if (!o.input) {\r\n                $.error(\"input is missing\");\r\n            }\r\n            www.mixin(this);\r\n            this.$hint = $(o.hint);\r\n            this.$input = $(o.input);\r\n            this.query = this.$input.val();\r\n            this.queryWhenFocused = this.hasFocus() ? this.query : null;\r\n            this.$overflowHelper = buildOverflowHelper(this.$input);\r\n            this._checkLanguageDirection();\r\n            if (this.$hint.length === 0) {\r\n                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;\r\n            }\r\n        }\r\n        Input.normalizeQuery = function(str) {\r\n            return _.toStr(str).replace(/^\\s*/g, \"\").replace(/\\s{2,}/g, \" \");\r\n        };\r\n        _.mixin(Input.prototype, EventEmitter, {\r\n            _onBlur: function onBlur() {\r\n                this.resetInputValue();\r\n                this.trigger(\"blurred\");\r\n            },\r\n            _onFocus: function onFocus() {\r\n                this.queryWhenFocused = this.query;\r\n                this.trigger(\"focused\");\r\n            },\r\n            _onKeydown: function onKeydown($e) {\r\n                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];\r\n                this._managePreventDefault(keyName, $e);\r\n                if (keyName && this._shouldTrigger(keyName, $e)) {\r\n                    this.trigger(keyName + \"Keyed\", $e);\r\n                }\r\n            },\r\n            _onInput: function onInput() {\r\n                this._setQuery(this.getInputValue());\r\n                this.clearHintIfInvalid();\r\n                this._checkLanguageDirection();\r\n            },\r\n            _managePreventDefault: function managePreventDefault(keyName, $e) {\r\n                var preventDefault;\r\n                switch (keyName) {\r\n                  case \"up\":\r\n                  case \"down\":\r\n                    preventDefault = !withModifier($e);\r\n                    break;\r\n\r\n                  default:\r\n                    preventDefault = false;\r\n                }\r\n                preventDefault && $e.preventDefault();\r\n            },\r\n            _shouldTrigger: function shouldTrigger(keyName, $e) {\r\n                var trigger;\r\n                switch (keyName) {\r\n                  case \"tab\":\r\n                    trigger = !withModifier($e);\r\n                    break;\r\n\r\n                  default:\r\n                    trigger = true;\r\n                }\r\n                return trigger;\r\n            },\r\n            _checkLanguageDirection: function checkLanguageDirection() {\r\n                var dir = (this.$input.css(\"direction\") || \"ltr\").toLowerCase();\r\n                if (this.dir !== dir) {\r\n                    this.dir = dir;\r\n                    this.$hint.attr(\"dir\", dir);\r\n                    this.trigger(\"langDirChanged\", dir);\r\n                }\r\n            },\r\n            _setQuery: function setQuery(val, silent) {\r\n                var areEquivalent, hasDifferentWhitespace;\r\n                areEquivalent = areQueriesEquivalent(val, this.query);\r\n                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;\r\n                this.query = val;\r\n                if (!silent && !areEquivalent) {\r\n                    this.trigger(\"queryChanged\", this.query);\r\n                } else if (!silent && hasDifferentWhitespace) {\r\n                    this.trigger(\"whitespaceChanged\", this.query);\r\n                }\r\n            },\r\n            bind: function() {\r\n                var that = this, onBlur, onFocus, onKeydown, onInput;\r\n                onBlur = _.bind(this._onBlur, this);\r\n                onFocus = _.bind(this._onFocus, this);\r\n                onKeydown = _.bind(this._onKeydown, this);\r\n                onInput = _.bind(this._onInput, this);\r\n                this.$input.on(\"blur.tt\", onBlur).on(\"focus.tt\", onFocus).on(\"keydown.tt\", onKeydown);\r\n                if (!_.isMsie() || _.isMsie() > 9) {\r\n                    this.$input.on(\"input.tt\", onInput);\r\n                } else {\r\n                    this.$input.on(\"keydown.tt keypress.tt cut.tt paste.tt\", function($e) {\r\n                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {\r\n                            return;\r\n                        }\r\n                        _.defer(_.bind(that._onInput, that, $e));\r\n                    });\r\n                }\r\n                return this;\r\n            },\r\n            focus: function focus() {\r\n                this.$input.focus();\r\n            },\r\n            blur: function blur() {\r\n                this.$input.blur();\r\n            },\r\n            getLangDir: function getLangDir() {\r\n                return this.dir;\r\n            },\r\n            getQuery: function getQuery() {\r\n                return this.query || \"\";\r\n            },\r\n            setQuery: function setQuery(val, silent) {\r\n                this.setInputValue(val);\r\n                this._setQuery(val, silent);\r\n            },\r\n            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {\r\n                return this.query !== this.queryWhenFocused;\r\n            },\r\n            getInputValue: function getInputValue() {\r\n                return this.$input.val();\r\n            },\r\n            setInputValue: function setInputValue(value) {\r\n                this.$input.val(value);\r\n                this.clearHintIfInvalid();\r\n                this._checkLanguageDirection();\r\n            },\r\n            resetInputValue: function resetInputValue() {\r\n                this.setInputValue(this.query);\r\n            },\r\n            getHint: function getHint() {\r\n                return this.$hint.val();\r\n            },\r\n            setHint: function setHint(value) {\r\n                this.$hint.val(value);\r\n            },\r\n            clearHint: function clearHint() {\r\n                this.setHint(\"\");\r\n            },\r\n            clearHintIfInvalid: function clearHintIfInvalid() {\r\n                var val, hint, valIsPrefixOfHint, isValid;\r\n                val = this.getInputValue();\r\n                hint = this.getHint();\r\n                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;\r\n                isValid = val !== \"\" && valIsPrefixOfHint && !this.hasOverflow();\r\n                !isValid && this.clearHint();\r\n            },\r\n            hasFocus: function hasFocus() {\r\n                return this.$input.is(\":focus\");\r\n            },\r\n            hasOverflow: function hasOverflow() {\r\n                var constraint = this.$input.width() - 2;\r\n                this.$overflowHelper.text(this.getInputValue());\r\n                return this.$overflowHelper.width() >= constraint;\r\n            },\r\n            isCursorAtEnd: function() {\r\n                var valueLength, selectionStart, range;\r\n                valueLength = this.$input.val().length;\r\n                selectionStart = this.$input[0].selectionStart;\r\n                if (_.isNumber(selectionStart)) {\r\n                    return selectionStart === valueLength;\r\n                } else if (document.selection) {\r\n                    range = document.selection.createRange();\r\n                    range.moveStart(\"character\", -valueLength);\r\n                    return valueLength === range.text.length;\r\n                }\r\n                return true;\r\n            },\r\n            destroy: function destroy() {\r\n                this.$hint.off(\".tt\");\r\n                this.$input.off(\".tt\");\r\n                this.$overflowHelper.remove();\r\n                this.$hint = this.$input = this.$overflowHelper = $(\"<div>\");\r\n            }\r\n        });\r\n        return Input;\r\n        function buildOverflowHelper($input) {\r\n            return $('<pre aria-hidden=\"true\"></pre>').css({\r\n                position: \"absolute\",\r\n                visibility: \"hidden\",\r\n                whiteSpace: \"pre\",\r\n                fontFamily: $input.css(\"font-family\"),\r\n                fontSize: $input.css(\"font-size\"),\r\n                fontStyle: $input.css(\"font-style\"),\r\n                fontVariant: $input.css(\"font-variant\"),\r\n                fontWeight: $input.css(\"font-weight\"),\r\n                wordSpacing: $input.css(\"word-spacing\"),\r\n                letterSpacing: $input.css(\"letter-spacing\"),\r\n                textIndent: $input.css(\"text-indent\"),\r\n                textRendering: $input.css(\"text-rendering\"),\r\n                textTransform: $input.css(\"text-transform\")\r\n            }).insertAfter($input);\r\n        }\r\n        function areQueriesEquivalent(a, b) {\r\n            return Input.normalizeQuery(a) === Input.normalizeQuery(b);\r\n        }\r\n        function withModifier($e) {\r\n            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;\r\n        }\r\n    }();\r\n    var Dataset = function() {\r\n        \"use strict\";\r\n        var keys, nameGenerator;\r\n        keys = {\r\n            val: \"tt-selectable-display\",\r\n            obj: \"tt-selectable-object\"\r\n        };\r\n        nameGenerator = _.getIdGenerator();\r\n        function Dataset(o, www) {\r\n            o = o || {};\r\n            o.templates = o.templates || {};\r\n            o.templates.notFound = o.templates.notFound || o.templates.empty;\r\n            if (!o.source) {\r\n                $.error(\"missing source\");\r\n            }\r\n            if (!o.node) {\r\n                $.error(\"missing node\");\r\n            }\r\n            if (o.name && !isValidName(o.name)) {\r\n                $.error(\"invalid dataset name: \" + o.name);\r\n            }\r\n            www.mixin(this);\r\n            this.highlight = !!o.highlight;\r\n            this.name = o.name || nameGenerator();\r\n            this.limit = o.limit || 5;\r\n            this.displayFn = getDisplayFn(o.display || o.displayKey);\r\n            this.templates = getTemplates(o.templates, this.displayFn);\r\n            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;\r\n            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;\r\n            this._resetLastSuggestion();\r\n            this.$el = $(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset + \"-\" + this.name);\r\n        }\r\n        Dataset.extractData = function extractData(el) {\r\n            var $el = $(el);\r\n            if ($el.data(keys.obj)) {\r\n                return {\r\n                    val: $el.data(keys.val) || \"\",\r\n                    obj: $el.data(keys.obj) || null\r\n                };\r\n            }\r\n            return null;\r\n        };\r\n        _.mixin(Dataset.prototype, EventEmitter, {\r\n            _overwrite: function overwrite(query, suggestions) {\r\n                suggestions = suggestions || [];\r\n                if (suggestions.length) {\r\n                    this._renderSuggestions(query, suggestions);\r\n                } else if (this.async && this.templates.pending) {\r\n                    this._renderPending(query);\r\n                } else if (!this.async && this.templates.notFound) {\r\n                    this._renderNotFound(query);\r\n                } else {\r\n                    this._empty();\r\n                }\r\n                this.trigger(\"rendered\", this.name, suggestions, false);\r\n            },\r\n            _append: function append(query, suggestions) {\r\n                suggestions = suggestions || [];\r\n                if (suggestions.length && this.$lastSuggestion.length) {\r\n                    this._appendSuggestions(query, suggestions);\r\n                } else if (suggestions.length) {\r\n                    this._renderSuggestions(query, suggestions);\r\n                } else if (!this.$lastSuggestion.length && this.templates.notFound) {\r\n                    this._renderNotFound(query);\r\n                }\r\n                this.trigger(\"rendered\", this.name, suggestions, true);\r\n            },\r\n            _renderSuggestions: function renderSuggestions(query, suggestions) {\r\n                var $fragment;\r\n                $fragment = this._getSuggestionsFragment(query, suggestions);\r\n                this.$lastSuggestion = $fragment.children().last();\r\n                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));\r\n            },\r\n            _appendSuggestions: function appendSuggestions(query, suggestions) {\r\n                var $fragment, $lastSuggestion;\r\n                $fragment = this._getSuggestionsFragment(query, suggestions);\r\n                $lastSuggestion = $fragment.children().last();\r\n                this.$lastSuggestion.after($fragment);\r\n                this.$lastSuggestion = $lastSuggestion;\r\n            },\r\n            _renderPending: function renderPending(query) {\r\n                var template = this.templates.pending;\r\n                this._resetLastSuggestion();\r\n                template && this.$el.html(template({\r\n                    query: query,\r\n                    dataset: this.name\r\n                }));\r\n            },\r\n            _renderNotFound: function renderNotFound(query) {\r\n                var template = this.templates.notFound;\r\n                this._resetLastSuggestion();\r\n                template && this.$el.html(template({\r\n                    query: query,\r\n                    dataset: this.name\r\n                }));\r\n            },\r\n            _empty: function empty() {\r\n                this.$el.empty();\r\n                this._resetLastSuggestion();\r\n            },\r\n            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {\r\n                var that = this, fragment;\r\n                fragment = document.createDocumentFragment();\r\n                _.each(suggestions, function getSuggestionNode(suggestion) {\r\n                    var $el, context;\r\n                    context = that._injectQuery(query, suggestion);\r\n                    $el = $(that.templates.suggestion(context)).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + \" \" + that.classes.selectable);\r\n                    fragment.appendChild($el[0]);\r\n                });\r\n                this.highlight && highlight({\r\n                    className: this.classes.highlight,\r\n                    node: fragment,\r\n                    pattern: query\r\n                });\r\n                return $(fragment);\r\n            },\r\n            _getFooter: function getFooter(query, suggestions) {\r\n                return this.templates.footer ? this.templates.footer({\r\n                    query: query,\r\n                    suggestions: suggestions,\r\n                    dataset: this.name\r\n                }) : null;\r\n            },\r\n            _getHeader: function getHeader(query, suggestions) {\r\n                return this.templates.header ? this.templates.header({\r\n                    query: query,\r\n                    suggestions: suggestions,\r\n                    dataset: this.name\r\n                }) : null;\r\n            },\r\n            _resetLastSuggestion: function resetLastSuggestion() {\r\n                this.$lastSuggestion = $();\r\n            },\r\n            _injectQuery: function injectQuery(query, obj) {\r\n                return _.isObject(obj) ? _.mixin({\r\n                    _query: query\r\n                }, obj) : obj;\r\n            },\r\n            update: function update(query) {\r\n                var that = this, canceled = false, syncCalled = false, rendered = 0;\r\n                this.cancel();\r\n                this.cancel = function cancel() {\r\n                    canceled = true;\r\n                    that.cancel = $.noop;\r\n                    that.async && that.trigger(\"asyncCanceled\", query);\r\n                };\r\n                this.source(query, sync, async);\r\n                !syncCalled && sync([]);\r\n                function sync(suggestions) {\r\n                    if (syncCalled) {\r\n                        return;\r\n                    }\r\n                    syncCalled = true;\r\n                    suggestions = (suggestions || []).slice(0, that.limit);\r\n                    rendered = suggestions.length;\r\n                    that._overwrite(query, suggestions);\r\n                    if (rendered < that.limit && that.async) {\r\n                        that.trigger(\"asyncRequested\", query);\r\n                    }\r\n                }\r\n                function async(suggestions) {\r\n                    suggestions = suggestions || [];\r\n                    if (!canceled && rendered < that.limit) {\r\n                        that.cancel = $.noop;\r\n                        rendered += suggestions.length;\r\n                        that._append(query, suggestions.slice(0, that.limit - rendered));\r\n                        that.async && that.trigger(\"asyncReceived\", query);\r\n                    }\r\n                }\r\n            },\r\n            cancel: $.noop,\r\n            clear: function clear() {\r\n                this._empty();\r\n                this.cancel();\r\n                this.trigger(\"cleared\");\r\n            },\r\n            isEmpty: function isEmpty() {\r\n                return this.$el.is(\":empty\");\r\n            },\r\n            destroy: function destroy() {\r\n                this.$el = $(\"<div>\");\r\n            }\r\n        });\r\n        return Dataset;\r\n        function getDisplayFn(display) {\r\n            display = display || _.stringify;\r\n            return _.isFunction(display) ? display : displayFn;\r\n            function displayFn(obj) {\r\n                return obj[display];\r\n            }\r\n        }\r\n        function getTemplates(templates, displayFn) {\r\n            return {\r\n                notFound: templates.notFound && _.templatify(templates.notFound),\r\n                pending: templates.pending && _.templatify(templates.pending),\r\n                header: templates.header && _.templatify(templates.header),\r\n                footer: templates.footer && _.templatify(templates.footer),\r\n                suggestion: templates.suggestion || suggestionTemplate\r\n            };\r\n            function suggestionTemplate(context) {\r\n                return $(\"<div>\").text(displayFn(context));\r\n            }\r\n        }\r\n        function isValidName(str) {\r\n            return /^[_a-zA-Z0-9-]+$/.test(str);\r\n        }\r\n    }();\r\n    var Menu = function() {\r\n        \"use strict\";\r\n        function Menu(o, www) {\r\n            var that = this;\r\n            o = o || {};\r\n            if (!o.node) {\r\n                $.error(\"node is required\");\r\n            }\r\n            www.mixin(this);\r\n            this.$node = $(o.node);\r\n            this.query = null;\r\n            this.datasets = _.map(o.datasets, initializeDataset);\r\n            function initializeDataset(oDataset) {\r\n                var node = that.$node.find(oDataset.node).first();\r\n                oDataset.node = node.length ? node : $(\"<div>\").appendTo(that.$node);\r\n                return new Dataset(oDataset, www);\r\n            }\r\n        }\r\n        _.mixin(Menu.prototype, EventEmitter, {\r\n            _onSelectableClick: function onSelectableClick($e) {\r\n                this.trigger(\"selectableClicked\", $($e.currentTarget));\r\n            },\r\n            _onRendered: function onRendered(type, dataset, suggestions, async) {\r\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\r\n                this.trigger(\"datasetRendered\", dataset, suggestions, async);\r\n            },\r\n            _onCleared: function onCleared() {\r\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\r\n                this.trigger(\"datasetCleared\");\r\n            },\r\n            _propagate: function propagate() {\r\n                this.trigger.apply(this, arguments);\r\n            },\r\n            _allDatasetsEmpty: function allDatasetsEmpty() {\r\n                return _.every(this.datasets, isDatasetEmpty);\r\n                function isDatasetEmpty(dataset) {\r\n                    return dataset.isEmpty();\r\n                }\r\n            },\r\n            _getSelectables: function getSelectables() {\r\n                return this.$node.find(this.selectors.selectable);\r\n            },\r\n            _removeCursor: function _removeCursor() {\r\n                var $selectable = this.getActiveSelectable();\r\n                $selectable && $selectable.removeClass(this.classes.cursor);\r\n            },\r\n            _ensureVisible: function ensureVisible($el) {\r\n                var elTop, elBottom, nodeScrollTop, nodeHeight;\r\n                elTop = $el.position().top;\r\n                elBottom = elTop + $el.outerHeight(true);\r\n                nodeScrollTop = this.$node.scrollTop();\r\n                nodeHeight = this.$node.height() + parseInt(this.$node.css(\"paddingTop\"), 10) + parseInt(this.$node.css(\"paddingBottom\"), 10);\r\n                if (elTop < 0) {\r\n                    this.$node.scrollTop(nodeScrollTop + elTop);\r\n                } else if (nodeHeight < elBottom) {\r\n                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));\r\n                }\r\n            },\r\n            bind: function() {\r\n                var that = this, onSelectableClick;\r\n                onSelectableClick = _.bind(this._onSelectableClick, this);\r\n                this.$node.on(\"click.tt\", this.selectors.selectable, onSelectableClick);\r\n                _.each(this.datasets, function(dataset) {\r\n                    dataset.onSync(\"asyncRequested\", that._propagate, that).onSync(\"asyncCanceled\", that._propagate, that).onSync(\"asyncReceived\", that._propagate, that).onSync(\"rendered\", that._onRendered, that).onSync(\"cleared\", that._onCleared, that);\r\n                });\r\n                return this;\r\n            },\r\n            isOpen: function isOpen() {\r\n                return this.$node.hasClass(this.classes.open);\r\n            },\r\n            open: function open() {\r\n                this.$node.addClass(this.classes.open);\r\n            },\r\n            close: function close() {\r\n                this.$node.removeClass(this.classes.open);\r\n                this._removeCursor();\r\n            },\r\n            setLanguageDirection: function setLanguageDirection(dir) {\r\n                this.$node.attr(\"dir\", dir);\r\n            },\r\n            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {\r\n                var $selectables, $oldCursor, oldIndex, newIndex;\r\n                $oldCursor = this.getActiveSelectable();\r\n                $selectables = this._getSelectables();\r\n                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;\r\n                newIndex = oldIndex + delta;\r\n                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;\r\n                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;\r\n                return newIndex === -1 ? null : $selectables.eq(newIndex);\r\n            },\r\n            setCursor: function setCursor($selectable) {\r\n                this._removeCursor();\r\n                if ($selectable = $selectable && $selectable.first()) {\r\n                    $selectable.addClass(this.classes.cursor);\r\n                    this._ensureVisible($selectable);\r\n                }\r\n            },\r\n            getSelectableData: function getSelectableData($el) {\r\n                return $el && $el.length ? Dataset.extractData($el) : null;\r\n            },\r\n            getActiveSelectable: function getActiveSelectable() {\r\n                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();\r\n                return $selectable.length ? $selectable : null;\r\n            },\r\n            getTopSelectable: function getTopSelectable() {\r\n                var $selectable = this._getSelectables().first();\r\n                return $selectable.length ? $selectable : null;\r\n            },\r\n            update: function update(query) {\r\n                var isValidUpdate = query !== this.query;\r\n                if (isValidUpdate) {\r\n                    this.query = query;\r\n                    _.each(this.datasets, updateDataset);\r\n                }\r\n                return isValidUpdate;\r\n                function updateDataset(dataset) {\r\n                    dataset.update(query);\r\n                }\r\n            },\r\n            empty: function empty() {\r\n                _.each(this.datasets, clearDataset);\r\n                this.query = null;\r\n                this.$node.addClass(this.classes.empty);\r\n                function clearDataset(dataset) {\r\n                    dataset.clear();\r\n                }\r\n            },\r\n            destroy: function destroy() {\r\n                this.$node.off(\".tt\");\r\n                this.$node = $(\"<div>\");\r\n                _.each(this.datasets, destroyDataset);\r\n                function destroyDataset(dataset) {\r\n                    dataset.destroy();\r\n                }\r\n            }\r\n        });\r\n        return Menu;\r\n    }();\r\n    var DefaultMenu = function() {\r\n        \"use strict\";\r\n        var s = Menu.prototype;\r\n        function DefaultMenu() {\r\n            Menu.apply(this, [].slice.call(arguments, 0));\r\n        }\r\n        _.mixin(DefaultMenu.prototype, Menu.prototype, {\r\n            open: function open() {\r\n                !this._allDatasetsEmpty() && this._show();\r\n                return s.open.apply(this, [].slice.call(arguments, 0));\r\n            },\r\n            close: function close() {\r\n                this._hide();\r\n                return s.close.apply(this, [].slice.call(arguments, 0));\r\n            },\r\n            _onRendered: function onRendered() {\r\n                if (this._allDatasetsEmpty()) {\r\n                    this._hide();\r\n                } else {\r\n                    this.isOpen() && this._show();\r\n                }\r\n                return s._onRendered.apply(this, [].slice.call(arguments, 0));\r\n            },\r\n            _onCleared: function onCleared() {\r\n                if (this._allDatasetsEmpty()) {\r\n                    this._hide();\r\n                } else {\r\n                    this.isOpen() && this._show();\r\n                }\r\n                return s._onCleared.apply(this, [].slice.call(arguments, 0));\r\n            },\r\n            setLanguageDirection: function setLanguageDirection(dir) {\r\n                this.$node.css(dir === \"ltr\" ? this.css.ltr : this.css.rtl);\r\n                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));\r\n            },\r\n            _hide: function hide() {\r\n                this.$node.hide();\r\n            },\r\n            _show: function show() {\r\n                this.$node.css(\"display\", \"block\");\r\n            }\r\n        });\r\n        return DefaultMenu;\r\n    }();\r\n    var Typeahead = function() {\r\n        \"use strict\";\r\n        function Typeahead(o, www) {\r\n            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;\r\n            o = o || {};\r\n            if (!o.input) {\r\n                $.error(\"missing input\");\r\n            }\r\n            if (!o.menu) {\r\n                $.error(\"missing menu\");\r\n            }\r\n            if (!o.eventBus) {\r\n                $.error(\"missing event bus\");\r\n            }\r\n            www.mixin(this);\r\n            this.eventBus = o.eventBus;\r\n            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;\r\n            this.input = o.input;\r\n            this.menu = o.menu;\r\n            this.enabled = true;\r\n            this.active = false;\r\n            this.input.hasFocus() && this.activate();\r\n            this.dir = this.input.getLangDir();\r\n            this._hacks();\r\n            this.menu.bind().onSync(\"selectableClicked\", this._onSelectableClicked, this).onSync(\"asyncRequested\", this._onAsyncRequested, this).onSync(\"asyncCanceled\", this._onAsyncCanceled, this).onSync(\"asyncReceived\", this._onAsyncReceived, this).onSync(\"datasetRendered\", this._onDatasetRendered, this).onSync(\"datasetCleared\", this._onDatasetCleared, this);\r\n            onFocused = c(this, \"activate\", \"open\", \"_onFocused\");\r\n            onBlurred = c(this, \"deactivate\", \"_onBlurred\");\r\n            onEnterKeyed = c(this, \"isActive\", \"isOpen\", \"_onEnterKeyed\");\r\n            onTabKeyed = c(this, \"isActive\", \"isOpen\", \"_onTabKeyed\");\r\n            onEscKeyed = c(this, \"isActive\", \"_onEscKeyed\");\r\n            onUpKeyed = c(this, \"isActive\", \"open\", \"_onUpKeyed\");\r\n            onDownKeyed = c(this, \"isActive\", \"open\", \"_onDownKeyed\");\r\n            onLeftKeyed = c(this, \"isActive\", \"isOpen\", \"_onLeftKeyed\");\r\n            onRightKeyed = c(this, \"isActive\", \"isOpen\", \"_onRightKeyed\");\r\n            onQueryChanged = c(this, \"_openIfActive\", \"_onQueryChanged\");\r\n            onWhitespaceChanged = c(this, \"_openIfActive\", \"_onWhitespaceChanged\");\r\n            this.input.bind().onSync(\"focused\", onFocused, this).onSync(\"blurred\", onBlurred, this).onSync(\"enterKeyed\", onEnterKeyed, this).onSync(\"tabKeyed\", onTabKeyed, this).onSync(\"escKeyed\", onEscKeyed, this).onSync(\"upKeyed\", onUpKeyed, this).onSync(\"downKeyed\", onDownKeyed, this).onSync(\"leftKeyed\", onLeftKeyed, this).onSync(\"rightKeyed\", onRightKeyed, this).onSync(\"queryChanged\", onQueryChanged, this).onSync(\"whitespaceChanged\", onWhitespaceChanged, this).onSync(\"langDirChanged\", this._onLangDirChanged, this);\r\n        }\r\n        _.mixin(Typeahead.prototype, {\r\n            _hacks: function hacks() {\r\n                var $input, $menu;\r\n                $input = this.input.$input || $(\"<div>\");\r\n                $menu = this.menu.$node || $(\"<div>\");\r\n                $input.on(\"blur.tt\", function($e) {\r\n                    var active, isActive, hasActive;\r\n                    active = document.activeElement;\r\n                    isActive = $menu.is(active);\r\n                    hasActive = $menu.has(active).length > 0;\r\n                    if (_.isMsie() && (isActive || hasActive)) {\r\n                        $e.preventDefault();\r\n                        $e.stopImmediatePropagation();\r\n                        _.defer(function() {\r\n                            $input.focus();\r\n                        });\r\n                    }\r\n                });\r\n                $menu.on(\"mousedown.tt\", function($e) {\r\n                    $e.preventDefault();\r\n                });\r\n            },\r\n            _onSelectableClicked: function onSelectableClicked(type, $el) {\r\n                this.select($el);\r\n            },\r\n            _onDatasetCleared: function onDatasetCleared() {\r\n                this._updateHint();\r\n            },\r\n            _onDatasetRendered: function onDatasetRendered(type, dataset, suggestions, async) {\r\n                this._updateHint();\r\n                this.eventBus.trigger(\"render\", suggestions, async, dataset);\r\n            },\r\n            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {\r\n                this.eventBus.trigger(\"asyncrequest\", query, dataset);\r\n            },\r\n            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {\r\n                this.eventBus.trigger(\"asynccancel\", query, dataset);\r\n            },\r\n            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {\r\n                this.eventBus.trigger(\"asyncreceive\", query, dataset);\r\n            },\r\n            _onFocused: function onFocused() {\r\n                this._minLengthMet() && this.menu.update(this.input.getQuery());\r\n            },\r\n            _onBlurred: function onBlurred() {\r\n                if (this.input.hasQueryChangedSinceLastFocus()) {\r\n                    this.eventBus.trigger(\"change\", this.input.getQuery());\r\n                }\r\n            },\r\n            _onEnterKeyed: function onEnterKeyed(type, $e) {\r\n                var $selectable;\r\n                if ($selectable = this.menu.getActiveSelectable()) {\r\n                    this.select($selectable) && $e.preventDefault();\r\n                }\r\n            },\r\n            _onTabKeyed: function onTabKeyed(type, $e) {\r\n                var $selectable;\r\n                if ($selectable = this.menu.getActiveSelectable()) {\r\n                    this.select($selectable) && $e.preventDefault();\r\n                } else if ($selectable = this.menu.getTopSelectable()) {\r\n                    this.autocomplete($selectable) && $e.preventDefault();\r\n                }\r\n            },\r\n            _onEscKeyed: function onEscKeyed() {\r\n                this.close();\r\n            },\r\n            _onUpKeyed: function onUpKeyed() {\r\n                this.moveCursor(-1);\r\n            },\r\n            _onDownKeyed: function onDownKeyed() {\r\n                this.moveCursor(+1);\r\n            },\r\n            _onLeftKeyed: function onLeftKeyed() {\r\n                if (this.dir === \"rtl\" && this.input.isCursorAtEnd()) {\r\n                    this.autocomplete(this.menu.getTopSelectable());\r\n                }\r\n            },\r\n            _onRightKeyed: function onRightKeyed() {\r\n                if (this.dir === \"ltr\" && this.input.isCursorAtEnd()) {\r\n                    this.autocomplete(this.menu.getTopSelectable());\r\n                }\r\n            },\r\n            _onQueryChanged: function onQueryChanged(e, query) {\r\n                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();\r\n            },\r\n            _onWhitespaceChanged: function onWhitespaceChanged() {\r\n                this._updateHint();\r\n            },\r\n            _onLangDirChanged: function onLangDirChanged(e, dir) {\r\n                if (this.dir !== dir) {\r\n                    this.dir = dir;\r\n                    this.menu.setLanguageDirection(dir);\r\n                }\r\n            },\r\n            _openIfActive: function openIfActive() {\r\n                this.isActive() && this.open();\r\n            },\r\n            _minLengthMet: function minLengthMet(query) {\r\n                query = _.isString(query) ? query : this.input.getQuery() || \"\";\r\n                return query.length >= this.minLength;\r\n            },\r\n            _updateHint: function updateHint() {\r\n                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;\r\n                $selectable = this.menu.getTopSelectable();\r\n                data = this.menu.getSelectableData($selectable);\r\n                val = this.input.getInputValue();\r\n                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {\r\n                    query = Input.normalizeQuery(val);\r\n                    escapedQuery = _.escapeRegExChars(query);\r\n                    frontMatchRegEx = new RegExp(\"^(?:\" + escapedQuery + \")(.+$)\", \"i\");\r\n                    match = frontMatchRegEx.exec(data.val);\r\n                    match && this.input.setHint(val + match[1]);\r\n                } else {\r\n                    this.input.clearHint();\r\n                }\r\n            },\r\n            isEnabled: function isEnabled() {\r\n                return this.enabled;\r\n            },\r\n            enable: function enable() {\r\n                this.enabled = true;\r\n            },\r\n            disable: function disable() {\r\n                this.enabled = false;\r\n            },\r\n            isActive: function isActive() {\r\n                return this.active;\r\n            },\r\n            activate: function activate() {\r\n                if (this.isActive()) {\r\n                    return true;\r\n                } else if (!this.isEnabled() || this.eventBus.before(\"active\")) {\r\n                    return false;\r\n                } else {\r\n                    this.active = true;\r\n                    this.eventBus.trigger(\"active\");\r\n                    return true;\r\n                }\r\n            },\r\n            deactivate: function deactivate() {\r\n                if (!this.isActive()) {\r\n                    return true;\r\n                } else if (this.eventBus.before(\"idle\")) {\r\n                    return false;\r\n                } else {\r\n                    this.active = false;\r\n                    this.close();\r\n                    this.eventBus.trigger(\"idle\");\r\n                    return true;\r\n                }\r\n            },\r\n            isOpen: function isOpen() {\r\n                return this.menu.isOpen();\r\n            },\r\n            open: function open() {\r\n                if (!this.isOpen() && !this.eventBus.before(\"open\")) {\r\n                    this.menu.open();\r\n                    this._updateHint();\r\n                    this.eventBus.trigger(\"open\");\r\n                }\r\n                return this.isOpen();\r\n            },\r\n            close: function close() {\r\n                if (this.isOpen() && !this.eventBus.before(\"close\")) {\r\n                    this.menu.close();\r\n                    this.input.clearHint();\r\n                    this.input.resetInputValue();\r\n                    this.eventBus.trigger(\"close\");\r\n                }\r\n                return !this.isOpen();\r\n            },\r\n            setVal: function setVal(val) {\r\n                this.input.setQuery(_.toStr(val));\r\n            },\r\n            getVal: function getVal() {\r\n                return this.input.getQuery();\r\n            },\r\n            select: function select($selectable) {\r\n                var data = this.menu.getSelectableData($selectable);\r\n                if (data && !this.eventBus.before(\"select\", data.obj)) {\r\n                    this.input.setQuery(data.val, true);\r\n                    this.eventBus.trigger(\"select\", data.obj);\r\n                    this.close();\r\n                    return true;\r\n                }\r\n                return false;\r\n            },\r\n            autocomplete: function autocomplete($selectable) {\r\n                var query, data, isValid;\r\n                query = this.input.getQuery();\r\n                data = this.menu.getSelectableData($selectable);\r\n                isValid = data && query !== data.val;\r\n                if (isValid && !this.eventBus.before(\"autocomplete\", data.obj)) {\r\n                    this.input.setQuery(data.val);\r\n                    this.eventBus.trigger(\"autocomplete\", data.obj);\r\n                    return true;\r\n                }\r\n                return false;\r\n            },\r\n            moveCursor: function moveCursor(delta) {\r\n                var query, $candidate, data, payload, cancelMove;\r\n                query = this.input.getQuery();\r\n                $candidate = this.menu.selectableRelativeToCursor(delta);\r\n                data = this.menu.getSelectableData($candidate);\r\n                payload = data ? data.obj : null;\r\n                cancelMove = this._minLengthMet() && this.menu.update(query);\r\n                if (!cancelMove && !this.eventBus.before(\"cursorchange\", payload)) {\r\n                    this.menu.setCursor($candidate);\r\n                    if (data) {\r\n                        this.input.setInputValue(data.val);\r\n                    } else {\r\n                        this.input.resetInputValue();\r\n                        this._updateHint();\r\n                    }\r\n                    this.eventBus.trigger(\"cursorchange\", payload);\r\n                    return true;\r\n                }\r\n                return false;\r\n            },\r\n            destroy: function destroy() {\r\n                this.input.destroy();\r\n                this.menu.destroy();\r\n            }\r\n        });\r\n        return Typeahead;\r\n        function c(ctx) {\r\n            var methods = [].slice.call(arguments, 1);\r\n            return function() {\r\n                var args = [].slice.call(arguments);\r\n                _.each(methods, function(method) {\r\n                    return ctx[method].apply(ctx, args);\r\n                });\r\n            };\r\n        }\r\n    }();\r\n    (function() {\r\n        \"use strict\";\r\n        var old, keys, methods;\r\n        old = $.fn.typeahead;\r\n        keys = {\r\n            www: \"tt-www\",\r\n            attrs: \"tt-attrs\",\r\n            typeahead: \"tt-typeahead\"\r\n        };\r\n        methods = {\r\n            initialize: function initialize(o, datasets) {\r\n                var www;\r\n                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);\r\n                o = o || {};\r\n                www = WWW(o.classNames);\r\n                return this.each(attach);\r\n                function attach() {\r\n                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, typeahead, MenuConstructor;\r\n                    _.each(datasets, function(d) {\r\n                        d.highlight = !!o.highlight;\r\n                    });\r\n                    $input = $(this);\r\n                    $wrapper = $(www.html.wrapper);\r\n                    $hint = $elOrNull(o.hint);\r\n                    $menu = $elOrNull(o.menu);\r\n                    defaultHint = o.hint !== false && !$hint;\r\n                    defaultMenu = o.menu !== false && !$menu;\r\n                    defaultHint && ($hint = buildHintFromInput($input, www));\r\n                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));\r\n                    $hint && $hint.val(\"\");\r\n                    $input = prepInput($input, www);\r\n                    if (defaultHint || defaultMenu) {\r\n                        $wrapper.css(www.css.wrapper);\r\n                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);\r\n                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);\r\n                    }\r\n                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;\r\n                    eventBus = new EventBus({\r\n                        el: $input\r\n                    });\r\n                    input = new Input({\r\n                        hint: $hint,\r\n                        input: $input\r\n                    }, www);\r\n                    menu = new MenuConstructor({\r\n                        node: $menu,\r\n                        datasets: datasets\r\n                    }, www);\r\n                    typeahead = new Typeahead({\r\n                        input: input,\r\n                        menu: menu,\r\n                        eventBus: eventBus,\r\n                        minLength: o.minLength\r\n                    }, www);\r\n                    $input.data(keys.www, www);\r\n                    $input.data(keys.typeahead, typeahead);\r\n                }\r\n            },\r\n            isEnabled: function isEnabled() {\r\n                var enabled;\r\n                ttEach(this.first(), function(t) {\r\n                    enabled = t.isEnabled();\r\n                });\r\n                return enabled;\r\n            },\r\n            enable: function enable() {\r\n                ttEach(this, function(t) {\r\n                    t.enable();\r\n                });\r\n                return this;\r\n            },\r\n            disable: function disable() {\r\n                ttEach(this, function(t) {\r\n                    t.disable();\r\n                });\r\n                return this;\r\n            },\r\n            isActive: function isActive() {\r\n                var active;\r\n                ttEach(this.first(), function(t) {\r\n                    active = t.isActive();\r\n                });\r\n                return active;\r\n            },\r\n            activate: function activate() {\r\n                ttEach(this, function(t) {\r\n                    t.activate();\r\n                });\r\n                return this;\r\n            },\r\n            deactivate: function deactivate() {\r\n                ttEach(this, function(t) {\r\n                    t.deactivate();\r\n                });\r\n                return this;\r\n            },\r\n            isOpen: function isOpen() {\r\n                var open;\r\n                ttEach(this.first(), function(t) {\r\n                    open = t.isOpen();\r\n                });\r\n                return open;\r\n            },\r\n            open: function open() {\r\n                ttEach(this, function(t) {\r\n                    t.open();\r\n                });\r\n                return this;\r\n            },\r\n            close: function close() {\r\n                ttEach(this, function(t) {\r\n                    t.close();\r\n                });\r\n                return this;\r\n            },\r\n            select: function select(el) {\r\n                var success = false, $el = $(el);\r\n                ttEach(this.first(), function(t) {\r\n                    success = t.select($el);\r\n                });\r\n                return success;\r\n            },\r\n            autocomplete: function autocomplete(el) {\r\n                var success = false, $el = $(el);\r\n                ttEach(this.first(), function(t) {\r\n                    success = t.autocomplete($el);\r\n                });\r\n                return success;\r\n            },\r\n            moveCursor: function moveCursoe(delta) {\r\n                var success = false;\r\n                ttEach(this.first(), function(t) {\r\n                    success = t.moveCursor(delta);\r\n                });\r\n                return success;\r\n            },\r\n            val: function val(newVal) {\r\n                var query;\r\n                if (!arguments.length) {\r\n                    ttEach(this.first(), function(t) {\r\n                        query = t.getVal();\r\n                    });\r\n                    return query;\r\n                } else {\r\n                    ttEach(this, function(t) {\r\n                        t.setVal(newVal);\r\n                    });\r\n                    return this;\r\n                }\r\n            },\r\n            destroy: function destroy() {\r\n                ttEach(this, function(typeahead, $input) {\r\n                    revert($input);\r\n                    typeahead.destroy();\r\n                });\r\n                return this;\r\n            }\r\n        };\r\n        $.fn.typeahead = function(method) {\r\n            if (methods[method]) {\r\n                return methods[method].apply(this, [].slice.call(arguments, 1));\r\n            } else {\r\n                return methods.initialize.apply(this, arguments);\r\n            }\r\n        };\r\n        $.fn.typeahead.noConflict = function noConflict() {\r\n            $.fn.typeahead = old;\r\n            return this;\r\n        };\r\n        function ttEach($els, fn) {\r\n            $els.each(function() {\r\n                var $input = $(this), typeahead;\r\n                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);\r\n            });\r\n        }\r\n        function buildHintFromInput($input, www) {\r\n            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop(\"readonly\", true).removeAttr(\"id name placeholder required\").attr({\r\n                autocomplete: \"off\",\r\n                spellcheck: \"false\",\r\n                tabindex: -1\r\n            });\r\n        }\r\n        function prepInput($input, www) {\r\n            $input.data(keys.attrs, {\r\n                dir: $input.attr(\"dir\"),\r\n                autocomplete: $input.attr(\"autocomplete\"),\r\n                spellcheck: $input.attr(\"spellcheck\"),\r\n                style: $input.attr(\"style\")\r\n            });\r\n            $input.addClass(www.classes.input).attr({\r\n                autocomplete: \"off\",\r\n                spellcheck: false\r\n            });\r\n            try {\r\n                !$input.attr(\"dir\") && $input.attr(\"dir\", \"auto\");\r\n            } catch (e) {}\r\n            return $input;\r\n        }\r\n        function getBackgroundStyles($el) {\r\n            return {\r\n                backgroundAttachment: $el.css(\"background-attachment\"),\r\n                backgroundClip: $el.css(\"background-clip\"),\r\n                backgroundColor: $el.css(\"background-color\"),\r\n                backgroundImage: $el.css(\"background-image\"),\r\n                backgroundOrigin: $el.css(\"background-origin\"),\r\n                backgroundPosition: $el.css(\"background-position\"),\r\n                backgroundRepeat: $el.css(\"background-repeat\"),\r\n                backgroundSize: $el.css(\"background-size\")\r\n            };\r\n        }\r\n        function revert($input) {\r\n            var www, $wrapper;\r\n            www = $input.data(keys.www);\r\n            $wrapper = $input.parent().filter(www.selectors.wrapper);\r\n            _.each($input.data(keys.attrs), function(val, key) {\r\n                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);\r\n            });\r\n            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);\r\n            if ($wrapper.length) {\r\n                $input.detach().insertAfter($wrapper);\r\n                $wrapper.remove();\r\n            }\r\n        }\r\n        function $elOrNull(obj) {\r\n            var isValid, $el;\r\n            isValid = _.isJQuery(obj) || _.isElement(obj);\r\n            $el = isValid ? $(obj).first() : [];\r\n            return $el.length ? $el : null;\r\n        }\r\n    })();\r\n});"],"sourceRoot":"/source/"}