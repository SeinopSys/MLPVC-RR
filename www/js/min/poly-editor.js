"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var e=t(document);t.fn.polyEditor=function(o){if(!o.image)throw new Error("Missing image");var n,a,i,l=t(new Image).attr({src:o.image,class:"poly-image"}).attr("class","poly-image-element"),r=t(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr({class:"poly-svg-element",version:"1.1",xmlns:"http://www.w3.org/2000/svg"}),p=t.mk("div").attr("class","poly-svg-wrap").append(r),s=this.first().addClass("poly-wrap"),c=t.mk("span").attr("title","Mouse position").attr("class","poly-mousepos").text("?, ?"),f=t.mk("span").attr("title","Image top left").attr("class","poly-imgtl").text("?, ?"),u=t.mk("span").attr("title","Image center").attr("class","poly-imgc").text("?, ?"),d=t.mk("span").attr("title","Wrapper center").attr("class","poly-wrapc").text("?, ?"),m=t.mk("cpan").attr("class","poly-imgc-expected"),h=function(t,e){var o=v(),n=t.left,a=t.top,i=o.left,l=o.top;return{top:l+e*(a-l),left:i+e*(n-i)}},g=function(t){var e=w();return{top:t.top-e.top,left:t.left-e.left}},y=function(t,e){var o=w();return{top:t.top-o.top+e.height/2,left:t.left-o.left+e.width/2}},v=function(){return{top:a/2,left:n/2}},w=function(){var t=s.offset();return t.top-=(a-s.outerHeight())/2,t.left-=(n-s.outerWidth())/2,t},b=function(){T.text(t.roundTo(100*x,2)+"%"),document.activeElement.blur(),E[x<=.1?"disable":"enable"](),S[x>=2.5?"disable":"enable"]()},k=function(e,o,n){if(b(),"number"==typeof e){f.text(t.roundTo(e,2)+","+t.roundTo(o,2));var a=y(l.offset(),n);u.text(t.roundTo(a.top,2)+","+t.roundTo(a.left,2)),m.css({top:a.top-5,left:a.left-5});var i=v();d.text(t.roundTo(i.top,2)+","+t.roundTo(i.left,2))}},x=1,z=function(e){var o=l.data("size");if("object"===(void 0===o?"undefined":_typeof(o))){var n=t.rangeLimit(e,!1,.1,2.5),a=void 0,i=void 0;n!==x?(a=t.scaleResize(o.width,o.height,{scale:n}),i=x,x=a.scale):(a={width:l.width(),height:l.height()},i=x);var r=l.offset(),p=h(g(r),n/i);j.add(l).css({top:p.top,left:p.left,width:a.width,height:a.height}),k(p.top,p.left,a)}},T=t.mk("span").attr({class:"poly-zoom-perc",contenteditable:!0}).text("100%").on("keydown",function(e){if(t.isKey(Key.Enter,e)){e.preventDefault();var o=parseFloat(T.text(),10);isNaN(o)||z(o/100),k()}}).on("mousedown",function(){T.data("mousedown",!0)}).on("mouseup",function(){T.data("mousedown",!1)}).on("click",function(){!0!==T.data("focused")&&(T.data("focused",!0),T.select())}).on("dblclick",function(t){t.preventDefault(),T.select()}).on("blur",function(){T.data("mousedown")||T.data("focused",!1),0===T.html().trim().length&&b(),t.clearSelection()}),D=t.mk("button").attr("class","poly-zoom-fit typcn typcn typcn-arrow-minimise").on("click",function(e){var o=l.data("size");if("object"===(void 0===o?"undefined":_typeof(o))){e.preventDefault();var i=o.width>o.height,r=t.scaleResize(o.width,o.height,i?{height:a}:{width:n}),p=i?0:(a-r.height)/2,s=i?(n-r.width)/2:0;j.add(l).css({top:p,left:s,width:r.width,height:r.height}),x=r.scale,z(x)}}),S=t.mk("button").attr("class","poly-zoom-in typcn typcn-zoom-in").on("click",function(t){t.preventDefault(),z((Math.floor(10*x)+1)/10)}),E=t.mk("button").attr("class","poly-zoom-out typcn typcn-zoom-out").on("click",function(t){t.preventDefault(),z((Math.floor(10*x)-1)/10)}),H=t.mk("div").attr("class","poly-actions poly-actions-tl").append(S,E,D,T).on("mousedown",function(t){t.stopPropagation(),T.triggerHandler("blur")}),M=t.mk("div").attr("class","poly-actions poly-actions-bl").append(f,u,d,c).on("mousedown",function(t){t.stopPropagation(),T.triggerHandler("blur")}),j=t.mk("div").attr("class","poly-image-overlay").appendTo(s),I=t.mk("div").attr("class","poly-loader").html("Loading&hellip;"),N=t.throttle(250,function(){n=s.innerWidth(),a=s.innerHeight(),"number"==typeof x&&z(x);var t=v();d.text(t.top+","+t.left),r.attr("viewBox","0 0 "+n+" "+a)});return $w.on("resize",N),N(),s.append(H,M,I,m,p),l.on("load",function(){j.css("opacity",0),l.appendTo(s).data("size",{width:l.width(),height:l.height()}),I.detach(),D.triggerHandler("click"),j.fadeTo(500,1);var o=void 0,n=void 0;i=t.throttle(100,function(t){t.preventDefault();var e={top:t.pageY,left:t.pageX},a=w(),i=o.top+(e.top-n.top)-a.top,r=o.left+(e.left-n.left)-a.left;j.add(l).css({top:i,left:r});var p={width:l.width(),height:l.height()};k(i,r,p)}),e.on("mousedown",function(a){t(a.target).is(j)&&(a.preventDefault(),o=j.offset(),n={top:a.pageY,left:a.pageX},e.on("mousemove",i))}),e.on("mouseup mouseleave blur",function(){e.off("mousemove",i)})}),e.on("mousemove",t.throttle(50,function(t){var e=w();c.text(t.pageX-e.left+","+(t.pageY-e.top))})),{destroy:function(){"function"==typeof i&&e.off("mousemove",i),$w.off("resize",N),s.empty().removeClass("poly-wrap")}}}}(jQuery);
//# sourceMappingURL=/js/min/poly-editor.js.map
