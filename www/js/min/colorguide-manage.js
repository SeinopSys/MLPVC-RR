'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}DocReady.push(function(){'use strict';function a(a,b,d){var e=a.closest('.tags'),g=e.closest('[id^=p]'),h=g.attr('id').substring(1),j=n?$content.children('h1').text():e.siblings('strong').text().trim();$.Dialog.request('Create new tag',w.clone(!0,!0),'Create',function(a){a.children('.edit-only').replaceWith($.mk('label').append($.mk('input').attr({type:'checkbox',name:'addto'}).val(h).prop('checked','string'==typeof b),' Add this tag to the appearance "'+j+'" after creation')),'string'==typeof d&&'undefined'!=typeof i[d]&&a.find('input[name=type][value='+d+']').prop('checked',!0).trigger('change'),'string'==typeof b&&a.find('input[name=name]').val(b),a.on('submit',function(b){b.preventDefault();var d=a.mkData();$.Dialog.wait(!1,'Creating tag'),d.addto&&n&&(d.APPEARANCE_PAGE=!0),$.post(p+'/cg/tag/make'+m,d,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);if(this.tags&&(e.children('[data-hasqtip]').qtip('destroy',!0),e.html(this.tags),window.tooltips(),c()),!0===this.needupdate){var a=$(this.eps);f.replaceWith(a),f=a}$._tagAutocompleteCache={},$.Dialog.close()}))})})}function b(a,b,d){var f,g,h=$('#changes');'undefined'!=typeof b&&(b instanceof jQuery?(g=b.attr('id').substring(2),f=b.parents('[id^=p]').attr('id').substring(1)):f=b),$.Dialog.request(a,z.clone(!0,!0),'Save',function(a){var i=a.find('input[name=label]'),j=a.find('input[name=major]'),k=a.find('input[name=reason]'),l='object'===('undefined'==typeof d?'undefined':_typeof(d))&&d.label&&d.Colors;l&&(i.val(d.label),a.data('color_values',d.Colors).trigger('render-color-inputs')),a.on('submit',function(d){d.preventDefault();try{a.trigger('save-color-inputs',[!0,!0])}catch(b){if(!(b instanceof q))throw b;var o=a.find('.clrs').data('editor');return o.gotoLine(b.lineNumber),o.navigateLineEnd(),$.Dialog.fail(!1,b.message),void o.focus()}var e={label:i.val(),Colors:a.data('color_values')};return l||(e.ponyid=f),0===e.Colors.length?$.Dialog.fail(!1,'You need to add at least one valid color'):void(e.Colors=JSON.stringify(e.Colors),j.is(':checked')&&(e.major=!0,e.reason=k.val()),n&&(e.APPEARANCE_PAGE=!0),!h.length&&(e.FULL_CHANGES_SECTION=!0),$.Dialog.wait(!1,'Saving changes'),$.post(p+'/cg/colorgroup/'+(l?'set':'make')+(l?'/'+g:'')+m,e,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);if(this.cg||this.cgs){var a=$('#p'+f);if(this.cg?(b.children('[data-hasqtip]').qtip('destroy',!0),b.html(this.cg)):this.cgs&&a.find('ul.colors').html(this.cgs),!n&&this.notes){var d=a.find('.notes');try{d.find('.cm-direction').qtip('destroy',!0)}catch(a){}d.html(this.notes)}if(this.update){var e=a.find('.update');e.length?e.replaceWith(this.update):$(this.update).insertAfter(a.find('strong'))}this.changes&&(h.length?h.replaceWith(this.changes):$(this.changes).insertBefore($('#tags'))),window.tooltips(),c(),(this.update||this.changes)&&Time.Update();var g=$('#pony-cm');if(n&&g.length&&this.cm_img){$.Dialog.success(!1,'Color group updated'),$.Dialog.wait(!1,'Updating cutie mark orientation image');var i=new Image;i.src=this.cm_img,$(i).on('load error',function(){g.backgroundImageUrl(i.src),$.Dialog.close()})}else $.Dialog.close()}else $.Dialog.close()})))})})}function c(){H.children('span:not(.ctxmenu-bound)').ctxmenu([{text:'Edit tag',icon:'pencil',click:function click(){var a=$(this),b=a.text().trim(),c=a.attr('class').match(/id-(\d+)(?:\s|$)/)[1],d='Editing tag: '+b;$.Dialog.wait(d,'Retrieveing tag details from server'),$.post(p+'/cg/tag/get/'+c+m,$.mkAjaxHandler(function(){var b=this;this.status?$.Dialog.request(d,w.clone(!0,!0).data('tag',b),'Save',function(d){d.find('input[name=type][value='+b.type+']').prop('checked',!0),d.find('input[type=text][name], textarea[name]').each(function(){var a=$(this);a.val(b[a.attr('name')])}),d.on('submit',function(b){b.preventDefault();var e=d.mkData();n&&(e.APPEARANCE_PAGE=a.closest('div[id^=p]').attr('id').replace(/\D/g,'')),$.Dialog.wait(!1,'Saving changes'),$.post(p+'/cg/tag/set/'+c+m,e,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);var a=this,b=$('.id-'+a.tid);if(b.qtip('destroy',!0),a.title?b.attr('title',a.title):b.removeAttr('title'),b.text(a.name).data('ctxmenu-items').eq(0).text('Tag: '+a.name),b.each(function(){/typ-[a-z]+/.test(this.className)?this.className=this.className.replace(/typ-[a-z]+/,a.type?'typ-'+a.type:''):a.type&&(this.className+=' typ-'+a.type),$(this)[a.synonym_of?'addClass':'removeClass']('synonym').parent().reorderTags()}),window.tooltips(),n&&a.needupdate){var c=$(a.eps);f.replaceWith(c),f=c}$.Dialog.close()}))})}):$.Dialog.fail(d,this.message)}))}},{text:'Remove tag',icon:'minus',click:function click(){var a=$(this),b=a.attr('class').match(/id-(\d+)(?:\s|$)/);if(!b)return!1;b=b[1];var c=a.closest('[id^=p]').attr('id').replace(/\D/g,''),d=a.text().trim(),e='Remove tag: '+d;$.Dialog.confirm(e,'The tag <strong>'+d+'</strong> will be removed from this appearance.<br>Are you sure?',['Remove it','Nope'],function(d){if(d){var g={tag:b};$.Dialog.wait(e,'Removing tag'),n&&(g.APPEARANCE_PAGE=!0),$.post(p+'/cg/appearance/untag/'+c+m,g,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(e,this.message);if(!0===this.needupdate){var c=$(this.eps);f.replaceWith(c),f=c}a.qtip('destroy',!0),a.remove(),$('.tag.synonym').filter('[data-syn-of='+b+']').remove(),$.Dialog.close()}))}})}},{text:'Delete tag',icon:'trash',click:function click(){var a=$(this),b=a.text().trim(),c=a.attr('class').match(/id-(\d+)(?:\s|$)/)[1],d='Detele tag: '+b;$.Dialog.confirm(d,'Deleting this tag will also remove it from every appearance where it\u2019s been used.<br>Are you sure?',['Delete it','Nope'],function(b){if(b){var e={};n&&(e.APPEARANCE_PAGE=a.closest('[id^=p]').attr('id').substring(1)),function a(b){$.Dialog.wait(d,'Sending removal request'),$.post(p+'/cg/tag/del/'+c+m,b,$.mkAjaxHandler(function(){if(this.status){if(!0===this.needupdate){var e=$(this.eps);f.replaceWith(e),f=e}var g=$('.id-'+c);g.qtip('destroy',!0),g.remove(),$._tagAutocompleteCache={},$.Dialog.close()}else this.confirm?$.Dialog.confirm(!1,this.message,['NUKE TAG','Nevermind'],function(c){c&&(b.sanitycheck=!0,a(b))}):$.Dialog.fail(d,this.message)}))}(e)}})}},$.ctxmenu.separator,{text:'Create new tag',icon:'plus',click:function click(){$.ctxmenu.triggerItem($(this).parent(),1)}}],function(a){return'Tag: '+a.text().trim()});var d=[Key.Enter,Key.Comma];H.children('.addtag').each(function(){var b=$(this),g=b.closest('[id^=p]').attr('id').substring(1);b.autocomplete({minLength:3},[{name:'tags',display:'name',source:function source(a,b){if('undefined'==typeof $._tagAutocompleteCache)$._tagAutocompleteCache={};else if('undefined'!=typeof $._tagAutocompleteCache[a])return b($._tagAutocompleteCache[a]);$.get(p+'/cg/get-tags?s='+encodeURIComponent(a),$.mkAjaxHandler(function(){b($._tagAutocompleteCache[a]=this)}))},templates:{suggestion:Handlebars.compile('<span class="tag id-{{tid}} {{type}} {{#if synonym_of}}synonym{{else}}monospace{{/if}}">{{name}} <span class="uses">{{#if synonym_of}}<span class="typcn typcn-flow-children"></span>{{synonym_target}}{{else}}{{uses}}{{/if}}</span></span>')}}]),b.on('keydown',function(h){if(d.includes(h.keyCode)){h.preventDefault();var e=b.val().trim(),i=b.parents('.tags'),j=i.children('.tag'),k='Adding tag: '+e;if(0<j.filter(function(){return this.innerHTML.trim()===e}).length)return $.Dialog.fail(k,'This appearance already has this tag');$.Dialog.setFocusedElement(b.attr('disabled',!0)),b.parent().addClass('loading'),b.autocomplete('val',e);var l={tag_name:e};n&&(l.APPEARANCE_PAGE=!0),$.post(p+'/cg/appearance/tag/'+g+m,l,$.mkAjaxHandler(function(){if(b.removeAttr('disabled').parent().removeClass('loading'),this.status){if(!0===this.needupdate){var d=$(this.eps);f.replaceWith(d),f=d}i.children('[data-hasqtip]').qtip('destroy',!0),i.children('.tag').remove(),i.append($(this.tags).filter('span')),window.tooltips(),c(),$._tagAutocompleteCache={},b.autocomplete('val','').focus()}else{if('string'==typeof this.cancreate){var g=this.cancreate,h=this.typehint;return k=k.replace(e,g),$.Dialog.confirm(k,this.message,function(c){c&&a(b,g,h)})}$.Dialog.fail(k,this.message)}}))}}),b.nextAll('.aa-menu').on('click','.tag',function(){b.trigger({type:'keydown',keyCode:Key.Enter})})}),e=$('ul.colors').attr('data-color',h),e.filter(':not(.ctxmenu-bound)').ctxmenu([{text:'Re-order '+h+' groups',icon:'arrow-unsorted',click:function click(){var a=$(this),b=a.closest('[id^=p]'),d=b.attr('id').substring(1),e=n?$content.children('h1').text():b.children().last().children('strong').text().trim(),f='Re-order '+h+' groups on appearance: '+e;$.Dialog.wait(f,'Retrieving color group list from server'),$.post(p+'/cg/appearance/getcgs/'+d+m,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(this.message);var b=$.mk('form','cg-reorder'),e=$.mk('ol');$.each(this.cgs,function(a,b){e.append($.mk('li').attr('data-id',b.groupid).text(b.label))}),b.append($.mk('div').attr('class','cgs').append('<p class="align-center">Drag to re-arrange</p>',e)),new Sortable(e.get(0),{ghostClass:'moving',scroll:!1,animation:150}),$.Dialog.request(f,b,'Save',function(b){b.on('submit',function(f){f.preventDefault();var e={cgs:[]},g=b.children('.cgs');return g.length?void(g.find('ol').children().each(function(){e.cgs.push($(this).attr('data-id'))}),e.cgs=e.cgs.join(','),$.Dialog.wait(!1,'Saving changes'),n&&(e.APPEARANCE_PAGE=!0),$.post(p+'/cg/appearance/setcgs/'+d+m,e,$.mkAjaxHandler(function(){return this.status?void(a.html(this.cgs),window.tooltips(),c(),$.Dialog.close()):$.Dialog.fail(null,this.message)}))):$.Dialog.fail(!1,'There are no color groups to re-order')})})}))}},{text:'Create new group',icon:'folder-add',click:function click(){b('Create '+h+' group',$(this).closest('[id^=p]').attr('id').substring(1))}},{text:'Apply template (if empty)',icon:'document-add',click:function click(){var a=$(this).closest('[id^=p]').attr('id').substring(1);$.Dialog.confirm('Apply template on appearance','Add common color groups to this appearance?<br>Note: This will only work if there are no color groups currently present.',function(b){if(b){$.Dialog.wait(!1,'Applying template');var d={};n&&(d.APPEARANCE_PAGE=!0),$.post(p+'/cg/appearance/applytemplate/'+a+m,d,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);var b=$('#p'+a);b.find('ul.colors').html(this.cgs),window.tooltips(),c(),$.Dialog.close()}))}})}}],g+' groups'),e.children('li').filter(':not(.ctxmenu-bound)').ctxmenu([{text:'Edit '+h+' group',icon:'pencil',click:function click(){var a=$(this),c=a.closest('li'),d=c.attr('id').substring(2),e=a.children().first().text().replace(/:\s?$/,''),f='Editing '+h+' group: '+e;$.Dialog.wait(f,'Retrieving '+h+' group details from server'),$.post(p+'/cg/colorgroup/get/'+d+m,$.mkAjaxHandler(function(){return this.status?void b(f,c,this):$.Dialog.fail(f,this.message)}))}},{text:'Delete '+h+' group',icon:'trash',click:function click(){var a=$(this).closest('li'),b=a.attr('id').substring(2),c=a.children().first().text().replace(/:\s?$/,''),d='Delete '+h+' group: '+c;$.Dialog.confirm(d,'By deleting this '+h+' group, all '+h+'s within will be removed too.<br>Are you sure?',function(c){c&&($.Dialog.wait(d,'Sending removal request'),$.post(p+'/cg/colorgroup/del/'+b+m,$.mkAjaxHandler(function(){this.status?(a.children('[data-hasqtip]').qtip('destroy',!0),a.remove(),$.Dialog.close()):$.Dialog.fail(d,this.message)})))})}},$.ctxmenu.separator,{text:'Re-order '+h+' groups',icon:'arrow-unsorted',click:function click(){$.ctxmenu.triggerItem($(this).parent(),1)}},{text:'Create new group',icon:'folder-add',click:function click(){$.ctxmenu.triggerItem($(this).parent(),2)}}],function(a){return g+' group: '+a.children().first().text().trim().replace(':','')});var i=e.children('li').find('.valid-color');$.ctxmenu.addItems(i.filter('.ctxmenu-bound'),$.ctxmenu.separator,{text:'Edit '+h+' group',icon:'pencil',click:function click(){$.ctxmenu.triggerItem($(this).parent().closest('.ctxmenu-bound'),1)}},{text:'Delete '+h+' group',icon:'trash',click:function click(){$.ctxmenu.triggerItem($(this).parent().closest('.ctxmenu-bound'),2)}},$.ctxmenu.separator,{text:'Re-order '+h+' groups',icon:'arrow-unsorted',click:function click(){$.ctxmenu.triggerItem($(this).parent().closest('.ctxmenu-bound'),3)}},{text:'Create new group',icon:'folder-add',click:function click(){$.ctxmenu.triggerItem($(this).parent().closest('.ctxmenu-bound'),4)}}),$('.upload-wrap').filter(':not(.ctxmenu-bound)').each(function(){var a=$(this),b=a.closest('li');b.length||(b=$content.children('[id^=p]'));var c=b.attr('id').substring(1);(function(a,b){var c,d=a.find('img').attr('src'),e=function(){d=a.find('img').attr('src'),c=-1===d.indexOf('blank-pixel.png'),a[c?'removeClass':'addClass']('nosprite'),$.ctxmenu.setDefault(a,c?1:4)};a.uploadZone({requestKey:'sprite',title:'Upload sprite',accept:'image/png',target:p+'/cg/appearance/setsprite/'+b}).on('uz-uploadstart',function(){$.Dialog.close()}).on('uz-uploadfinish',function(){e()}).ctxmenu([{text:'Open image in new tab',icon:'arrow-forward',click:function click(){return-1===d.indexOf('blank-pixel.png')?void window.open(a.find('img').attr('src'),'_blank'):$.Dialog.fail('Open image in new tab','This appearance lacks a sprite image')}},{text:'Copy image URL',icon:'clipboard',click:function click(){return-1===d.indexOf('blank-pixel.png')?void $.copy($.toAbsoluteURL(a.find('img').attr('src'))):$.Dialog.fail('Copy image URL','This appearance lacks a sprite image')}},{text:'Check sprite colors',icon:'adjust-contrast',click:function click(){return-1===d.indexOf('blank-pixel.png')?void $.Navigation.visit(p+'/cg/sprite/'+b):$.Dialog.fail('Check sprite colors','This appearance lacks a sprite image')}},{text:'Upload new sprite',icon:'upload',click:function click(){var c='Upload sprite image',d=a.find('input[type="file"]');$.Dialog.request(c,r.clone(),'Download image',function(a){var f=a.find('input[name=image_url]');a.find('a').on('click',function(a){a.preventDefault(),a.stopPropagation(),d.trigger('click',[!0])}),a.on('submit',function(a){a.preventDefault();var e=f.val();$.Dialog.wait(c,'Downloading external image to the server'),$.post(p+'/cg/appearance/setsprite/'+b+m,{image_url:e},$.mkAjaxHandler(function(){this.status?d.trigger('set-image',[this.path]):$.Dialog.fail(c,this.message)}))})})}},{text:'Remove sprite image',icon:'times',click:function click(){return-1===d.indexOf('blank-pixel.png')?void $.Dialog.confirm('Remove sprite image','Are you sure you want to <strong>permanently delete</strong> the sprite image from the server?',['Wipe it','Nope'],function(c){c&&($.Dialog.wait(!1,'Removing image'),$.post(p+'/cg/appearance/delsprite/'+b,$.mkAjaxHandler(function(){return this.status?void(a.find('img').attr('src',this.sprite),e(),$.Dialog.close()):$.Dialog.fail(!1,this.message)})))}):$.Dialog.fail('Remove sprite image','This appearance lacks a sprite image')}}],'Sprite image').attr('title',k?' ':'').on('click',function(b,c){return!(!0!==c)||void(b.preventDefault(),$.ctxmenu.runDefault(a))}),e()})(a,c)})}function d(){$('button.edit:not(.bound)').addClass('bound').on('click',function(){var a=$(this),b=a.closest('[id^=p]'),c=b.attr('id').substring(1),d=n?$content.children('h1').text():a.parent().text().trim(),e='Editing appearance: '+d;$.Dialog.wait(e,'Retrieving appearance details from server'),$.post(p+'/cg/appearance/get/'+c+m,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);var b=this;b.ponyID=c,v(a,e,b)}))}).next('.delete').on('click',function(){var a=$(this),b=a.closest('[id^=p]'),c=b.attr('id').substring(1),d=n?$content.children('h1').text():a.parent().text().trim(),e='Deleting appearance: '+d;$.Dialog.confirm(e,'Deleting this appearance will remove <strong>ALL</strong> of its color groups, the colors within them, and the sprite file, if any.<br>Delete anyway?',function(a){a&&($.Dialog.wait(e,'Sending removal request'),$.post(p+'/cg/appearance/delete/'+c+m,$.mkAjaxHandler(function(){if(this.status){b.remove(),$.Dialog.success(e,this.message);var a=window.location.pathname;0===s.children().length&&(a=a.replace(/(\d+)$/,function(a){return 1<a?a-1:a})),n?($.Dialog.wait('Navigation','Loading page 1'),$.Navigation.visit(p+'/cg/1',function(){$.Dialog.close()})):$.toPage(a,!0,!0)}else $.Dialog.fail(e,this.message)})))})}),H=$('.tags').ctxmenu([{text:'Create new tag',icon:'plus',click:function click(){a($(this))}}],'Tags'),c()}var e,f,g=window.Color,h=window.color,i=window.TAG_TYPES_ASSOC,j=window.HEX_COLOR_PATTERN,k='WebkitAppearance'in document.documentElement.style,l=window.EQG,m=l?'?eqg':'',n=!!window.AppearancePage,o=window.PersonalGuide,p=o?'/@'+o:'',q=function(a,b,c){var d=[];c&&c[1]||d.push('HEX color'),c&&c[2]||d.push('color name'),this.message='Parse error on line '+b+' (shown below)\n\t\t\t\t<pre style="font-size:16px"><code>'+a.replace(/</g,'&lt;')+'</code></pre>\n\t\t\t\t'+(d.length?'The '+d.join(' and ')+' is missing from this line.':'Please check for any typos before continuing.'),this.lineNumber=b},r=$.mk('form','sprite-upload').html((o?'<div class="notice info"><label>About sprites</label><p>Sprites are small, pixelated images showcasing all of the colors a given character has. They are most useful if they contain a full body image of your character with any difficult details highlighted. You can use it together with the notes, adding explanations about anything that might be confusing.</p><p>Sprites have a height limit of 300px, a width limit between 300 and 700 pixels, and are expected to be PNG files with a transparent background.</p><p class="color-red">The staff reserves the right to remove any sprites that do not follow these guidelines.</p></div>':'')+('<p class="align-center"><a href="#upload">Click here to upload a file</a> (max. '+window.MAX_SIZE+') or enter a URL below.</p>\n\t\t<label><input type="text" name="image_url" placeholder="External image URL" required></label>\n\t\t<p class="align-center">The URL will be checked against the supported provider list, and if an image is found, it\'ll be downloaded to the server and set as this appearance\u2019s sprite image.</p>'));n&&(f=$('#ep-appearances')),$.fn.reorderTags=function(){return this.each(function(){$(this).children('.tag').sort(function(c,a){var b=/^.*typ-([a-z]+).*$/;return c=[c.className.replace(b,'$1'),c.innerHTML.trim()],a=[a.className.replace(b,'$1'),a.innerHTML.trim()],c[0]===a[0]?c[1].localeCompare(a[1]):c[0].localeCompare(a[0])}).appendTo(this)})};var s=$('.appearance-list'),t=$.mk('form','pony-editor').append('<label>\n\t\t\t\t\t<span>Name (4-70 chars.)</span>\n\t\t\t\t\t<input type="text" name="label" placeholder="Enter a name" pattern="'+PRINTABLE_ASCII_PATTERN.replace('+','{4,70}')+'" required maxlength="70">\n\t\t\t\t</label>\n\t\t\t\t<div class="label">\n\t\t\t\t\t<span>Additional notes (1000 chars. max, optional)</span>\n\t\t\t\t\t<div class="ace_editor"></div>\n\t\t\t\t</div>\n\t\t\t\t<label><input type=\'checkbox\' name=\'private\'> Make private (only '+(o?'you':'admins')+' can see added colors)</label>'),u=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};'undefined'==typeof b.facing&&(b.facing='right');var c=$.mk('div').attr('class','disabled-show').html('<p>Body orientation'+(0===a?'':': <strong class="orient">'+$.capitalize(b.facing)+'</strong><input type="hidden" name="facing[]" value="'+b.facing+'">')+'</p>'+(0===a?'<div class="radio-group">\n\t\t\t\t\t<label><input type="radio" name="facing[]" value="left" required><span>Left</span></label>\n\t\t\t\t\t<label><input type="radio" name="facing[]" value="right" required><span>Right</span></label>\n\t\t\t\t\t<label><input type="radio" name="facing[]" value="" required><span>Symmetrical</span></label>\n\t\t\t\t</div>':''));return c.find('input[value=\''+(b.facing?b.facing:'')+'\']').prop('checked',!0),$.mk('li').append($.mk('fieldset').append($.mk('legend').append('<span>Cutie Mark #'+(a+1)+'</span>',0<a?'<button class="section-toggle btn blue typcn"></button>':''),b.cmid?$.mk('input').attr({type:'hidden',value:b.cmid,name:'cmid[]'}):void 0,c,$.mk('label').append('<span>Deviation link</span>',$.mk('input').attr({type:'url',name:'favme[]',required:!0}).val(b.favme?'http://fav.me/'+b.favme:void 0)),$.mk('div').attr('class','label disabled-show').append('<span>Preview rotation (<span class=\'rotation-display\'></span>\xB0)</span>',$.mk('input').attr({type:'range',name:'favme_rotation[]',min:-180,max:180,step:2,'class':'rotation-range',required:!0}).val(b.favme_rotation)),$.mk('label').append('<span>Custom preview (optional)</span>',$.mk('input').attr({type:'url',name:'preview_src[]'}).val(b.preview_src))))},v=function(a,b,c){var d,f=!!c,e=a.parents('[id^=p]'),g=e.find('.notes');if(n){if(!f)return;d=$content.children('h1')}else d=a.siblings().first();$.Dialog.request(b,t.clone(!0,!0),'Save',function(a){var h,i;$.getAceEditor(!1,'html',function(b){try{var d=a.find('.ace_editor').get(0),e=ace.edit(d);i=$.aceInit(e,b),i.setMode(b),i.setUseWrapMode(!0),f&&c.notes&&i.setValue(c.notes)}catch(a){console.error(a)}}),f?(h=c.ponyID,a.find('input[name=label]').val(c.label),c.cm_preview&&a.find('input[name=cm_preview]').val(c.cm_preview),c.cm_dir&&a.find('input[name=cm_dir]').enable().filter('[value='+c.cm_dir+']').prop('checked',!0),c.private&&a.find('input[name=private]').prop('checked',!0),a.append($.mk('div').attr('class','align-center').append($.mk('button').attr('class','orange typcn typcn-media-eject').text('Selective wipe').on('click',function(a){a.preventDefault();var b=c.label,d=$.mk('form','selective-wipe').html('<p>Select which of the following items to clear below.</p>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type="checkbox" name="wipe_cache"> Clear cached images</label>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type="checkbox" name="wipe_sprite"> Clear sprite image</label>\n\t\t\t\t\t\t\t\t\t\t\t<fieldset>\n\t\t\t\t\t\t\t\t\t\t\t\t<legend>Color Groups</legend>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="radio-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label><input type="radio" name="wipe_colors" value="" checked><span>Nothing</span></label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label><input type="radio" name="wipe_colors" value="color_hex"><span>HEX values</span></label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label><input type="radio" name="wipe_colors" value="color_all"><span>Colors</span></label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label><input type="radio" name="wipe_colors" value="all"><span>Color groups</span></label>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</fieldset>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type="checkbox" name="wipe_notes"> Clear notes</label>'+(o?'':'<label><input type="checkbox" name="wipe_tags"> Remove all tags</label>')+'<label><input type="checkbox" name="mkpriv"> Make private</label>');$.Dialog.close(),$.Dialog.request('Selectively wipe data from '+b,d,'Clear data',function(){d.on('submit',function(a){a.preventDefault();var b=d.mkData();return b.wipe_colors||delete b.wipe_colors,0===Object.keys(b).length?$.Dialog.fail(!1,'You didn\'t select any data to clear'):void($.Dialog.clearNotice(/select any data/),$.Dialog.confirm(!1,'The action you are about to perform is irreversible. Are you sure you want to proceed?',['Wipe selected data','Changed my mind'],function(a){a&&($.Dialog.wait(!1),$.post('/cg/appearance/selectiveclear/'+h,b,$.mkAjaxHandler(function(){return this.status?void($.Dialog.wait(!1,'Reloading page',!0),$.Navigation.reload(function(){$.Dialog.close()})):$.Dialog.fail(!1,this.message)})))}))})})}),o?void 0:$.mk('button').attr('class','darkblue typcn typcn-pencil').text('Relations').on('click',function(a){a.preventDefault(),$.Dialog.close(),$.Dialog.wait('Appearance relation editor','Retrieving relations from server');var b=$content.find('section.related');$.post(p+'/cg/appearance/getrelations/'+h+m,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);var a=this,c=$.mk('form').attr('id','guide-relation-editor'),d=$.mk('select').attr({name:'listed',multiple:!0}),f=$.mk('select').attr('multiple',!0);a.linked&&a.linked.length&&$.each(a.linked,function(a,b){var c=$.mk('option').attr('value',b.id).text(b.label);b.mutual&&c.attr('data-mutual',!0).text('(M) '+c.text()),d.append(c)}),a.unlinked&&a.unlinked.length&&$.each(a.unlinked,function(a,b){f.append($.mk('option').attr('value',b.id).text(b.label))});var g=$.mk('div').attr('class','mutual-fieldset-wrap').html('<fieldset>\n\t\t\t\t\t\t\t\t\t\t\t\t<legend data-placeholder="Relation type"></legend>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="radio-group">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label><input type="radio" class="mutual-checkbox" name="mutual" value="1" required disabled><span>Mutual</span></label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label><input type="radio" class="mutual-checkbox" name="mutual" value="0" required disabled><span>One way</span></label>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="notice"></div>\n\t\t\t\t\t\t\t\t\t\t\t</fieldset>'),e=g.find('.notice'),i=g.find('legend'),j=/^\(M\) /;g.find('input').on('change click',function(){var a=$(this);if(!a.hasAttr('disabled')){var b=d.children(':selected'),c=a.is(':checked')&&'1'===a.attr('value'),e=b.hasAttr('data-mutual');c?!e&&b.attr('data-mutual',!0).text('(M) '+b.text()):e&&b.removeAttr('data-mutual').text(b.text().replace(j,''))}}),d.on('change',function(){var a=d.children(':selected');1===a.length?(g.find('input').enable(),e.hide(),i.text('Relation to '+a.text().replace(j,'')),g.find('input[value="'+(a.hasAttr('data-mutual')?'1':'0')+'"]').prop('checked',!0)):(g.find('input').disable(),i.empty(),1<a.length?e.attr('class','notice fail').text('Multiple appearances are selected').show():e.attr('class','notice info').text('Select a relation on the left to change the type').show())}).triggerHandler('change'),c.append($.mk('div').attr('class','split-select-wrap').append($.mk('div').attr('class','split-select').append('<span>Linked</span>',d),$.mk('div').attr('class','buttons').append($.mk('button').attr({'class':'typcn typcn-chevron-left green',title:'Link selected'}).on('click',function(a){a.preventDefault(),d.append(f.children(':selected').prop('selected',!1)).children().sort(function(c,a){return c.innerHTML.localeCompare(a.innerHTML)}).appendTo(d)}),$.mk('button').attr({'class':'typcn typcn-chevron-right red',title:'Unlink selected'}).on('click',function(a){a.preventDefault(),f.append(d.children(':selected').prop('selected',!1)).children().sort(function(c,a){return c.innerHTML.localeCompare(a.innerHTML)}).appendTo(f),0===d.children().length&&(g.find('input').disable(),i.empty(),g.find('.notice').show())})),$.mk('div').attr('class','split-select').append('<span>Available</span>',f)),g),$.Dialog.request(!1,c,'Save',function(a){a.on('submit',function(a){a.preventDefault();var c=[],e=[];d.children().each(function(a,b){var d=$(b),f=d.attr('value');c.push(f),d.hasAttr('data-mutual')&&e.push(f)}),$.Dialog.wait(!1,'Saving changes');var f={ids:c.join(','),mutuals:e.join(',')};n&&(f.APPEARANCE_PAGE=!0),$.post(p+'/cg/appearance/setrelations/'+h+m,f,$.mkAjaxHandler(function(){return this.status?void(this.section?(!b.length&&(b=$.mk('section').addClass('related').appendTo($content)),b.html($(this.section).filter('section').html())):b.length&&(b.remove(),b={length:0}),$.Dialog.close()):$.Dialog.fail(!1,this.message)}))})})}))}),$.mk('button').attr('class','darkblue typcn typcn-pencil').text('Cutie Mark').on('click',function(a){a.preventDefault();var b=c.label;$.Dialog.close(),$.Dialog.wait('Manage Cutie Mark of '+b,'Retrieving CM data from server');var d=$content.find('section.approved-cutie-mark');$.post(p+'/cg/appearance/getcms/'+h+m,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);var a,c,e,f=this,g=$.mk('ul').attr('class','dialog-preview'),j=$.mk('ul').attr('class','cm-list'),i=!1,k='Update preview',l=function(a){var b=$.Event('change');b.target=a,e.trigger(b)},o=function(a,b){'undefined'==typeof b&&(b=j.children().eq(1)),c[a?'hide':'show'](),a?b.addClass('readonly').find('input:not(:disabled)').disable().addClass('force-disabled'):b.removeClass('readonly').find('.force-disabled').enable();var d=b.children('fieldset'),e=d.hasClass('ignore'),f=!!(d.find('input[name="favme[]"]').val()||d.find('input[name="preview_src[]"]').val());(!a||!e)&&(a||e||f)||c.triggerHandler('click')},q=function(){j.find('.rotation-range').each(function(){l(this)})},r=function(){a=g.find('.img'),q()},s=$.mk('button').attr('class','darkblue typcn typcn-arrow-sync').text(k).on('click',function(a){a.preventDefault(),!1!=i&&(i.abort(),i=!1);var b=$(this),c=b.closest('form').mkData();b.disable().html('Updating preview&hellip;'),g.addClass('loading'),i=$.post(p+'/cg/appearance/getcmpreview/'+h+m,c,$.mkAjaxHandler(function(){return b.text(k).enable(),g.removeClass('loading'),i=!1,this.status?void($.Dialog.clearNotice(/preview/),g.html(this.html),r()):$.Dialog.fail(!1,this.message)}))}),t=$.mk('button').attr('class','red typcn typcn-trash').text('Delete Cutie Marks').on('click',function(a){a.preventDefault(),!1!==i&&(i.abort(),i=!1),$.Dialog.close(function(){$.Dialog.confirm('Delete Cutie Marks of '+b,'Are you sure you want to remove the cutie mark(s) associated with this appearance?',function(a){a&&($.Dialog.wait(!1,'Sending removal request'),$.post(p+'/cg/appearance/delcms/'+h+m,$.mkAjaxHandler(function(){return this.status?void(d.length&&d.addClass('hidden').children(':not(h2,p)').remove(),$.Dialog.close()):$.Dialog.fail(!1,this.message)})))})})});e=$.mk('form').attr('id','cm-data-editor').append(g,j,s).on('change mousemove keydown','.rotation-range',function(b){var c=$(b.target),d=c.val();if(c.prev().children('.rotation-display').text(d),'undefined'!=typeof a){var e=c.closest('li'),f=e.index();if(a.eq(f).css('transform','rotateZ('+d+'deg)'),0===f&&''===e.find('input[name="facing[]"]:checked').val()&&a.eq(1).length){var g=e.next().find('.rotation-range');g.val(-d),l(g.get(0)),a.eq(1).css('transform','rotateZ('+-d+'deg)')}}}).on('change click keydown','input[name="facing[]"]',function(a){var b=$(this),d=b.parents('.radio-group'),e=d.find('input:checked').val(),f=j.children().eq(1),g={'':'right',left:'right',right:'left'}[e];if(f.find('.orient').text($.capitalize(g)).next().val(g),'change'===a.type){if(''!==e){var h=b.parents('form').find('.rotation-range');h.each(function(a){var b=$(this),c=e===(0===a?'right':'left'),d=b.val();(0>d&&c||0<d&&!c)&&(b.val(-1*d),l(this))}),s.triggerHandler('click'),c.show()}else c.hide();o(''===e,f)}}),f.cms.length?($.each(f.cms,function(a,b){j.append(u(a,b))}),1===f.cms.length&&j.append(u(1)),g.html(f.preview),r(),q(),e.append(t)):j.append(u(0),u(1)),c=e.find('.section-toggle').on('click',function(a){a.preventDefault();var b=$(this),c=b.closest('fieldset');c.hasClass('ignore')?(c.removeClass('ignore'),c.find('.force-disabled').enable().parent().removeClass('hidden')):(c.addClass('ignore'),c.find('input:not(:disabled)').disable().addClass('force-disabled').parent().addClass('hidden')),b.toggleClass('typcn-plus typcn-minus').toggleHtml(['Add','Remove'])}),1===f.cms.length?c.addClass('typcn-minus').text('Remove'):c.addClass('typcn-plus').text('Add'),f.cms.facing?c.triggerHandler('click'):(c.hide(),o(!0)),$.Dialog.request(!1,e,'Save',function(a){a.on('submit',function(b){b.preventDefault(),!1!==i&&(i.abort(),i=!1);var c=a.mkData();n&&(c.APPEARANCE_PAGE=!0),$.Dialog.wait(!1,'Saving cutie mark data'),$.post(p+'/cg/appearance/setcms/'+h+m,c,$.mkAjaxHandler(function(){return this.status?void($.Dialog.close(),d.length&&(d.children(':not(h2,p)').remove(),d.removeClass('hidden').append(this.html))):$.Dialog.fail(!1,this.message)}))})}),window.updateRanges=q}))})))):a.append('<label><input type=\'checkbox\' name=\'template\'> Pre-fill with common color groups</label>'),a.on('submit',function(c){c.preventDefault();var e=a.mkData();e.notes=i.getValue(),$.Dialog.wait(!1,'Saving changes'),n&&(e.APPEARANCE_PAGE=!0),o&&(e.PERSONAL_GUIDE=!0),$.post(p+'/cg/appearance/'+(f?'set/'+h:'make')+m,e,$.mkAjaxHandler(function(){return this.status?void(e=this,f?n?($.Dialog.wait(!1,'Reloading page',!0),$.Navigation.reload(function(){$.Dialog.close()})):(d.text(e.label),e.newurl&&d.attr('href',function(a,b){return b.replace(/\/[^\/]+$/,'/'+e.newurl)}),g.html(this.notes),window.tooltips(),$.Dialog.close()):($.Dialog.success(b,'Appearance added'),$.Dialog.wait(b,'Loading appearance page'),$.Navigation.visit(e.goto,function(){e.info?$.Dialog.info(b,e.info):$.Dialog.close()}))):$.Dialog.fail(!1,this.message)}))})})};$('#new-appearance-btn').on('click',function(){var a=$(this),b=a.text().trim();return o?void($.Dialog.wait(b,'Checking whether you have any more slots'),$.post(p+'/cg/slot-check',$.mkAjaxHandler(function(){return this.status?void v(a,b):$.Dialog.fail(!1,this.message)}))):v(a,b)});var w=$.mk('form','edit-tag');w.append('<label><span>Tag name (3-30 chars.)</span><input type="text" name="name" required pattern="^[^-][ -~]{2,29}$" maxlength="30"></label>');var x='<div class=\'type-selector\'>\n\t\t\t<label>\n\t\t\t\t<input type="radio" name="type" value="" checked>\n\t\t\t\t<span class="tag">Typeless</span>\n\t\t\t</label>';$.each(i,function(a,b){x+='<label>\n\t\t\t\t<input type="radio" name="type" value="'+a+'">\n\t\t\t\t<span class="tag typ-'+a+'">'+b+'</span>\n\t\t\t</label>'}),x+='</div>',w.append('<div class="align-center">\n\t\t\t<span>Tag type</span><br>\n\t\t\t'+x+'\n\t\t</div>\n\t\t<label>\n\t\t\t<span>Tag description (max 255 chars., optional)</span>\n\t\t\t<textarea name="title" maxlength="255"></textarea>\n\t\t</label>',$.mk('div').attr('class','align-center edit-only').append($.mk('button').attr('class','blue typcn typcn-flow-merge merge').html('Merge&hellip;'),$.mk('button').attr('class','blue typcn typcn-flow-children synon').html('Synonymize&hellip;')).on('click','button',function(a){a.preventDefault();var b=$(this).closest('form'),d=b.data('tag'),e=d.name,f=d.tid,g=this.className.split(' ').pop();$.Dialog.close(function(){window.CGTagEditing(e,f,g,function(a){var b,d=$('.tag.id-'+f);if(d.length)switch(a){case'synon':b=this.target,d.addClass('synonym');var e=d.eq(0).clone().removeClass('ctxmenu-bound'),g=new y(b),h=d.add($('.tag.id-'+b.tid)).closest('.tags');h.filter(function(){return 0===$(this).children('.id-'+f).length}).append(e).reorderTags(),h.filter(function(){return 0===$(this).children('.id-'+b.tid).length}).append(g).reorderTags(),window.tooltips(),c();break;case'unsynon':this.keep_tagged?d.removeClass('synonym'):d.remove();break;case'merge':b=this.target,d.each(function(){var a=$(this);0===a.siblings('.id-'+b.tid).length?a.replaceWith(new y(b)):a.remove()}),window.tooltips(),c();}$.Dialog.close()})})}));var y=function(a){function b(a){var c,d;return _classCallCheck(this,b),d=(c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,'<span class="tag id-'+a.tid+(a.type?' typ-'+a.type:'')+(a.synonym_of?' synonym':'')+'" data-syn-of="'+a.synonym_of+'">')),c).attr('title',a.title).text(a.name),_possibleConstructorReturn(c,d)}return _inherits(b,a),b}(jQuery),z=$.mk('form','cg-editor'),A=$.mk('input').attr({'class':'clri',autocomplete:'off',spellcheck:'false'}).patternAttr(j).on('keyup change input',function(a,b){var c=$(this),d=c.prev(),e=('string'==typeof b?b:this.value).trim(),f=j.test(e);f?d.removeClass('invalid').css('background-color',e.replace(j,'#$1')):d.addClass('invalid'),c.next().attr('required',f)}).on('paste blur keyup',function(a){var b=this,c=function(){var c=$.hexpand(b.value);if(j.test(c)){c=c.replace(j,'#$1').toUpperCase();var d=$(b),e=$.hex2rgb(c);switch($.each(e,function(a,b){3>=b?e[a]=0:252<=b&&(e[a]=255)}),c=$.rgb2hex(e),a.type){case'paste':d.next().focus();case'blur':d.val(c);}d.trigger('change',[c]).patternAttr(SHORT_HEX_COLOR_PATTERN.test(b.value)?SHORT_HEX_COLOR_PATTERN:j)}};'paste'===a.type?setTimeout(c,10):c()}),B=$.mk('input').attr({'class':'clrl',pattern:PRINTABLE_ASCII_PATTERN.replace('+','{3,30}')}),C=$.mk('div').attr('class','clra').append($.mk('span').attr('class','typcn typcn-minus remove red').on('click',function(){$(this).closest('.clr').remove()})).append($.mk('span').attr('class','typcn typcn-arrow-move move blue')),D=function(a){var b=A.clone(!0,!0),c=B.clone(),d=C.clone(!0,!0),e=$.mk('div').attr('class','clr');return'object'===('undefined'==typeof a?'undefined':_typeof(a))&&(a.hex&&b.val(a.hex.toUpperCase()),a.label&&c.val(a.label)),e.append('<span class=\'clrp\'></span>',b,c,d),b.trigger('change'),e},E=$.mk('button').attr('class','typcn typcn-plus green add-color').text('Add new color').on('click',function(a){a.preventDefault();var b=$(this).parents('#cg-editor'),c=b.children('.clrs');if(c.length||b.append(c=$.mk('div').attr('class','clrs')),c.hasClass('ace_editor')){var d=c.data('editor');d.clearSelection(),d.navigateLineEnd();var e=d.getCursorPosition(),f=e.row+1,g=0===e.column,h=window.copyHashEnabled();g||f++,d.insert((g?'':'\n')+(h?'#':'')+'\tColor Name'),d.gotoLine(f,+h),d.focus()}else{var i=D();c.append(i),i.find('.clri').focus()}}),F=function(a,b){for(var d,e=[],f=a.split('\n'),g=0,h=f.length;g<h;g++)if(d=f[g],!/^(\/\/.*)?$/.test(d)){var c=d.trim().match(/^#?([a-f\d]{6}|[a-f\d]{3})?(?:\s*([a-z\d][ -~]{2,29}))?$/i);if(c&&c[2]&&(!b||c[1])){e.push({hex:c[1]?$.hexpand(c[1]):void 0,label:c[2]});continue}if('#'===d.trim()){e.push({hex:void 0,label:''});continue}throw new q(d,g+1,c)}return colors},G=$.mk('button').attr('class','typcn typcn-document-text darkblue').text('Plain text editor').on('click',function(a){a.preventDefault();var b=$(this),c=b.parents('#cg-editor');b.disable();try{c.trigger('save-color-inputs')}catch(a){if(!(a instanceof q))throw a;var d=c.find('.clrs').data('editor');return d.gotoLine(a.lineNumber),d.navigateLineEnd(),$.Dialog.fail(!1,a.message),d.focus(),void b.enable()}b.toggleClass('typcn-document-text typcn-edit').toggleHtml(['Plain text editor','Interactive editor']).enable(),$.Dialog.clearNotice(/Parse error on line \d+ \(shown below\)/)});z.append('<label>\n\t\t\t<span>Group name (2-30 chars.)</span>\n\t\t\t<input type="text" name="label" pattern="'+PRINTABLE_ASCII_PATTERN.replace('+','{2,30}')+'" required>\n\t\t</label>',$.mk('label').append($.mk('input').attr({type:'checkbox',name:'major'}).on('click change',function(){$(this).parent().next()[this.checked?'show':'hide']().children('input').attr('disabled',!this.checked)}),'<span>This is a major change</span>'),'<label style="display:none">\n\t\t\t<span>Change reason (1-255 chars.)</span>\n\t\t\t<input type=\'text\' name=\'reason\' pattern="'+PRINTABLE_ASCII_PATTERN.replace('+','{1,255}')+'" required disabled>\n\t\t</label>\n\t\t<p class="align-center">The # symbol is optional, rows with invalid '+h+'s will be ignored. Each color must have a short (3-30 chars.) description of its intended use.</p>',$.mk('div').attr('class','btn-group').append(E,G),$.mk('div').attr('class','clrs').append(D())).on('render-color-inputs',function(){var a=$(this),b=a.data('color_values'),c=a.children('.clrs').empty();$.each(b,function(a,b){c.append(D(b))}),c.data('sortable',new Sortable(c.get(0),{handle:'.move',ghostClass:'moving',scroll:!1,animation:150}))}).on('save-color-inputs',function(a,b,c){var d,e=$(this),f=e.children('.clrs'),g=f.hasClass('ace_editor');if(g){if(d=f.data('editor'),e.data('color_values',F(d.getValue(),b||c)),b)return;d.destroy(),f.empty().removeClass('ace_editor ace-colorguide').removeData('editor').unbind(),e.trigger('render-color-inputs')}else{var h=[];if(e.find('.clr').each(function(){var a=$(this),b=a.children('.clri'),d=b.val(),e=j.test(d);!e&&(d.length||c)||h.push({hex:e?$.hexpand(d).toUpperCase().replace(j,'#$1'):void 0,label:a.children('.clrl').val()})}),e.data('color_values',h),b)return;var i=['// One color per line','// e.g. #012ABC Fill'];$.each(h,function(a,b){var c=[];'object'===('undefined'==typeof b?'undefined':_typeof(b))&&(c.push(b.hex?b.hex:'#'),b.label&&c.push(b.label)),i.push(c.join('\t'))});var k=f.data('sortable');'undefined'!=typeof k&&k.destroy(),f.unbind().hide().text(i.join('\n')+'\n'),$.getAceEditor(!1,'colorguide',function(a){f.show(),d=ace.edit(f[0]);var b=$.aceInit(d,a);b.setTabSize(8),b.setMode(a),d.navigateFileEnd(),d.focus(),f.data('editor',d)})}});var H;window.ctxmenus=function(){c()},s.on('page-switch',d),d(),$('.cg-export').on('click',function(){$.mk('form').attr({method:'POST',action:'/cg/export',target:'_blank'}).html($.mk('input').attr('name','CSRF_TOKEN').val($.getCSRFToken())).submit()}),$('.cg-reindex').on('click',function(){$.Dialog.confirm('Re-index all appearances','Wipe and rebuild ElasticSearch index?',function(a){a&&($.Dialog.wait(!1),$.post('/cg/reindex',$.mkAjaxHandler(function(){return this.status?void $.Dialog.success(!1,this.message,!0):$.Dialog.fail(!1,this.message)})))})})});
//# sourceMappingURL=/js/min/colorguide-manage.js.map
