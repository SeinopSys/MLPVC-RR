"use strict";$(function(){console.log("[HTTP-Nav] > $(document).ready()"),console.group("[HTTP-Nav] GET "+window.location.pathname+window.location.search+window.location.hash);var e=function(e){e.fluidbox({immediateOpen:!0,loader:!0}).on("openstart.fluidbox",function(){$body.addClass("fluidbox-open");$(this).parents("#dialogContent").length&&$body.addClass("fluidbox-in-dialog")}).on("openend.fluidbox",function(){var e=$(this),o=e.attr("href");e.data("href",o),e.removeAttr("href");0===e.find(".fluidbox__ghost").children().length&&e.find(".fluidbox__ghost").append($.mk("img").attr("src",o).css({opacity:0,width:"100%",height:"100%"}))}).on("closestart.fluidbox",function(){$body.removeClass("fluidbox-open");var e=$(this);e.attr("href",e.data("href")),e.removeData("href")}).on("closeend.fluidbox",function(){$body.removeClass("fluidbox-in-dialog")})};$.fn.fluidboxThis=function(o){var t=this;return"function"==typeof $.fn.fluidbox?(e(this),$.callCallback(o)):$.getScript("/js/min/jquery.ba-throttle-debounce.js",function(){$.getScript("/js/min/jquery.fluidbox.js",function(){e(t),$.callCallback(o)}).fail(function(){$.Dialog.fail(!1,"Loading Fluidbox plugin failed")})}).fail(function(){$.Dialog.fail(!1,"Loading Debounce/throttle plugin failed")}),this};var o=function(e,o){var t=void 0!==window.screenLeft?window.screenLeft:screen.left,n=void 0!==window.screenTop?window.screenTop:screen.top,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;return{top:(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-o/2+n,left:i/2-e/2+t}};$.PopupOpenCenter=function(e,t,n,i){var a=o(n,i),s=window.open(e,t,"scrollbars=yes,width="+n+",height="+i+",top="+a.top+",left="+a.left);return window.focus&&s.focus(),s},$.PopupMoveCenter=function(e,t,n){var i=o(t,n);e.resizeTo(t,n),e.moveTo(i.left,i.top)};var t=window.OAUTH_URL,n=function(){return(~~(99999999*Math.random())).toString(36)};$d.on("click","#turbo-sign-in",function(e){e.preventDefault();var o=$(this),i=o.parent().html();o.disable(),t=o.attr("data-url");var a=n(),s=!1,r=void 0,c=void 0;window[" "+a]=function(){s=!0,"request"===$.Dialog._open.type?$.Dialog.clearNotice(/Redirecting you to DeviantArt/):$.Dialog.close(),c.close()};try{c=window.open(t+"&state="+a)}catch(e){return $.Dialog.fail(!1,"Could not open login pop-up. Please open another page")}$.Dialog.wait(!1,"Redirecting you to DeviantArt"),r=setInterval(function(){try{if(!c||c.closed){if(clearInterval(r),s)return;$.Dialog.fail(!1,i)}}catch(e){}},500)}),$.Navigation={visit:function(e){window.location.href=e},reload:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&$.Dialog.wait(!1,"Reloading page",!0),window.location.reload()}},window.DocReady={push:function(e,o){"function"==typeof o&&(e.flush=o),$.Navigation._DocReadyHandlers.push(e)}};!0!==window.ServiceUnavailableError&&$.get("/footer-git",$.mkAjaxHandler(function(){this.footer&&$footer.prepend(this.footer)})),$sbToggle.off("click sb-open sb-close").on("click",function(e){e.preventDefault(),window.sidebarForcedVisible()||$sbToggle.trigger("sb-"+($body.hasClass("sidebar-open")?"close":"open"))}).on("sb-open sb-close",function(e){var o="close"===e.type.substring(3);$body[o?"removeClass":"addClass"]("sidebar-open");try{$.LocalStorage[o?"set":"remove"]("sidebar-closed","true")}catch(e){}setTimeout(function(){$w.trigger("resize")},510)}),function(){var e=void 0,o=void 0,t=function(){void 0!==o&&(clearInterval(o),o=void 0)},n=function o(){var n="function"==typeof e.parent&&0!==e.parent().length,i={},a=void 0,s=void 0;if(n&&(a=new Date,s=new Date(e.attr("datetime")),i=Time.Difference(a,s)),!n||i.past)return t(),void $.post("/about/upcoming",$.mkAjaxHandler(function(){if(!this.status)return console.error("Failed to load upcoming event list: "+this.message);var e=$("#upcoming");e.find("ul").html(this.html),this.html?e.removeClass("hidden"):e.addClass("hidden"),window.setUpcomingCountdown()}));var r=void 0;i.time<Time.InSeconds.month&&0===i.month?(i.week>0&&(i.day+=7*i.week),r="in ",i.day>0&&(r+=i.day+" day"+(1!==i.day?"s":"")+" & "),i.hour>0&&(r+=i.hour+":"),r+=$.pad(i.minute)+":"+$.pad(i.second)):(t(),setTimeout(o,1e4),r=moment(s).from(a)),e.text(r)};window.setUpcomingCountdown=function(){var i=$("#upcoming");if(i.length){var a=i.children("ul").children();if(!a.length)return i.addClass("hidden");i.removeClass("hidden"),e=a.first().find("time").addClass("nodt"),t(),o=setInterval(n,1e3),n(),i.find("li").each(function(){var e=$(this),o=e.children(".calendar"),t=moment(e.find(".countdown").data("airs")||e.find("time").attr("datetime"));o.children(".top").text(t.format("MMM")),o.children(".bottom").text(t.format("D"))}),Time.Update();var s=function(){a.find(".title").simplemarquee({speed:25,cycles:1/0,space:25,handleHover:!1,delayBetweenCycles:0}).addClass("marquee")};"function"!=typeof jQuery.fn.simplemarquee?$.ajax({url:"/js/min/jquery.simplemarquee.js",dataType:"script",cache:!0,success:s}):s()}},window.setUpcomingCountdown()}(),$(document).off("click",".send-feedback").on("click",".send-feedback",function(e){e.preventDefault(),e.stopPropagation(),$("#ctxmenu").hide();var o=["seinopsys","gmail.com"].join("@");$.Dialog.info($.Dialog.isOpen()?void 0:"Send feedback","<h3>How to send feedback</h3>\n\t\t\t<p>If you're having an issue with the site and would like to let us know or have an idea/feature request you’d like to share, here’s how:</p>\n\t\t\t<ul>\n\t\t\t\t<li><a href='https://discord.gg/0vv70fepSILbdJOD'>Join our Discord server</a> and describe your issue/idea in the <strong>#support</strong> channel</li>\n\t\t\t\t<li><a href='http://mlp-vectorclub.deviantart.com/notes/'>Send a note </a>to the group on DeviantArt</li>\n\t\t\t\t<li><a href='mailto:"+o+"'>Send an e-mail</a> to "+o+'</li>\n\t\t\t\t<li>If you have a GitHub account, you can also  <a href="'+$footer.find("a.issues").attr("href")+'">create an issue</a> on the project’s GitHub page.\n\t\t\t</ul>')}),$(document).off("click",".action--color-avg").on("click",".action--color-avg",function(e){e.preventDefault(),e.stopPropagation();var o="Color Average Calculator",t=function(){$.Dialog.close();var e=window.$ColorAvgFormTemplate.clone(!0,!0);$.Dialog.request(o,e,!1,function(){e.triggerHandler("added")})};if(void 0===window.$ColorAvgFormTemplate){$.Dialog.wait(o,"Loading form, please wait");var n="/js/min/global-color_avg_form.js";$.getScript(n,t).fail(function(){setTimeout(function(){$.Dialog.close(function(){$.Dialog.wait(o,"Loading script (attempt #2)"),$.getScript(n.replace(/min\./,""),t).fail(function(){$.Dialog.fail(o,"Form could not be loaded")})})},1)})}else t()});var i=$("html");if($.isRunningStandalone()){var a=i.scrollTop(),s=function(){if(window.withinMobileBreakpoint()&&!i.is(":animated")){var e=i.scrollTop(),o=$header.outerHeight(),t=parseInt($header.css("top"),10);$header.css("top",e>a?Math.max(-o,t-(e-a)):Math.min(0,t+(a-e))),a=e}};$d.on("scroll",s),s()}var r=$("#to-the-top").on("click",function(e){e.preventDefault(),i.stop().animate({scrollTop:0},200),r.removeClass("show")});function c(){if(window.withinMobileBreakpoint()&&!i.is(":animated")){var e=0!==i.scrollTop();!e&&r.hasClass("show")?r.removeClass("show"):e&&!r.hasClass("show")&&r.addClass("show")}}$d.on("scroll",c),c(),function(){var e=void 0,o="https://ws."+location.hostname+":8667/",t=function(e){return function(o){if("string"==typeof o)try{o=JSON.parse(o)}catch(e){}e(o)}},n=void 0,i=void 0,a=void 0,s=!1,r=function(){a.off("click",".mark-read").on("click",".mark-read",function(e){e.preventDefault(),e.stopPropagation();var o=$(this);if(!o.hasClass("disabled")){var t=o.attr("data-id"),n={read_action:o.attr("data-value")},i=o.attr("data-action")||"Mark notification as read",a=function(){o.siblings(".mark-read").addBack().addClass("disabled"),$.post("/notifications/mark-read/"+t,n,$.mkAjaxHandler(function(){return this.status?this.message?$.Dialog.success(i,this.message,!0):void $.Dialog.close():$.Dialog.fail(i,this.message)})).always(function(){o.siblings(".mark-read").addBack().removeClass("disabled")})};n.read_action&&o.hasAttr("data-confirm")?$.Dialog.confirm("Actionable notification",'Please confirm your choice: <strong class="color-'+o.attr("class").replace(/^.*variant-(\w+)\b.*$/,"$1")+'">'+o.attr("title")+"</strong>",["Confirm","Cancel"],function(e){e&&($.Dialog.wait(i),a())}):a()}})},c=function(){0===(n=$sbToggle.children(".notif-cnt")).length&&(n=$.mk("span").attr({class:"notif-cnt",title:"New notifications"}).prependTo($sbToggle)),i=$sidebar.children(".notifications"),a=i.children(".notif-list"),r()};function l(){var l=function(){c(),e||((e=io(o,{reconnectionDelay:1e4})).on("connect",function(){console.log("[WS] %cConnected","color:green"),$.WS.recvPostUpdates(void 0!==window.EpisodePage),$.WS.navigate()}),e.on("auth",t(function(e){s=!0,console.log("[WS] %cAuthenticated as "+e.name,"color:teal")})),e.on("auth-guest",t(function(){console.log("[WS] %cReceiving events as a guest","color:teal")})),e.on("notif-cnt",t(function(e){var o=e.cnt?parseInt(e.cnt,10):0;console.log("[WS] Unread notification count: %d",o),c(),0===o?i.stop().slideUp("fast",function(){a.empty(),n.empty()}):$.post("/notifications/get",$.mkAjaxHandler(function(){n.text(o),a.html(this.list),Time.Update(),r(),i.stop().slideDown()}))})),e.on("post-delete",t(function(e){if(e.type&&e.id){var o=e.type+"-"+e.id,t=$("#"+o+":not(.deleting)");console.log("[WS] Post deleted (postid=%s)",o),t.length&&(t.find(".fluidbox--opened").fluidbox("close"),t.find(".fluidbox--initialized").fluidbox("destroy"),t.attr({class:"deleted",title:"This post has been deleted; click here to hide"}).on("click",function(){var e=$(this);e[window.withinMobileBreakpoint()?"slideUp":"fadeOut"](500,function(){e.remove()})}))}})),e.on("post-break",t(function(e){if(e.type&&e.id){var o=e.type+"-"+e.id,t=$("#"+o+":not(.admin-break)");console.log("[WS] Post broken (postid=%s)",o),t.length&&(t.find(".fluidbox--opened").fluidbox("close"),t.find(".fluidbox--initialized").fluidbox("destroy"),t.reloadLi())}})),e.on("post-add",t(function(e){e.type&&e.id&&window.EPISODE===e.episode&&window.SEASON===e.season&&($(".posts #"+e.type+"-"+e.id).length>0||$.post("/post/reload/"+e.type+"/"+e.id,$.mkAjaxHandler(function(){if(this.status&&!($(".posts #"+e.type+"-"+e.id).length>0)){var o=$(this.li);$(this.section).append(o),o.rebindFluidbox(),Time.Update(),o.rebindHandlers(!0).parent().reorderPosts(),console.log("[WS] Post added (postid="+e.type+"-#"+e.id+") to container "+this.section)}})))})),e.on("post-update",t(function(e){if(e.type&&e.id){var o=e.type+"-"+e.id,t=$("#"+o+":not(.deleting)");console.log("[WS] Post updated (postid=%s)",o),t.length&&t.reloadLi(!1)}})),e.on("entry-score",t(function(e){if(void 0!==e.entryid){var o=$("#entry-"+e.entryid);console.log("[WS] Entry score updated (entryid=%s, score=%s)",e.entryid,e.score),o.length&&o.refreshVoting()}})),e.on("devaction",t(function(e){if(console.log("[WS] DevAction",e),"string"==typeof e.remoteAction)switch(e.remoteAction){case"reload":window.location.reload();break;case"message":$.Dialog.info("Message from the developer",e.data.html)}})),e.on("disconnect",function(){s=!1,console.log("[WS] %cDisconnected","color:red")}))};window.io?l():$.ajax({url:o+"socket.io/socket.io.js",cache:"true",dataType:"script",success:l,statusCode:{404:function(){console.log("%c[WS] Server down!","color:red"),$.WS.down=!0,$sidebar.find(".notif-list").on("click",".mark-read",function(e){e.preventDefault(),$.Dialog.fail("Mark notification read",'The notification server appears to be down. Please <a class="send-feedback">let us know</a>, and sorry for the inconvenience.')})}}})}l(),$.WS=function(){var o=function(){return l()},n={postUpdates:!1,entryUpdates:!1};return o.down=!1,o.navigate=function(){if(void 0!==e){var o=location.pathname+location.search+location.hash;e.emit("navigate",{page:o})}},o.recvPostUpdates=function(i){if(void 0===e)return setTimeout(function(){o.recvPostUpdates(i)},2e3);"boolean"==typeof i&&n.postUpdates!==i&&e.emit("post-updates",String(i),t(function(e){if(!e.status)return console.log("[WS] %cpost-updates subscription status change failed (subscribe=%s)","color:red",i);n.postUpdates=i,$("#episode-live-update")[n.postUpdates?"removeClass":"addClass"]("hidden"),console.log("[WS] %c%s","color:green",e.message)}))},o.recvEntryUpdates=function(i){if(void 0===e)return setTimeout(function(){o.recvEntryUpdates(i)},2e3);"boolean"==typeof i&&n.entryUpdates!==i&&e.emit("entry-updates",String(i),t(function(e){if(!e.status)return console.log("[WS] %centry-updates subscription status change failed (subscribe=%s)","color:red",i);n.entryUpdates=i,$("#entry-live-update")[n.entryUpdates&&"contest"===window.EventType?"removeClass":"addClass"]("hidden"),console.log("[WS] %c%s","color:green",e.message)}))},o.authme=function(){void 0!==e&&!0!==s&&(console.log("[WS] %cReconnection needed for identity change","color:teal"),e.disconnect(0),setTimeout(function(){e.connect()},100))},o.unauth=function(){void 0!==e&&!0===s&&e.emit("unauth",null,function(e){if(!e.status)return console.log("[WS] %cUnauth failed","color:red");s=!1,console.log("[WS] %cAuthentication dropped","color:brown")})},o.disconnect=function(o){void 0!==e&&(console.log("[WS] Forced disconnect (reason="+o+")"),e.disconnect(0))},o.status=function(){if(void 0===e)return setTimeout(function(){o.status()},2e3);e.emit("status",null,t(function(e){console.log("[WS] Status: ID=%s; Name=%s; Rooms=%s",e.User.id,e.User.name,e.rooms.join(","))}))},o.devquery=function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(void 0===e)return setTimeout(function(){o.devquery(n,i,a)},2e3);e.emit("devquery",{what:n,data:i},t(function(e){if("function"==typeof a)return a(e);console.log("[WS] DevQuery "+(e.status?"Success":"Fail"),e)}))},o.devaction=function(n,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(void 0===e)return setTimeout(function(){o.devaction(n,i,a)},2e3);e.emit("devaction",{clientId:n,remoteAction:i,data:a},t(function(e){console.log("[WS] DevAction "+(e.status?"Success":"Fail"),e)}))},o.essentialElements=function(){c()},o}()}(),function(){console.log("> docReadyAlwaysRun()"),$d.triggerHandler("paginate-refresh"),$.LocalStorage.remove("cookie_consent");var e=$.LocalStorage.get("cookie_consent_v2");t=window.OAUTH_URL,$("#signin").off("click").on("click",function(){var o=$(this),i=function(e){if(e){$.Dialog.close(),$.LocalStorage.set("cookie_consent_v2",1),o.disable();var i=function(){$.Dialog.wait(!1,"Redirecting you to DeviantArt"),location.href=t+"&state="+encodeURIComponent(location.href.replace(location.origin,""))};if(-1!==navigator.userAgent.indexOf("Trident"))return i();$.Dialog.wait("Sign-in process","Opening popup window");var a=n(),s=!1,r=void 0,c=void 0;window[" "+a]=function(e,t){if(clearInterval(r),!0!==e)s=!0,$.Dialog.success(!1,"Signed in successfully"),c.close(),$.Navigation.reload(!0);else{if(t.jQuery){var n=t.$("#content").children("h1").text(),i=t.$("#content").children(".notice").html();$.Dialog.fail(!1,'<p class="align-center"><strong>'+n+"</strong></p><p>"+i+"</p>"),c.close()}else $.Dialog.fail(!1,"Sign in failed, check popup for details.");o.enable()}};try{c=$.PopupOpenCenter(t+"&state="+a,"login","450","580")}catch(e){}r=setInterval(function(){try{c&&!c.closed||(clearInterval(r),function(){if(!s){if(-1!==document.cookie.indexOf("auth="))return window[" "+a];$.Dialog.fail(!1,"Popup-based login unsuccessful"),i()}}())}catch(e){}},500),$w.on("beforeunload",function(){s=!0,c.close()}),$.Dialog.wait(!1,"Waiting for you to sign in")}};e?i(!0):$.Dialog.confirm("Privacy Notice",'<p>We must inform you that our website will store cookies on your device to remember your logged in status between browser sessions.</p><p>If you would like to avoid these completly harmless pieces of text which are required to log in to this website, click "Decline" and continue browsing as a guest.</p><p><em>This warning will not appear again if you accept our use of persistent cookies.</em></p>',["Accept","Decline"],i)}),$("#signout").off("click").on("click",function(){$.Dialog.confirm("Sign out","Are you sure you want to sign out?",function(e){e&&($.Dialog.wait("Sign out","Signing out"),$.post("/da-auth/signout",$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail("Sign out",this.message);$.Navigation.reload()})))})}),$body.swipe($.throttle(10,function(e,o){if(!window.sidebarForcedVisible()&&$body.hasClass("sidebar-open")){var t=Math.abs(o.x),n=Math.abs(o.y),i=Math.min($body.width()/2,200);"left"!==e.x||t<i||n>75||$sbToggle.trigger("click")}}))}(),console.log("%cDocument ready handlers called","color:green"),console.groupEnd()}),$w.on("load",function(){$body.removeClass("loading")});
//# sourceMappingURL=/js/min/global.js.map
