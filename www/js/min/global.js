'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(a){'use strict';var b=function(b){b.fluidbox({immediateOpen:!0,loader:!0}).on('openstart.fluidbox',function(){$body.addClass('fluidbox-open');var b=a(this);b.parents('#dialogContent').length&&$body.addClass('fluidbox-in-dialog')}).on('openend.fluidbox',function(){var b=a(this),c=b.attr('href');b.data('href',c),b.removeAttr('href');var d=b.find('.fluidbox__ghost');0===d.children().length&&b.find('.fluidbox__ghost').append(a.mk('img').attr('src',c).css({opacity:0,width:'100%',height:'100%'}))}).on('closestart.fluidbox',function(){$body.removeClass('fluidbox-open');var b=a(this);b.attr('href',b.data('href')),b.removeData('href')}).on('closeend.fluidbox',function(){$body.removeClass('fluidbox-in-dialog')})};a.fn.fluidboxThis=function(c){var d=this;return'function'==typeof a.fn.fluidbox?(b(this),a.callCallback(c)):a.getScript('/js/min/jquery.ba-throttle-debounce.js',function(){a.getScript('/js/min/jquery.fluidbox.js',function(){b(d),a.callCallback(c)}).fail(function(){a.Dialog.fail(!1,'Loading Fluidbox plugin failed')})}).fail(function(){a.Dialog.fail(!1,'Loading Debounce/throttle plugin failed')}),this};var c=function(a,b){var c='undefined'==typeof window.screenLeft?screen.left:window.screenLeft,d='undefined'==typeof window.screenTop?screen.top:window.screenTop,e=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,f=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;return{top:f/2-b/2+d,left:e/2-a/2+c}};a.PopupOpenCenter=function(a,b,d,e){var f=c(d,e),g=window.open(a,b,'scrollbars=yes,width='+d+',height='+e+',top='+f.top+',left='+f.left);return window.focus&&g.focus(),g},a.PopupMoveCenter=function(a,b,d){var e=c(b,d);a.resizeTo(b,d),a.moveTo(e.left,e.top)};var d=window.OAUTH_URL,f=function(){return(~~(99999999*Math.random())).toString(36)};$d.on('click','#turbo-sign-in',function(b){b.preventDefault();var c=a(this),e=c.parent().html();c.disable(),d=c.attr('data-url');var g,h,i=f(),j=!1;window[' '+i]=function(){j=!0,'request'===a.Dialog._open.type?a.Dialog.clearNotice(/Redirecting you to DeviantArt/):a.Dialog.close(),h.close()};try{h=window.open(d+'&state='+i)}catch(b){return a.Dialog.fail(!1,'Could not open login pop-up. Please open another page')}a.Dialog.wait(!1,'Redirecting you to DeviantArt'),g=setInterval(function(){try{if(!h||h.closed){if(clearInterval(g),j)return;a.Dialog.fail(!1,e)}}catch(a){}},500)});var e=function(){console.log('> docReadyAlwaysRun()'),$d.triggerHandler('paginate-refresh'),a.LocalStorage.remove('cookie_consent');var b=a.LocalStorage.get('cookie_consent_v2');d=window.OAUTH_URL,a('#signin').off('click').on('click',function(){var c=a(this),e=function(b){if(b){a.Dialog.close(),a.LocalStorage.set('cookie_consent_v2',1),c.disable();var e=function(){a.Dialog.wait(!1,'Redirecting you to DeviantArt'),location.href=d+'&state='+encodeURIComponent(location.href.replace(location.origin,''))};if(-1!==navigator.userAgent.indexOf('Trident'))return e();a.Dialog.wait('Sign-in process','Opening popup window');var g,h,i=f(),j=!1,k=!1;window[' '+i]=function(b,d){if(clearInterval(g),!0===b){if(!d.jQuery)a.Dialog.fail(!1,'Sign in failed, check popup for details.');else{var e=d.$('#content').children('h1').text(),f=d.$('#content').children('.notice').html();a.Dialog.fail(!1,'<p class="align-center"><strong>'+e+'</strong></p><p>'+f+'</p>'),h.close()}return void c.enable()}j=!0,a.Dialog.success(!1,'Signed in successfully'),a.Dialog.wait(!1,'Reloading page'),k=!0,setTimeout(function(){h.close()},750),a.Navigation.reload(function(){k=!1,a.Dialog.close()})};try{h=a.PopupOpenCenter(d+'&state='+i,'login','450','580')}catch(a){}var l=function(){return j?void 0:-1===document.cookie.indexOf('auth=')?void(a.Dialog.fail(!1,'Popup-based login unsuccessful'),e()):window[' '+i]};g=setInterval(function(){try{(!h||h.closed)&&(clearInterval(g),l())}catch(a){}},500),$w.on('beforeunload',function(){j=!0,k||h.close()}),a.Dialog.wait(!1,'Waiting for you to sign in')}};b?e(!0):a.Dialog.confirm('Privacy Notice','<p>We must inform you that our website will store cookies on your device to remember your logged in status between browser sessions.</p><p>If you would like to avoid these completly harmless pieces of text which are required to log in to this website, click "Decline" and continue browsing as a guest.</p><p><em>This warning will not appear again if you accept our use of persistent cookies.</em></p>',['Accept','Decline'],e)}),a('#signout').off('click').on('click',function(){var b='Sign out';a.Dialog.confirm(b,'Are you sure you want to sign out?',function(c){c&&(a.Dialog.wait(b,'Signing out'),a.post('/da-auth/signout',a.mkAjaxHandler(function(){return this.status?void a.Navigation.reload(function(){a.Dialog.close()}):a.Dialog.fail(b,this.message)})))})});try{if(/^https/.test(location.protocol))throw void 0;var c=a.SessionStorage.get('canhttps');if('false'===c)throw void 0;a.ajax({method:'POST',url:'https://'+location.host+'/ping',success:a.mkAjaxHandler(function(){this.status&&$sidebar.append(a.mk('a').attr({'class':'btn green typcn typcn-lock-closed',href:location.href.replace(/^http:/,'https:')}).text('Switch to HTTPS')),a.SessionStorage.set('canhttps',c=this.status.toString())}),error:function error(){a.SessionStorage.set('canhttps',c='false')}})}catch(a){}},g=function(){function b(c){if(_classCallCheck(this,b),this._options=a.extend({min:0,max:0.98,intervalEnabled:!0,intervalDelay:800,randomIncrement:0.08},c),this._$element=$header.find('.loading-indicator').children('.loading-circle'),1!==this._$element.length)throw new Error('Loader: Element not found');this._circumference=2*this._$element.attr('r')*Math.PI,this._$element.css('stroke-dasharray',this._circumference),this.val(1,1)}return _createClass(b,[{key:'show',value:function show(){$body.addClass('loading'),this.val(0),this._startInterval()}},{key:'_startInterval',value:function _startInterval(){var a=this;this._options.intervalEnabled&&'undefined'==typeof this._interval&&(this._interval=setInterval(function(){a.inc(null,0.5)},this._options.intervalDelay))}},{key:'_clearInterval',value:function _clearInterval(){return'undefined'!=typeof this._interval&&void(clearInterval(this._interval),this._interval=void 0)}},{key:'enableInterval',value:function enableInterval(){this._options.intervalEnabled=!0,this._startInterval()}},{key:'disableInterval',value:function disableInterval(){this._options.intervalEnabled=!1,this._clearInterval()}},{key:'val',value:function val(b,c){isNaN(b)||(this.at=a.rangeLimit(b,!1,this._options.min,c||this._options.max)),this._$element.css('stroke-dashoffset',this._circumference*(1-this.at))}},{key:'inc',value:function inc(a,b){return isNaN(a)||(a=Math.random()*this._options.randomIncrement),!(this._options.max<this.at+a)&&void this.val(this.at+a,b)}},{key:'finish',value:function finish(){this.val(1,1),this.hide()}},{key:'hide',value:function hide(){this._clearInterval(),$body.removeClass('loading')}}]),b}();a.Loader=new g;var h=function(){function b(){_classCallCheck(this,b),this._DocReadyHandlers=[],this._xhr=!1,this._lastLoadedPathname=window.location.pathname,this._lastLoadedHref=window.location.href,this.firstLoadDone=!1}return _createClass(b,[{key:'_docReady',value:function _docReady(){console.groupCollapsed('> _docReady()'),e(),console.groupEnd();for(var a=0,b=this._DocReadyHandlers.length;a<b;a++)try{console.group('DocReadyHandlers[%d]()',a),this._DocReadyHandlers[a].call(window),console.groupEnd()}catch(b){console.error('Error while executing DocReadyHandlers['+a+']\n'+b.stack)}}},{key:'flushDocReady',value:function flushDocReady(){a('.marquee').trigger('destroy.simplemarquee').removeClass('marquee');for(var b=0,c=this._DocReadyHandlers.length;b<c;b++)'function'==typeof this._DocReadyHandlers[b].flush&&(this._DocReadyHandlers[b].flush(),console.log('Flushed DocReady handler #%d',b));this._DocReadyHandlers=[]}},{key:'_loadCSS',value:function _loadCSS(b,c,d){if(!b.length)return a.callCallback(d);console.groupCollapsed('Loading CSS');this;(function e(f){if(f>=b.length)return console.groupEnd(),a.callCallback(d);var g=b[f];a.ajax({url:g,dataType:'text',success:function success(b){b=b.replace(/url\((['"])?(?:\.\.\/)+/g,'url($1/'),$head.append(a.mk('style').attr('href',g).text(b)),console.log('%c#%d (%s)','color:green',f,g)},error:function error(){console.log('%c#%d (%s)','color:red',f,g)},complete:function complete(){c(),e(f+1)}})})(0)}},{key:'_loadJS',value:function _loadJS(b,c,d){if(!b.length)return a.callCallback(d);console.groupCollapsed('Loading JS');var e=this;(function f(g){if(g>=b.length)return console.groupEnd(),a.callCallback(d);var h=b[g];e._xhr=a.ajax({url:h,dataType:'text',success:function success(b){$body.append(a.mk('script').attr('data-src',h).text(b)),console.log('%c#%d (%s)','color:green',g,h)},error:function error(){console.log('%c#%d (%s)','color:red',g,h)},complete:function complete(){c(),f(g+1)}})})(0)}},{key:'visit',value:function visit(b,c,d){console.clear(),console.group('[AJAX-Nav] PING %s (block_reload: %s)',b,d);var e=this;if(!1!==e._xhr){try{e._xhr.abort(),console.log('Previous AJAX request aborted')}catch(a){}e._xhr=!1}a.Loader.show(),a.Loader.enableInterval();var f=a.ajax({url:b,data:{'via-js':!0},success:a.mkAjaxHandler(function(){if(e._xhr!==f)return console.log('%cAJAX request objects do not match, bail','color:red'),void console.groupEnd();if(!this.status)return $body.removeClass('loading'),a.Loader.finish(),e._xhr=!1,console.log('%cNavigation error %s','color:red',this.message),console.groupEnd(),a.Dialog.fail('Navigation error',this.message);a.Loader.val(0.5),a.Loader.disableInterval(),b=new URL(this.responseURL).pathString+new URL(b).hash,$w.triggerHandler('unload'),window.OpenSidebarByDefault()||$sbToggle.trigger('sb-close');var g=this.css,h=this.js,i=this.content,j=this.sidebar,k=this.footer,l=this.title,m=this.avatar,n=this.signedIn;$main.empty();var o=!1,p=new URL(location.href),q=!d&&p.pathString===b;if(e.flushDocReady(),console.groupCollapsed('Checking JS files to skip...'),$body.children('script[src], script[data-src]').each(function(){var b=a(this),c=b.attr('src')||b.attr('data-src');if(q)return /min\/dialog\.js/.test(c)||b.remove(),!0;var d=h.indexOf(c);if(-1!==d&&!/min\/(colorguide[.-]|events-manage|episodes-manage|moment-timezone|episode|Chart|user[.-])/.test(c))h.splice(d,1),console.log('%cSkipped %s','color:saddlebrown',c);else{if(c.includes('global'))return!(o=!0);b.remove()}}),console.log('%cFinished.','color:green'),console.groupEnd(),!1!=o)return console.log('%cFull page reload forced by changes in global.js','font-weight:bold;color:orange'),console.groupEnd(),e._xhr.abort(),void(location.href=b);console.groupCollapsed('Checking CSS files to skip...');var r='link[href], style[href]';$head.children(r).each(function(){var b=a(this),c=b.attr('href'),d=g.indexOf(c);-1===d?b.attr('data-remove','true'):(g.splice(d,1),console.log('%cSkipped %s','color:saddlebrown',c))}),console.log('%cFinished.','color:green'),console.groupEnd(),console.groupEnd(),console.group('[AJAX-Nav] GET %s',b);var s=0,t=g.length+h.length;$w.trigger('beforeunload'),e._loadCSS(g,function(){s++,a.Loader.val(0.5+0.5*(s/t))},function(){$head.children(r.replace(/href/g,'data-remove=true')).remove(),$main.addClass('pls-wait').html(i),$sidebar.html(j),$footer.html(k),Time.Update(),window.setUpcomingCountdown();var f=$header.find('nav').children();f.children().first().children('img').attr('src',m),f.children(':not(:first-child)').remove(),f.append($sidebar.find('nav').children().children().clone()),window.CommonElements(),d||history[p.pathString===b?'replaceState':'pushState']({'via-js':!0},'',b),document.title=l,e._lastLoadedPathname=window.location.pathname,e._lastLoadedHref=window.location.href,e._loadJS(h,function(){s++,a.Loader.val(0.5+0.5*(s/t))},function(){console.log('> $(document).ready() [simulated]'),e._docReady(),console.log('%cDocument ready handlers called','color:green'),console.groupEnd(),$main.removeClass('pls-wait'),n?a.WS.authme():a.WS.unauth(),a.WS.navigate(),a.callCallback(c),a.Loader.finish(),e._xhr=!1})})})});e._xhr=f}},{key:'reload',value:function reload(a){this.visit(location.pathname+location.search+location.hash,a)}}]),b}();a.Navigation=new h,window.DocReady={push:function push(b,c){'function'==typeof c&&(b.flush=c),a.Navigation._DocReadyHandlers.push(b)}}})(jQuery),$(function(){'use strict';if(!$.Navigation.firstLoadDone){if($.Navigation.firstLoadDone=!0,console.log('[HTTP-Nav] > $(document).ready()'),console.group('[HTTP-Nav] GET '+window.location.pathname+window.location.search+window.location.hash),'serviceWorker'in navigator&&window.addEventListener('load',function(){navigator.serviceWorker.register('/sw.js').then(function(){}).catch(function(){})}),!0!==window.ServiceUnavailableError&&$.get('/footer-git',$.mkAjaxHandler(function(){this.footer&&$footer.prepend(this.footer)})),function(){var a=function(){setTimeout(function(){$w.trigger('resize')},510)};$sbToggle.off('click sb-open sb-close').on('click',function(a){a.preventDefault(),$sbToggle.trigger('sb-'+($body.hasClass('sidebar-open')?'close':'open'))}).on('sb-open sb-close',function(b){var c='close'===b.type.substring(3);$body[c?'removeClass':'addClass']('sidebar-open');try{$.LocalStorage[c?'set':'remove']('sidebar-closed','true')}catch(a){}a()});var b;try{b=$.LocalStorage.get('sidebar-closed')}catch(a){}'true'!==b&&window.OpenSidebarByDefault()&&($body.addClass('sidebar-open'),a())}(),function(){var a,b,c=function(){'undefined'!=typeof b&&(clearInterval(b),b=void 0)},d=function(){var b,e,f='function'==typeof a.parent&&0!==a.parent().length,g={};if(f&&(b=new Date,e=new Date(a.attr('datetime')),g=Time.Difference(b,e)),!f||g.past)return f&&(a.find('.marquee').trigger('destroy.simplemarquee'),a.parents('li').remove()),c(),window.setUpcomingCountdown();var h;g.time<Time.InSeconds.month&&0===g.month?(0<g.week&&(g.day+=7*g.week),h='in ',0<g.day&&(h+=g.day+' day'+(1===g.day?'':'s')+' & '),0<g.hour&&(h+=g.hour+':'),h+=$.pad(g.minute)+':'+$.pad(g.second)):(c(),setTimeout(d,1e4),h=moment(e).from(b)),a.text(h)};window.setUpcomingCountdown=function(){var e=$('#upcoming');if(e.length){var f=e.children('ul').children();if(!f.length)return e.remove();a=f.first().find('time').addClass('nodt'),c(),b=setInterval(d,1e3),d(),e.find('li').each(function(){var a=$(this),b=a.children('.calendar'),c=moment(a.find('.countdown').data('airs')||a.find('time').attr('datetime'));b.children('.top').text(c.format('MMM')),b.children('.bottom').text(c.format('D'))}),Time.Update();var g=function(){f.find('.title').simplemarquee({speed:25,cycles:Infinity,space:25,handleHover:!1,delayBetweenCycles:0}).addClass('marquee')};'function'==typeof jQuery.fn.simplemarquee?g():$.ajax({url:'/js/min/jquery.simplemarquee.js',dataType:'script',cache:!0,success:g})}},window.setUpcomingCountdown()}(),$(document).off('click','.send-feedback').on('click','.send-feedback',function(a){a.preventDefault(),a.stopPropagation(),$('#ctxmenu').hide(),$.Dialog.info($.Dialog.isOpen()?void 0:'Send feedback','<h3>How to send feedback</h3>\n\t\t\t<p>If you\'re having an issue with the site and would like to let us know or have an idea/feature request you\u2019d like to share, here\u2019s how:</p>\n\t\t\t<ul>\n\t\t\t\t<li><a href=\'https://discord.gg/0vv70fepSILbdJOD\'>Join our Discord server</a> and describe your issue in the <strong>#support</strong> channel</li>\n\t\t\t\t<li><a href=\'http://mlp-vectorclub.deviantart.com/notes/\'>Send a note </a>to the group on DeviantArt</li>\n\t\t\t\t<li><a href=\'mailto:seinopsys@gmail.com\'>Send an e-mail</a> to seinopsys@gmail.com</li>\n\t\t\t\t<li>If you have a GitHub account, you can also  <a href="'+$footer.find('a.issues').attr('href')+'">create an issue</a> on the project\u2019s GitHub page.\n\t\t\t</ul>')}),$(document).off('click','.action--color-avg').on('click','.action--color-avg',function(a){a.preventDefault(),a.stopPropagation();var b='Colour Average Calculator',c=function(){$.Dialog.close();var a=window.$ColorAvgFormTemplate.clone(!0,!0);$.Dialog.request(b,a,!1,function(){a.triggerHandler('added')})};if('undefined'==typeof window.$ColorAvgFormTemplate){$.Dialog.wait(b,'Loading form, please wait');var d='/js/min/global-color_avg_form.js';$.getScript(d,c).fail(function(){setTimeout(function(){$.Dialog.close(function(){$.Dialog.wait(b,'Loading script (attempt #2)'),$.getScript(d.replace(/min\./,''),c).fail(function(){$.Dialog.fail(b,'Form could not be loaded')})})},1)})}else c()}),$d.on('click','a[href]',function(a){if(2<a.which||a.ctrlKey||a.shiftKey)return!0;var b=this;return b.host!==location.host||(b.pathname===location.pathname&&b.search===location.search?b.protocol!==location.protocol||(a.preventDefault(),window._trighashchange=b.hash!==location.hash,!0===window._trighashchange&&history.replaceState(history.state,'',b.href),setTimeout(function(){delete window._trighashchange},1),void $w.triggerHandler('hashchange')):!/^.*\/[^.]*$/.test(b.pathname)||void(0!==$(this).parents('#dialogContent').length&&$.Dialog.close(),a.preventDefault(),$.Navigation.visit(this.href)))}),$w.on('popstate',function(a){var b=a.originalEvent.state,c=function(a,b){return $.Navigation.visit(a,b,!0)};return null===b||b['via-js']||!0!==b.paginate?$.Navigation._lastLoadedHref.replace(/#.*$/,'')===location.href.replace(/#.*$/,'')?void console.log('[AJAX-Nav] Hashchange detected, navigation blocked'):void c(location.href):$w.trigger('nav-popstate',[b,c])}),$.isRunningStandalone()){var a=$body.scrollTop(),b=function(){if(window.WithinMobileBreakpoint()){var b=$body.scrollTop(),c=$header.outerHeight(),d=parseInt($header.css('top'),10);$header.css('top',b>a?Math.max(-c,d-(b-a)):Math.min(0,d+(a-b))),a=b}};$w.on('scroll',b),b()}(function(){function a(){var a=function(){j(),b||(b=io(f,{reconnectionDelay:1e4}),b.on('connect',function(){console.log('[WS] %cConnected','color:green'),$.WS.recvPostUpdates('undefined'!=typeof window.EpisodePage),$.WS.navigate()}),b.on('auth',g(function(a){h=!0,console.log('[WS] %cAuthenticated as '+a.name,'color:teal')})),b.on('auth-guest',g(function(){console.log('[WS] %cReceiving events as a guest','color:teal')})),b.on('notif-cnt',g(function(a){var b=a.cnt?parseInt(a.cnt,10):0;console.log('[WS] Unread notification count: %d',b),j(),0===b?d.stop().slideUp('fast',function(){e.empty(),c.empty()}):$.post('/notifications/get',$.mkAjaxHandler(function(){c.text(b),e.html(this.list),Time.Update(),i(),d.stop().slideDown()}))})),b.on('post-delete',g(function(a){if(a.type&&a.id){var b=a.type+'-'+a.id,c=$('#'+b+':not(.deleting)');console.log('[WS] Post deleted (postid=%s)',b),c.length&&(c.find('.fluidbox--opened').fluidbox('close'),c.find('.fluidbox--initialized').fluidbox('destroy'),c.attr({'class':'deleted',title:'This post has been deleted; click here to hide'}).on('click',function(){var a=$(this);a[window.WithinMobileBreakpoint()?'slideUp':'fadeOut'](500,function(){a.remove()})}))}})),b.on('post-break',g(function(a){if(a.type&&a.id){var b=a.type+'-'+a.id,c=$('#'+b+':not(.admin-break)');console.log('[WS] Post broken (postid=%s)',b),c.length&&(c.find('.fluidbox--opened').fluidbox('close'),c.find('.fluidbox--initialized').fluidbox('destroy'),c.reloadLi())}})),b.on('post-add',g(function(a){a.type&&a.id&&window.EPISODE===a.episode&&window.SEASON===a.season&&!(0<$('.posts #'+a.type+'-'+a.id).length)&&$.post('/post/reload/'+a.type+'/'+a.id,$.mkAjaxHandler(function(){if(this.status&&!(0<$('.posts #'+a.type+'-'+a.id).length)){var b=$(this.li);$(this.section).append(b),b.rebindFluidbox(),Time.Update(),b.rebindHandlers(!0).parent().reorderPosts(),console.log('[WS] Post added (postid='+a.type+'-#'+a.id+') to container '+this.section)}}))})),b.on('post-update',g(function(a){if(a.type&&a.id){var b=a.type+'-'+a.id,c=$('#'+b+':not(.deleting)');console.log('[WS] Post updated (postid=%s)',b),c.length&&c.reloadLi(!1)}})),b.on('entry-score',g(function(a){if('undefined'!=typeof a.entryid){var b=$('#entry-'+a.entryid);console.log('[WS] Entry score updated (entryid=%s, score=%s)',a.entryid,a.score),b.length&&b.refreshVoting()}})),b.on('disconnect',function(){h=!1,console.log('[WS] %cDisconnected','color:red')}))};window.io?a():$.ajax({url:f+'socket.io/socket.io.js',cache:'true',dataType:'script',success:a,statusCode:{404:function _(){console.log('%c[WS] Server down!','color:red'),$.WS.down=!0,$sidebar.find('.notif-list').on('click','.mark-read',function(a){a.preventDefault(),$.Dialog.fail('Mark notification read','The notification server appears to be down. Please <a class="send-feedback">let us know</a>, and sorry for the inconvenience.')})}}})}var b,c,d,e,f='https://ws.'+location.hostname+':8667/',g=function(a){return function(b){if('string'==typeof b)try{b=JSON.parse(b)}catch(a){}a(b)}},h=!1,i=function(){e.off('click','.mark-read').on('click','.mark-read',function(a){a.preventDefault(),a.stopPropagation();var b=$(this);if(!b.is(':disabled')){var c=b.attr('data-id'),d={read_action:b.attr('data-value')},e=function(){b.css('opacity','.5').disable(),$.post('/notifications/mark-read/'+c,d,$.mkAjaxHandler(function(){if(!this.status)return b.css('opacity','').enable(),$.Dialog.fail('Mark notification as read',this.message)}))};d.read_action?$.Dialog.confirm('Actionable notification','Please confirm your choice: <strong class="color-'+b.attr('class').replace(/^.*variant-(\w+)\b.*$/,'$1')+'">'+b.attr('title')+'</strong>',['Confirm','Cancel'],function(a){a&&($.Dialog.close(),e())}):e()}})},j=function(){c=$sbToggle.children('.notif-cnt'),0===c.length&&(c=$.mk('span').attr({'class':'notif-cnt',title:'New notifications'}).prependTo($sbToggle)),d=$sidebar.children('.notifications'),e=d.children('.notif-list'),i()};a(),$.WS=function(){var c=function(){return a()},d={postUpdates:!1,entryUpdates:!1};return c.down=!1,c.navigate=function(){if('undefined'!=typeof b){var a=location.pathname+location.search+location.hash;b.emit('navigate',{page:a})}},c.recvPostUpdates=function(a){return'undefined'==typeof b?setTimeout(function(){c.recvPostUpdates(a)},2e3):void('boolean'!=typeof a||d.postUpdates===a||b.emit('post-updates',a+'',g(function(b){return b.status?void(d.postUpdates=a,$('#episode-live-update')[d.postUpdates?'removeClass':'addClass']('hidden'),console.log('[WS] %c%s','color:green',b.message)):console.log('[WS] %cpost-updates subscription status change failed (subscribe=%s)','color:red',a)})))},c.recvEntryUpdates=function(a){return'undefined'==typeof b?setTimeout(function(){c.recvEntryUpdates(a)},2e3):void('boolean'!=typeof a||d.entryUpdates===a||b.emit('entry-updates',a+'',g(function(b){return b.status?void(d.entryUpdates=a,$('#entry-live-update')[d.entryUpdates&&'contest'===window.EventType?'removeClass':'addClass']('hidden'),console.log('[WS] %c%s','color:green',b.message)):console.log('[WS] %centry-updates subscription status change failed (subscribe=%s)','color:red',a)})))},c.authme=function(){'undefined'==typeof b||!0==h||(console.log('[WS] %cReconnection needed for identity change','color:teal'),b.disconnect(0),setTimeout(function(){b.connect()},100))},c.unauth=function(){'undefined'==typeof b||!0!=h||b.emit('unauth',null,function(a){return a.status?void(h=!1,console.log('[WS] %cAuthentication dropped','color:brown')):console.log('[WS] %cUnauth failed','color:red')})},c.disconnect=function(a){'undefined'==typeof b||(console.log('[WS] Forced disconnect (reason='+a+')'),b.disconnect(0))},c.status=function(){return'undefined'==typeof b?setTimeout(function(){c.status()},2e3):void b.emit('status',null,g(function(a){console.log('[WS] Status: ID=%s; Name=%s; Rooms=%s',a.User.id,a.User.name,a.rooms.join(','))}))},c.devquery=function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;return'undefined'==typeof b?setTimeout(function(){c.devquery(a,d,e)},2e3):void b.emit('devquery',{what:a,data:d},g(function(a){return'function'==typeof e?e(a):void console.log('[WS] DevQuery '+(a.status?'Success':'Fail'),a)}))},c}()})(),$.Navigation._docReady(),console.log('%cDocument ready handlers called','color:green'),console.groupEnd()}}),$w.on('load',function(){'use strict';$body.removeClass('loading')});
//# sourceMappingURL=/js/min/global.js.map
