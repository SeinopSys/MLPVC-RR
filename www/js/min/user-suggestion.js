"use strict";DocReady.push(function(){var t=$(".pending-reservations");t.on("click","#suggestion",function(e){e.preventDefault();var i=!1;$.Dialog.info("Suggest a reservation",'<p>Feeel like making a vector but don\'t have any screencap in mind? Why not fulfill a request?</p>\n\t\t\t<p>With this tool you can get a random request from the site, and you can choose to reserve it or get a different suggestion. It\'s all up to you.</p>\n\t\t\t<div class="align-center"><button id="suggestion-press" class="btn large orange typcn typcn-lightbulb">Give me a suggestion</button></button>',function(){var e=$("#dialogContent").find("#suggestion-press"),n=$.mk("ul","suggestion-output").insertAfter(e),s=$.mk("div").addClass("notice fail").hide().text("The image apparently failed to load - just click the button again to get a different suggestion.").insertAfter(n),o=$.mk("div").addClass("notice info").hide().html("Loading Fluidbox plugin&hellip;").insertAfter(n),a=function(){$.post("/user/suggestion",$.mkAjaxHandler(function(){if(!this.status)return this.limithit&&(e.disable(),console.log(n),n.remove()),$.Dialog.fail(!1,this.message);var i=$(this.suggestion),o=i.attr("id");i.find("img").on("load",function(){var t=$(this);t.parents(".image").addClass("loaded"),t.parents("a").fluidboxThis()}).on("error",function(){s.show()}),i.find(".reserve-request").on("click",function(){var e=$(this);$.post("/post/reserve-"+o.replace("-","/"),{SUGGESTED:!0},$.mkAjaxHandler(function(){return this.status?(e.replaceWith(this.button),void t.html($(this.pendingReservations).children())):$.Dialog.fail(!1,this.message)}))}),n.html(i)}))};e.on("click",function(t){t.preventDefault(),s.hide(),i?a():(o.show(),n.find(".screencap > a").fluidboxThis(function(){i=!0,o.remove(),a()}))})})})});
//# sourceMappingURL=/js/min/user-suggestion.js.map
