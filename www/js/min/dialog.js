"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();!function(t,e){var i={fail:"red",success:"green",wait:"blue",request:"",confirm:"orange",info:"darkblue"},o={fail:"fail",success:"success",wait:"info",request:"warn",confirm:"caution",info:"info"},n={fail:"Error",success:"Success",wait:"Sending request",request:"Input required",confirm:"Confirmation",info:"Info"},l={fail:"There was an issue while processing the request.",success:"Whatever you just did, it was completed successfully.",wait:"Sending request",request:"The request did not require any additional info.",confirm:"Are you sure?",info:"No message provided."},s=function(){t.Dialog.close()},a=function(){function e(i,o){var n=this;_classCallCheck(this,e),this.label=i,t.each(o,function(t,e){return n[t]=e})}return _createClass(e,[{key:"setLabel",value:function(t){return this.label=t,this}},{key:"setFormId",value:function(t){return this.formid=t,this}}]),e}(),r=function(){function r(){_classCallCheck(this,r),this.$dialogOverlay=t("#dialogOverlay"),this.$dialogContent=t("#dialogContent"),this.$dialogHeader=t("#dialogHeader"),this.$dialogBox=t("#dialogBox"),this.$dialogWrap=t("#dialogWrap"),this.$dialogScroll=t("#dialogScroll"),this.$dialogButtons=t("#dialogButtons"),this._open=this.$dialogContent.length?{}:e,this._CloseButton=new a("Close",{action:s}),this._$focusedElement=e}return _createClass(r,[{key:"isOpen",value:function(){return"object"===_typeof(this._open)}},{key:"_display",value:function(e){var n=this;if("string"!=typeof e.type||"undefined"==typeof i[e.type])throw new TypeError("Invalid dialog type: "+_typeof(e.type));e.content||(e.content=l[e.type]);var s=t.extend({content:l[e.type]},e);s.color=i[e.type];var a=Boolean(this._open),r=t.mk("div").append(s.content),c=a&&"request"===this._open.type&&["fail","wait"].includes(s.type)&&!s.forceNew,d=void 0;if(s.color.length&&r.addClass(s.color),a)if(this.$dialogOverlay=t("#dialogOverlay"),this.$dialogBox=t("#dialogBox"),this.$dialogHeader=t("#dialogHeader"),"string"==typeof s.title&&this.$dialogHeader.text(s.title),this.$dialogContent=t("#dialogContent"),c){d=this.$dialogContent.children(":not(#dialogButtons)").last();var u=d.children(".notice:last-child");u.length?u.show():(u=t.mk("div").append(t.mk("p")),d.append(u)),u.attr("class","notice "+o[s.type]).children("p").html(s.content).show(),this._controlInputs("wait"===s.type)}else this._open=s,this.$dialogButtons=t("#dialogButtons").empty(),this._controlInputs(!0),this.$dialogContent.append(r),s.buttons&&(0===this.$dialogButtons.length&&(this.$dialogButtons=t.mk("div","dialogButtons")),this.$dialogButtons.appendTo(this.$dialogContent));else this._storeFocus(),this._open=s,this.$dialogOverlay=t.mk("div","dialogOverlay"),this.$dialogHeader=t.mk("div","dialogHeader"),"string"==typeof s.title&&this.$dialogHeader.text(s.title),this.$dialogContent=t.mk("div","dialogContent"),this.$dialogBox=t.mk("div","dialogBox"),this.$dialogScroll=t.mk("div","dialogScroll"),this.$dialogWrap=t.mk("div","dialogWrap"),this.$dialogContent.append(r),this.$dialogButtons=t.mk("div","dialogButtons").appendTo(this.$dialogContent),this.$dialogBox.append(this.$dialogHeader).append(this.$dialogContent),this.$dialogOverlay.append(this.$dialogScroll.append(this.$dialogWrap.append(this.$dialogBox))).appendTo($body),$body.addClass("dialog-open");if(c||(this.$dialogHeader.attr("class",s.color?s.color+"-bg":""),this.$dialogContent.attr("class",s.color?s.color+"-border":"")),!c&&s.buttons&&t.each(s.buttons,function(e,i){var o=t.mk("input").attr({type:"button",class:s.color+"-bg"});i.form&&(d=t("#"+i.form),1===d.length&&(o.on("click",function(){d.find("input[type=submit]").first().trigger("click")}),d.prepend(t.mk("input").attr("type","submit").hide()))),o.val(i.label).on("keydown",function(e){if([Key.Enter,Key.Space].includes(e.keyCode))e.preventDefault(),o.trigger("click");else if([Key.Tab,Key.LeftArrow,Key.RightArrow].includes(e.keyCode)){e.preventDefault();var i=n.$dialogButtons.children(),l=i.filter(":focus"),s=n.$dialogContent.find(":input");t.isKey(Key.LeftArrow,e)&&(e.shiftKey=!0),l.length?e.shiftKey?l.prev().length?l.prev().focus():t.isKey(Key.Tab,e)&&(s.length>0?s:i).filter(":visible").last().focus():l.next().length?l.next().focus():t.isKey(Key.Tab,e)&&s.add(i).filter(":visible").first().focus():s.add(i)[e.shiftKey?"last":"first"]().focus()}}).on("click",function(e){e.preventDefault(),t.callCallback(i.action,[e])}),n.$dialogButtons.append(o)}),this._setFocus(),$w.trigger("dialog-opened"),Time.Update(),t.callCallback(s.callback,[d]),a){var f=this.$dialogContent.children(":not(#dialogButtons)").last();c&&(f=f.children(".notice").last()),this.$dialogOverlay.stop().animate({scrollTop:"+="+(f.position().top+parseFloat(f.css("margin-top"),10)+parseFloat(f.css("border-top-width"),10))},"fast")}}},{key:"fail",value:function(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:n.fail,i=arguments.length>1&&arguments[1]!==e?arguments[1]:l.fail,o=arguments.length>2&&arguments[2]!==e&&arguments[2];this._display({type:"fail",title:t,content:i,buttons:[this._CloseButton],forceNew:o})}},{key:"success",value:function(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:n.success,i=arguments.length>1&&arguments[1]!==e?arguments[1]:l.success,o=arguments.length>2&&arguments[2]!==e&&arguments[2],s=arguments.length>3&&arguments[3]!==e?arguments[3]:e;this._display({type:"success",title:t,content:i,buttons:o?[this._CloseButton]:e,callback:s})}},{key:"wait",value:function(){var i=arguments.length>0&&arguments[0]!==e?arguments[0]:n.wait,o=arguments.length>1&&arguments[1]!==e?arguments[1]:l.wait,s=arguments.length>2&&arguments[2]!==e&&arguments[2];this._display({type:"wait",title:i,content:t.capitalize(o)+"&hellip;",forceNew:s})}},{key:"request",value:function(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:n.request,i=arguments.length>1&&arguments[1]!==e?arguments[1]:l.request,o=arguments.length>2&&arguments[2]!==e?arguments[2]:"Submit",r=arguments.length>3&&arguments[3]!==e?arguments[3]:e;"function"==typeof o&&"undefined"==typeof r&&(r=o,o=e);var c=[],d=void 0;if(i instanceof jQuery)d=i.attr("id");else if("string"==typeof i){var u=i.match(/<form\sid=["']([^"']+)["']/);u&&(d=u[1])}o!==!1?(d&&c.push(new a(o,{submit:!0,form:d})),c.push(new a("Cancel",{action:s}))):c.push(new a("Close",{action:s})),this._display({type:"request",title:t,content:i,buttons:c,callback:r})}},{key:"confirm",value:function(){var i=arguments.length>0&&arguments[0]!==e?arguments[0]:n.confirm,o=arguments.length>1&&arguments[1]!==e?arguments[1]:l.confirm,r=this,c=arguments.length>2&&arguments[2]!==e?arguments[2]:["Eeyup","Nope"],d=arguments.length>3&&arguments[3]!==e?arguments[3]:e;"undefined"==typeof d&&(d="function"==typeof c?c:s),t.isArray(c)||(c=["Eeyup","Nope"]);var u=[new a(c[0],{action:function(){d(!0)}}),new a(c[1],{action:function(){d(!1),r._CloseButton.action()}})];this._display({type:"confirm",title:i,content:o,buttons:u})}},{key:"info",value:function(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:n.info,i=arguments.length>1&&arguments[1]!==e?arguments[1]:l.info,o=arguments.length>2&&arguments[2]!==e?arguments[2]:e;this._display({type:"info",title:t,content:i,buttons:[this._CloseButton],callback:o})}},{key:"setFocusedElement",value:function(t){t instanceof jQuery&&(this._$focusedElement=t)}},{key:"_storeFocus",value:function(){if(!("undefined"!=typeof this._$focusedElement&&this._$focusedElement instanceof jQuery)){var i=t(":focus");this._$focusedElement=i.length>0?i.last():e}}},{key:"_restoreFocus",value:function(){"undefined"!=typeof this._$focusedElement&&this._$focusedElement instanceof jQuery&&(this._$focusedElement.focus(),this._$focusedElement=e)}},{key:"_setFocus",value:function(){var t=this.$dialogContent.find("input,select,textarea").filter(":visible"),e=this.$dialogButtons.children();t.length>0?t.first().focus():e.length>0&&e.first().focus()}},{key:"_controlInputs",value:function(t){var e=this.$dialogContent.children(":not(#dialogButtons)").last().add(this.$dialogButtons).find("input, button, select, textarea");t?e.filter(":not(:disabled)").addClass("temp-disable").disable():e.filter(".temp-disable").removeClass("temp-disable").enable()}},{key:"close",value:function(i){return this.isOpen()?(this.$dialogOverlay.remove(),this._open=e,this._restoreFocus(),t.callCallback(i),void $body.removeClass("dialog-open")):t.callCallback(i,!1)}},{key:"clearNotice",value:function(t){var e=this.$dialogContent.children(":not(#dialogButtons)").children(".notice:last-child");return!!e.length&&(!("undefined"!=typeof t&&!t.test(e.html()))&&(e.hide(),e.hasClass("info")&&this._controlInputs(!1),!0))}}]),r}();t.Dialog=new r,$body.on("keydown",function(e){if(!t.Dialog.isOpen()||e.keyCode!==Key.Tab)return!0;var i=t.Dialog.$dialogContent.find(":input"),o=i.filter(e.target),n=i.index(o);if(0===o.length)e.preventDefault(),i.first().focus();else if(e.shiftKey)if(0===n)e.preventDefault(),t.Dialog.$dialogButtons.find(":last").focus();else{var l=o.parent();if(!l.is(t.Dialog.$dialogButtons))return!0;l.children().first().is(o)&&(e.preventDefault(),i.eq(i.index(o)-1).focus())}})}(jQuery);
//# sourceMappingURL=/js/min/dialog.js.map
