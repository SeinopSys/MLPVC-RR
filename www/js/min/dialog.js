'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(a){'use strict';var b={fail:'red',success:'green',wait:'blue',request:'',confirm:'orange',info:'darkblue'},c={fail:'fail',success:'success',wait:'info',request:'warn',confirm:'caution',info:'info'},d={fail:'Error',success:'Success',wait:'Sending request',request:'Input required',confirm:'Confirmation',info:'Info'},e={fail:'There was an issue while processing the request.',success:'Whatever you just did, it was completed successfully.',wait:'Sending request',request:'The request did not require any additional info.',confirm:'Are you sure?',info:'No message provided.'},f=function(){a.Dialog.close()},g=function(){function b(c,d){var e=this;_classCallCheck(this,b),this.label=c,a.each(d,function(a,b){return e[a]=b})}return _createClass(b,[{key:'setLabel',value:function setLabel(a){return this.label=a,this}},{key:'setFormId',value:function setFormId(a){return this.formid=a,this}}]),b}(),h=function(){function h(){_classCallCheck(this,h),this.$dialogOverlay=a('#dialogOverlay'),this.$dialogContent=a('#dialogContent'),this.$dialogHeader=a('#dialogHeader'),this.$dialogBox=a('#dialogBox'),this.$dialogWrap=a('#dialogWrap'),this.$dialogScroll=a('#dialogScroll'),this.$dialogButtons=a('#dialogButtons'),this._open=this.$dialogContent.length?{}:void 0,this._CloseButton=new g('Close',{action:f}),this._$focusedElement=void 0}return _createClass(h,[{key:'isOpen',value:function isOpen(){return'object'===_typeof(this._open)}},{key:'_display',value:function _display(d){var f=this;if('string'!=typeof d.type||'undefined'==typeof b[d.type])throw new TypeError('Invalid dialog type: '+_typeof(d.type));d.content||(d.content=e[d.type]);var g=a.extend({content:e[d.type]},d);g.color=b[d.type];var h,i=!!this._open,j=a.mk('div').append(g.content),k=i&&'request'===this._open.type&&['fail','wait'].includes(g.type)&&!g.forceNew;if(g.color.length&&j.addClass(g.color),!i)this._storeFocus(),this._open=g,this.$dialogOverlay=a.mk('div','dialogOverlay'),this.$dialogHeader=a.mk('div','dialogHeader'),'string'==typeof g.title&&this.$dialogHeader.text(g.title),this.$dialogContent=a.mk('div','dialogContent'),this.$dialogBox=a.mk('div','dialogBox'),this.$dialogScroll=a.mk('div','dialogScroll'),this.$dialogWrap=a.mk('div','dialogWrap'),this.$dialogContent.append(j),this.$dialogButtons=a.mk('div','dialogButtons').appendTo(this.$dialogContent),this.$dialogBox.append(this.$dialogHeader).append(this.$dialogContent),this.$dialogOverlay.append(this.$dialogScroll.append(this.$dialogWrap.append(this.$dialogBox))).appendTo($body),$body.addClass('dialog-open');else if(this.$dialogOverlay=a('#dialogOverlay'),this.$dialogBox=a('#dialogBox'),this.$dialogHeader=a('#dialogHeader'),'string'==typeof g.title&&this.$dialogHeader.text(g.title),this.$dialogContent=a('#dialogContent'),k){h=this.$dialogContent.children(':not(#dialogButtons)').last();var l=h.children('.notice:last-child');l.length?l.show():(l=a.mk('div').append(a.mk('p')),h.append(l)),l.attr('class','notice '+c[g.type]).children('p').html(g.content).show(),this._controlInputs('wait'===g.type)}else this._open=g,this.$dialogButtons=a('#dialogButtons').empty(),this._controlInputs(!0),this.$dialogContent.append(j),g.buttons&&(0===this.$dialogButtons.length&&(this.$dialogButtons=a.mk('div','dialogButtons')),this.$dialogButtons.appendTo(this.$dialogContent));if(k||(this.$dialogHeader.attr('class',g.color?g.color+'-bg':''),this.$dialogContent.attr('class',g.color?g.color+'-border':'')),!k&&g.buttons&&a.each(g.buttons,function(b,c){var d=a.mk('input').attr({type:'button','class':g.color+'-bg'});c.form&&(h=a('#'+c.form),1===h.length&&(d.on('click',function(){h.find('input[type=submit]').first().trigger('click')}),h.prepend(a.mk('input').attr('type','submit').hide()))),d.val(c.label).on('keydown',function(b){if([Key.Enter,Key.Space].includes(b.keyCode))b.preventDefault(),d.trigger('click');else if([Key.Tab,Key.LeftArrow,Key.RightArrow].includes(b.keyCode)){b.preventDefault();var c=f.$dialogButtons.children(),e=c.filter(':focus'),g=f.$dialogContent.find(':input');a.isKey(Key.LeftArrow,b)&&(b.shiftKey=!0),e.length?b.shiftKey?e.prev().length?e.prev().focus():a.isKey(Key.Tab,b)&&(0<g.length?g:c).filter(':visible').last().focus():e.next().length?e.next().focus():a.isKey(Key.Tab,b)&&g.add(c).filter(':visible').first().focus():g.add(c)[b.shiftKey?'last':'first']().focus()}}).on('click',function(b){b.preventDefault(),a.callCallback(c.action,[b])}),f.$dialogButtons.append(d)}),window.WithinMobileBreakpoint()||this._setFocus(),$w.trigger('dialog-opened'),Time.Update(),a.callCallback(g.callback,[h]),i){var m=this.$dialogContent.children(':not(#dialogButtons)').last();k&&(m=m.children('.notice').last()),this.$dialogOverlay.stop().animate({scrollTop:'+='+(m.position().top+parseFloat(m.css('margin-top'),10)+parseFloat(m.css('border-top-width'),10))},'fast')}}},{key:'fail',value:function fail(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.fail,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.fail,c=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._display({type:'fail',title:a,content:b,buttons:[this._CloseButton],forceNew:c})}},{key:'success',value:function success(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.success,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.success,c=2<arguments.length&&void 0!==arguments[2]&&arguments[2],f=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0;this._display({type:'success',title:a,content:b,buttons:c?[this._CloseButton]:void 0,callback:f})}},{key:'wait',value:function wait(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.wait,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.wait,f=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._display({type:'wait',title:b,content:a.capitalize(c)+'&hellip;',forceNew:f})}},{key:'request',value:function request(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.request,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.request,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:'Submit',h=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0;'function'==typeof c&&'undefined'==typeof h&&(h=c,c=void 0);var i,j=[];if(b instanceof jQuery)i=b.attr('id');else if('string'==typeof b){var k=b.match(/<form\sid=["']([^"']+)["']/);k&&(i=k[1])}!1===c?j.push(new g('Close',{action:f})):(i&&j.push(new g(c,{submit:!0,form:i})),j.push(new g('Cancel',{action:f}))),this._display({type:'request',title:a,content:b,buttons:j,callback:h})}},{key:'confirm',value:function confirm(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.confirm,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.confirm,h=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:['Eeyup','Nope'],j=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0;'undefined'==typeof j&&(j='function'==typeof i?i:f),a.isArray(i)||(i=['Eeyup','Nope']);var k=[new g(i[0],{action:function action(){j(!0)}}),new g(i[1],{action:function action(){j(!1),h._CloseButton.action()}})];this._display({type:'confirm',title:b,content:c,buttons:k})}},{key:'info',value:function info(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.info,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.info,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;this._display({type:'info',title:a,content:b,buttons:[this._CloseButton],callback:c})}},{key:'setFocusedElement',value:function setFocusedElement(a){a instanceof jQuery&&(this._$focusedElement=a)}},{key:'_storeFocus',value:function _storeFocus(){if(!('undefined'!=typeof this._$focusedElement&&this._$focusedElement instanceof jQuery)){var b=a(':focus');this._$focusedElement=0<b.length?b.last():void 0}}},{key:'_restoreFocus',value:function _restoreFocus(){'undefined'!=typeof this._$focusedElement&&this._$focusedElement instanceof jQuery&&(this._$focusedElement.focus(),this._$focusedElement=void 0)}},{key:'_setFocus',value:function _setFocus(){var a=this.$dialogContent.find('input,select,textarea').filter(':visible'),b=this.$dialogButtons.children();0<a.length?a.first().focus():0<b.length&&b.first().focus()}},{key:'_controlInputs',value:function _controlInputs(a){var b=this.$dialogContent.children(':not(#dialogButtons)').last().add(this.$dialogButtons).find('input, button, select, textarea');a?b.filter(':not(:disabled)').addClass('temp-disable').disable():b.filter('.temp-disable').removeClass('temp-disable').enable()}},{key:'close',value:function close(b){return this.isOpen()?void(this.$dialogOverlay.remove(),this._open=void 0,this._restoreFocus(),a.callCallback(b),$body.removeClass('dialog-open')):a.callCallback(b,!1)}},{key:'clearNotice',value:function clearNotice(a){var b=this.$dialogContent.children(':not(#dialogButtons)').children('.notice:last-child');return!!b.length&&('undefined'==typeof a||a.test(b.html()))&&(b.hide(),b.hasClass('info')&&this._controlInputs(!1),!0)}}]),h}();a.Dialog=new h,$body.on('keydown',function(b){if(!a.Dialog.isOpen()||b.keyCode!==Key.Tab)return!0;var c=a.Dialog.$dialogContent.find(':input'),d=c.filter(b.target),e=c.index(d);if(0===d.length)b.preventDefault(),c.first().focus();else if(b.shiftKey)if(0===e)b.preventDefault(),a.Dialog.$dialogButtons.find(':last').focus();else{var f=d.parent();if(!f.is(a.Dialog.$dialogButtons))return!0;f.children().first().is(d)&&(b.preventDefault(),c.eq(c.index(d)-1).focus())}});var i=function(){a.Dialog.isOpen()&&window.WithinMobileBreakpoint()&&a.Dialog.$dialogContent.css('margin-top',a.Dialog.$dialogHeader.outerHeight())};$w.on('resize',a.throttle(200,i)).on('dialog-opened',i)})(jQuery);
//# sourceMappingURL=/js/min/dialog.js.map
