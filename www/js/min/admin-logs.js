'use strict';DocReady.push(function(){'use strict';var a=!1,b=$('#filter-form');b.on('submit',function(a){a.preventDefault();var c=b.find('[name="type"] option:selected'),d=c.val(),e=b.find('[name="by"]').val().trim(),f=''+(d.length?c.text().replace('of type ','')+' entries':'')+(e.length?(d.length?'':'entries')+' by '+e:''),g=!!f.length&&b.serialize();b.find('button[type=reset]').attr('disabled',!1===g),!1===g?$.Dialog.success('Navigation','Search terms cleared'):$.Dialog.wait('Navigation','Looking for '+f.replace(/</g,'&lt;')),$.toPage.call({query:g},window.location.pathname.replace(/\d+($|\?)/,'1$1'),!0,!0,!1,function(){return!1===g?document.title.replace(/^.* - (Page \d+)/,'$1'):/^Page \d+/.test(document.title)?f+' - '+document.title:document.title.replace(/^.*( - Page \d+)/,f+'$1')})}).on('reset',function(a){a.preventDefault(),b.find('[name="type"]').val(''),b.find('[name="by"]').val(''),b.triggerHandler('submit')});var c=$('#logs');c.find('tbody').off('page-switch').on('page-switch',function(){$(this).children().each(function(){var c=$(this);c.find('.expand-section').off('click').on('click',function(){var b=$(this);if(b.hasClass('typcn-minus'))b.toggleClass('typcn-minus typcn-plus').next().stop().slideUp();else if(1===b.next().length)b.toggleClass('typcn-minus typcn-plus').next().stop().slideDown();else{if(a)return!1;a=!0,b.removeClass('typcn-minus typcn-plus').addClass('typcn-refresh');var d=parseInt(c.children().first().text()),e=function(){b.addClass('typcn-times color-red').css('cursor','not-allowed').off('click')};$.post('/admin/logs/details/'+d,$.mkAjaxHandler(function(){if(!this.status)return!0===this.unlickable&&b.replaceWith(b.text().trim()),$.Dialog.fail('Log entry details',this.message),e();var a=$.mk('div').attr('class','expandable-section').css('display','none');$.each(this.details,function(b,c){var d,e=$.mk('strong').html(c[0]+': ');'string'==typeof c[2]&&e.addClass('color-'+c[2]),null===c[1]?d=$.mk('em').addClass('color-darkblue').text('empty'):'boolean'==typeof c[1]?d=$.mk('span').addClass('color-'+(c[1]?'green':'red')).text(c[1]?'yes':'no'):$.isArray(c[1])?(d=void 0,e.html(e.html().replace(/:\s$/,''))):d=c[1],a.append($.mk('div').append(e,d))}),a.insertAfter(b).slideDown(),Time.Update(),b.addClass('typcn-minus color-darkblue')})).always(function(){a=!1,b.removeClass('typcn-refresh')}).fail(e)}}),c.find('.server-init').off('click').on('click',function(){b.find('[name="by"]').val($(this).text().trim()),b.triggerHandler('submit')})})}).trigger('page-switch').on('click','.dynt-el',function(){var a=$w.width();if(650<=a)return!0;var b=$(this),c=b.parent(),d=c.parent(),e=d.children('.ip');e.children('a').length&&(e=e.clone(!0,!0),e.children('.self').html(function(){return $(this).text()}));var f=e.contents(),g=$.mk('span').attr('class','modal-ip').append('<br><b>Initiator:</b> ',f.eq(0));1<f.length&&g.append('<br><b>IP Address:</b> '+f.get(2).textContent),$.Dialog.info('Hidden details of entry #'+d.children('.entryid').text(),$.mk('div').append('<b>Timestamp:</b> '+c.children('time').html().trim().replace(/<br>/,' '),g))});var d=[{className:'darkblue',showins:!0,showdel:!0,title:'diff'},{className:'green',showins:!0,showdel:!1,title:'new'},{className:'red',showins:!1,showdel:!0,title:'old'}];c.on('click contextmenu','.btn.view-switch',function(a){var b='contextmenu'===a.type;if(b&&a.shiftKey)return!0;a.preventDefault();for(var c=$(a.target),e=c.next(),f=c.attr('class').match(/\b(darkblue|green|red)\b/)[1],g=void 0,h=0;h<d.length;h++)d[h].className===f&&(g=d[h+(b?-1:1)]);'undefined'==typeof nextState&&(nextState=d[b?d.length-1:0]),$diffWrap.find('ins')[nextState.showins?'show':'hide'](),$diffWrap.find('del')[nextState.showdel?'show':'hide'](),$diffWrap[nextState.showins&&nextState.showdel?'removeClass':'addClass']('no-colors'),$diffWrap[0===$diffWrap.contents().filter(function(){return!/^(del|ins)$/.test(this.nodeName.toLowerCase())||'none'!==this.style.display}).length?'addClass':'removeClass']('empty'),$btn.removeClass(state).addClass(nextState.className).text(nextState.title)})});
//# sourceMappingURL=/js/min/admin-logs.js.map
