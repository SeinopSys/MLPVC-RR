"use strict";!function(){var t=/Page \d+/g,a=location.pathname.replace(/\/\d+$/,"")+"/",e=$(".pagination"),n="Navigation",i=$.mk("form").attr("id","goto-page").html('<label>\n\t\t\t\t<span>Enter page number</span>\n\t\t\t\t<input type="number" min="1" step="1" class="large-number-input">\n\t\t\t</label>').on("submit",function(t){t.preventDefault();var e=parseInt($(this).find("input:visible").val(),10);e=isNaN(e)?1:Math.max(1,e),$.Dialog.wait("Navigation","Loading page "+e),$.toPage(a+e).then(function(){$.Dialog.close()})});function o(t){if(void 0===t){var a=window.location.pathname.split("/"),e=1;if(a.length>1){var n=a[a.length-1];isNaN(n)||(e=parseInt(n,10))}return{pageNumber:e,maxPages:null}}return{pageNumber:parseInt(t.children("li").children("strong").text(),10),maxPages:parseInt(t.children(":not(.spec)").last().text(),10)}}function r(){e.removeClass("loading").find(".loading").removeClass("loading")}$d.off("paginate-refresh").on("paginate-refresh",function(){a=location.pathname.replace(/\/\d+$/,"")+"/",e=$(".pagination"),n="Navigation",e.off("click").on("click","a",function(t){t.preventDefault(),t.stopPropagation(),$("#ctxmenu").hide();var a=$(this);if(void 0===a.attr("href")){var e=o(a.closest(".pagination"));return $.Dialog.request("Navigation",i.clone(!0,!0),"Go to page",function(t){t.find("input:visible").attr("max",e.maxPages).val(e.pageNumber).get(0).select()})}a.closest("li").addClass("loading"),$.toPage(this.pathname)}),$w.off("nav-popstate").on("nav-popstate",function(t,a,e){var n=a,i=[!1,!0,void 0,!0];void 0!==a.baseurl&&$.Navigation._lastLoadedPathname.replace(/\/\d+($|\?)/,"$1")!==a.baseurl?e(location.pathname+location.search+location.hash,function(){$.toPage.apply(n,i)}):$.toPage.apply(n,i)}),$.toPage=function(i,l,s,p,g){i||(i=location.pathname);var c=parseInt(i.replace(/^.*\/(\d+)(?:\?.*)?$/,"$1"),10),u=this.state||{};if(isNaN(c))return $.Dialog.fail(n,"Could not get page number to go to");var h=o();if(!s&&(h.pageNumber===c||h.pageNumber===u.page)&&location.pathname===i)return!l&&$.Dialog.fail(n,"You are already on page "+h.pageNumber);var f={paginate:!0},d=[],m=this.query,v="string"==typeof m;return v?d=d.concat(m.split("&")):location.search.length>1&&(d=d.concat(location.search.substring(1).split("&"))),d.length&&$.each(d,function(t,a){"string"==typeof(a=a.replace(/\+/g," ").split("="))[1]&&0!==a[1].length&&(f[decodeURIComponent(a[0])]=decodeURIComponent(a[1]))}),this.btnl?f.btnl=!0:e.addClass("loading"),i+=location.hash,new Promise(function(o,l){$.get(i,f,$.mkAjaxHandler(function(){if(!this.status)return r(),$.Dialog.fail(n,this.message);if(this.goto)return r(),$.Navigation.visit(this.goto);c=parseInt(this.page,10),"function"==typeof g&&(document.title=g(c)),document.title=document.title.replace(t,"Page "+c);var i=this.request_uri||a+c+(location.search.length>1?location.search:""),l=[{paginate:!0,page:c,baseurl:this.request_uri.replace(/\/\d+($|\?)/,"$1")},"",i];v&&(l[0].query=m),"function"==typeof window.ga&&window.ga("send",{hitType:"pageview",page:i,title:document.title}),(!0===p||u.page!==c&&!isNaN(c)||v)&&(history.replaceState.apply(history,l),$.WS.navigate()),e.filter('[data-for="'+this.for+'"]').html(this.pagination);var s=jQuery.Event("page-switch");$(this.update).html(this.output).trigger(s),Time.Update(),r(),o()})).fail(function(){r(),l()})})}})}();
//# sourceMappingURL=/js/min/paginate.js.map
