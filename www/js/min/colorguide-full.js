"use strict";DocReady.push(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$content.find("img[data-src]"),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=e.eq(a);if(0!==n.length){var l=n.attr("data-src"),i=new Image;i.src=l,$(i).on("load",function(){n.css("opacity",0).attr("src",l).removeAttr("data-src").animate({opacity:1},300),t(e,a+1)})}else $.callCallback(r)}var e=$("#sort-by"),a=$("#full-list"),r=$("#guide-reorder"),n=$("#guide-reorder-cancel");e.on("change",function(){var t=e.data("baseurl"),n=e.val(),l=(t+"?ajax&"+n).replace(/&$/,""),i=(t+"?"+n).replace(/\?$/,"");$.Dialog.wait("Changing sort order"),$.get(l,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);a.html(this.html),$w.triggerHandler("scroll"),r.attr("disabled",Boolean(n.length)),history.replaceState(history.state,"",i),$.Dialog.close()}))});var l=a.find("section > ul");window._cgFullListOnScroll=$.throttle(100,function(){0!==l.length?l.each(function(){var e=$(this);e.isInViewport()&&t(e.find("img[data-src]"),0,function(){e.addClass("loaded"),a.find("section > ul:not(.loaded)")})}):$w.off("scroll",window._cgFullListOnScroll)}),$w.on("scroll",window._cgFullListOnScroll),$w.triggerHandler("scroll"),"function"==typeof window.Sortable&&(a.on("click",".sort-alpha",function(){var t=$(this).closest("section").children("ul");t.children().sort(function(t,e){return $(t).text().trim().localeCompare($(e).text().trim())}).appendTo(t)}),r.on("click",function(){if(r.hasClass("typcn-tick")){$.Dialog.wait("Re-ordering appearances");var t=[];a.children().children("ul").children().each(function(){t.push($(this).children().attr("data-href").split("/").pop().replace(/^(\d+)\D.*$/,"$1"))}),$.post("/cg/full/reorder",{list:t.join(",")},$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);a.removeClass("sorting").html(this.html),$w.triggerHandler("scroll"),r.removeClass("typcn-tick green").addClass("typcn-arrow-unsorted darkblue").html("Re-order"),$.Dialog.close()}))}else r.removeClass("typcn-arrow-unsorted darkblue").addClass("typcn-tick green").html("Save"),a.addClass("sorting").children().each(function(){var t=$(this).children("ul");t.children().each(function(){var t=$(this);t.data("orig-index",t.index())}).children().moveAttr("href","data-href"),t.data("sortable-instance",new Sortable(t.get(0),{ghostClass:"moving",animation:300}))}),$(".sort-alpha").show(),n.removeClass("hidden")}),n.on("click",function(){r.removeClass("typcn-tick green").addClass("typcn-arrow-unsorted darkblue").html("Re-order"),a.removeClass("sorting").children().each(function(){var t=$(this).children("ul");t.children().sort(function(t,e){return t=$(t).data("orig-index"),e=$(e).data("orig-index"),t>e?1:t<e?-1:0}).appendTo(t).removeData("orig-index").children().moveAttr("data-href","href"),t.data("sortable-instance").destroy(),t.removeData("sortable-instance")}),$(".sort-alpha").hide(),n.addClass("hidden")}))},function(){$w.off("scroll",window._cgFullListOnScroll)});
//# sourceMappingURL=/js/min/colorguide-full.js.map
