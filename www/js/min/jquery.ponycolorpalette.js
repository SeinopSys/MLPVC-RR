"use strict";var _createClass=function(){function o(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,a){return e&&o(t.prototype,e),a&&o(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(l){var r="pony-color-palette",e={},n=function(){function a(t,e,o){var r=this;_classCallCheck(this,a),this.appearanceId=t,this.shown=!1,this.colorData=null,this.getColorData(),this.$picker=l.mk("div").attr("class","hidden pony-color-palette").appendTo($body),this.$swatchBox=l.mk("div").attr("class","swatchbox loading").appendTo(this.$picker),this.$nullColor=l.mk("li").attr("class","color color-null selected").append(l.mk("span").attr("title","Default").text(e)),l.mk("ul").attr("class","colorgroup").append(this.$nullColor).appendTo(this.$swatchBox),this.$picker.on("click",".color",function(t){t.stopPropagation();var e=l(t.target).closest(".color"),a=e.children().text();r.$picker.find(".color.selected").removeClass("selected"),e.addClass("selected"),o(0<a.length?a:null),r.hide(!0)})}return _createClass(a,[{key:"displayError",value:function(t){this.$swatchBox.html(l.mk("p").attr("class","error").text(t))}},{key:"getColorData",value:function(){var t=this;void 0===e[this.appearanceId]?(e[this.appearanceId]=[this],l.post("/cg/colorgroup/list/"+this.appearanceId+"?hex",l.mkAjaxHandler(function(a){if(!a.status)return t.displayError(a.message);l.each(e[t.appearanceId],function(t,e){e.fillSwatchBox(a.list)})}))):e[this.appearanceId].push(this)}},{key:"fillSwatchBox",value:function(t){var o=this;this.$swatchBox.removeClass("loading").children().first().nextAll().remove(),l.each(t,function(t,e){var a=l.mk("ul").attr("class","colorgroup").appendTo(o.$swatchBox);a.append(l.mk("li").attr({title:e.label,class:"color group-icon"})),l.each(e.colors,function(t,e){a.append(l.mk("li").attr("class","color").append(l.mk("span").attr("title",e.label).css("background-color",e.hex).text(e.hex)))})})}},{key:"display",value:function(t){l(".pony-color-palette").addClass("hidden");var e=l(t.target),a=e.offset(),o=a.top,r=a.left;return o+=e.outerHeight(),this.$picker.css({top:o,left:r}).removeClass("hidden"),this}},{key:"hide",value:function(){return(0<arguments.length&&void 0!==arguments[0]&&arguments[0]||!this.$picker.is(":hover"))&&this.$picker.addClass("hidden"),this}},{key:"selectColor",value:function(t){this.$picker.find(".color").removeClass("selected").filter(function(){return l(this).text()===t}).addClass("selected")}}]),a}();l.fn.ponyColorPalette=function(t,a,o){return this.each(function(){var e=l(this);e.data(r,new n(t,a,function(t){o(e,t)})),e.on("focus",function(t){l(t.target).data(r).display(t)}),e.on("keydown",function(t){l.isKey(Key.Escape,t)&&(t.preventDefault(),l(t.target).data(r).hide())}),e.on("blur",function(t){l(t.target).data(r).hide()})}),this}}(jQuery);
//# sourceMappingURL=/js/min/jquery.ponycolorpalette.js.map
