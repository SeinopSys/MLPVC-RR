"use strict";$(function(){var r=$("#sort-by"),n=$("#full-list"),i=$("#guide-reorder"),t=$("#guide-reorder-cancel"),a=window.EQG?"?eqg":"";r.on("change",function(){var e=r.data("baseurl"),t=r.val(),a=(e+"?ajax&"+t).replace(/&$/,"");$.Dialog.wait("Changing sort order"),$.get(a,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);n.html(this.html),o(),i.attr("disabled",Boolean(t.length)),history.replaceState(history.state,"",this.stateUrl),$.Dialog.close()}))});var s=new IntersectionObserver(function(e){e.forEach(function(e){if(e.isIntersecting){var t=e.target;s.unobserve(t);var a=t.dataset.src,r=new Image;r.src=a,$(r).on("load",function(){$(t).css("opacity",0).attr("src",a).removeAttr("data-src").animate({opacity:1},300)})}})});function o(){n.find("section > ul img[data-src]").each(function(e,t){return s.observe(t)})}o(),"function"==typeof window.Sortable&&(n.on("click",".sort-alpha",function(){var e=$(this).closest("section").children("ul");e.children().sort(function(e,t){return $(e).text().trim().localeCompare($(t).text().trim())}).appendTo(e)}),i.on("click",function(){if(i.hasClass("typcn-tick")){$.Dialog.wait("Re-ordering appearances");var e=[];n.children().children("ul").children().each(function(){e.push($(this).children().attr("data-href").split("/").pop().replace(/^(\d+)\D.*$/,"$1"))}),$.post("/cg/full/reorder"+a,{list:e.join(",")},$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);n.removeClass("sorting").html(this.html),o(),i.removeClass("typcn-tick green").addClass("typcn-arrow-unsorted darkblue").html("Re-order"),t.addClass("hidden"),$.Dialog.close()}))}else i.removeClass("typcn-arrow-unsorted darkblue").addClass("typcn-tick green").html("Save"),n.addClass("sorting").children().each(function(){var e=$(this).children("ul");e.children().each(function(){var e=$(this);e.data("orig-index",e.index())}).children().moveAttr("href","data-href"),e.data("sortable-instance",new Sortable(e.get(0),{ghostClass:"moving",animation:300}))}),$(".sort-alpha").add(t).removeClass("hidden")}),t.on("click",function(){i.removeClass("typcn-tick green").addClass("typcn-arrow-unsorted darkblue").html("Re-order"),n.removeClass("sorting").children().each(function(){var e=$(this).children("ul");e.children().sort(function(e,t){return e=$(e).data("orig-index"),(t=$(t).data("orig-index"))<e?1:e<t?-1:0}).appendTo(e).removeData("orig-index").children().moveAttr("data-href","href"),e.data("sortable-instance").destroy(),e.removeData("sortable-instance")}),$(".sort-alpha").add(t).addClass("hidden")}))});
//# sourceMappingURL=/js/min/pages/colorguide/full-list.js.map
