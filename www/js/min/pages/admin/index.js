"use strict";$(function(){function t(){$(".post-deviation-promise").each(function(t,i){return e.observe(i)}),$(".post-image-promise").each(function(t,e){return i.observe(e)}),$(".user-avatar-promise").each(function(t,e){return a.observe(e)})}!function(){function e(e){e=e.replace(/<img[^>]+>/g,"").match(a);var s={};$.each(e,function(t,e){var i=e.match(n);if(i&&void 0===s[i[1]])s[i[1]]=!0;else if(i=e.match(o)){var a=parseInt(i[1],36);void 0===s[a]&&(s[a]=!0)}});var r=Object.keys(s);if(!r)return $.Dialog.fail("No deviations found on the pasted page.");$.Dialog.wait("Bulk approve posts","Attempting to approve "+r.length+" post"+(1!==r.length?"s":"")),$.post("/admin/mass-approve",{ids:r.join(",")},$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);this.html&&(i.html(this.html),t()),this.message?$.Dialog.success(!1,this.message,!0):$.Dialog.close()}))}$("#bulk-how").on("click",function(){$.Dialog.info("How to approve posts in bulk",'<p>This tool is easier to use than you would think. Here\'s how it works:</p>\n\t\t\t\t<ol>\n\t\t\t\t\t<li>\n\t\t\t\t\t\tIf you have the group watched, visit <a href="http://www.deviantart.com/notifications/#view=groupdeviations%3A17450764" target="_blank" rel=\'noopener\'>this link</a><br>\n\t\t\t\t\t\tIf not, go to the <a href="http://mlp-vectorclub.deviantart.com/messages/?log_type=1&instigator_module_type=0&instigator_roleid=1276365&instigator_username=&bpp_status=4&display_order=desc" target="_blank" rel=\'noopener\'>Processed Deviations queue</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>Once there, press <kbd>Ctrl</kbd><kbd>A</kbd> (which will select the entire page)</li>\n\t\t\t\t\t<li>Now press <kbd>Ctrl</kbd><kbd>C</kbd> (copying the selected content)</li>\n\t\t\t\t\t<li>Return to this page and click into the box below (you should see a blinking cursor afterwards)</li>\n\t\t\t\t\t<li>Hit <kbd>Ctrl</kbd><kbd>V</kbd></li> (to paste what you just copied)\n\t\t\t\t\t<li>Repeat these steps if there are multiple pages of results.</li>\n\t\t\t\t</ol>\n\t\t\t\t<p>The script will look for any deviation links in the HTML code of the page, which it then sends over to the server to mark them as approved if they were used to finish posts on the site.</p>')}),$(".mass-approve").children(".textarea").on("paste",function(t){var i=void 0,a=void 0,n=void 0;if(t.originalEvent.clipboardData&&t.originalEvent.clipboardData.types&&t.originalEvent.clipboardData.getData&&((i=t.originalEvent.clipboardData.types)instanceof DOMStringList&&i.contains("text/html")||i.indexOf&&-1!==i.indexOf("text/html")))return a=t.originalEvent.clipboardData.getData("text/html"),e(a),t.stopPropagation(),t.preventDefault(),!1;for(n=document.createDocumentFragment();this.childNodes.length>0;)n.appendChild(this.childNodes[0]);return function t(i,a){if(i.childNodes&&i.childNodes.length>0){var n=i.innerHTML;i.innerHTML="",i.appendChild(a),e(n)}else setTimeout(function(){t(i,a)},20)}(this,n),!0});var i=$(".recent-posts ul"),a=/(?:[A-Za-z\-\d]+\.)?deviantart\.com\/art\/(?:[A-Za-z\-\d]+-)?(\d+)|fav\.me\/d([a-z\d]{6,})/g,n=/\/(?:[A-Za-z\-\d]+-)?(\d+)$/,o=/fav\.me\/d([a-z\d]{6,})/}();var e=new IntersectionObserver(function(t){t.forEach(function(t){if(t.isIntersecting){var i=t.target;e.unobserve(i);var a=i.dataset.post.replace("-","/"),n=i.dataset.viewonly;$.get("/post/lazyload/"+a,{viewonly:n},$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail("Cannot load "+a.replace("/"," #"),this.message);$.loadImages(this.html).then(function(t){$(i).closest(".image").replaceWith(t)})}))}})}),i=new IntersectionObserver(function(t){t.forEach(function(t){if(t.isIntersecting){var i=t.target;e.unobserve(i);var a=$.mk("a"),n=new Image;n.src=i.dataset.src,a.attr("href",i.dataset.href).append(n),$(n).on("load",function(){$(i).closest(".image").html(a)})}})}),a=new IntersectionObserver(function(t){t.forEach(function(t){if(t.isIntersecting){var e=t.target;a.unobserve(e);var i=new Image;i.src=e.dataset.src,i.classList="avatar",$(i).on("load",function(){$(e).replaceWith(i)})}})});t()});
//# sourceMappingURL=/js/min/pages/admin/index.js.map
