"use strict";$(function(){var e=!1,t=$("#filter-form");t.on("reset",function(e){e.preventDefault(),t.find('[name="type"]').val(""),t.find('[name="by"]').val(""),t.trigger("submit")});var s=$("#logs");s.find("tbody").off("page-switch").on("click",".expand-section",function(){var t=$(this);if(t.hasClass("typcn-minus"))t.toggleClass("typcn-minus typcn-plus").next().stop().slideUp();else if(1===t.next().length)t.toggleClass("typcn-minus typcn-plus").next().stop().slideDown();else{if(e)return!1;e=!0,t.removeClass("typcn-minus typcn-plus").addClass("typcn-refresh");var s=parseInt(t.closest("td").siblings().first().text()),n=function(){t.addClass("typcn-times color-red").css("cursor","not-allowed").off("click")};$.post("/admin/logs/details/"+s,$.mkAjaxHandler(function(){if(!this.status)return!0===this.unclickable&&t.replaceWith(t.text().trim()),$.Dialog.fail("Log entry details",this.message),n();var e=$.mk("div").attr("class","expandable-section").css("display","none");$.each(this.details,function(t,s){var n=void 0,i=$.mk("strong").html(s[0]+": ");"string"==typeof s[2]&&i.addClass("color-"+s[2]),null===s[1]?n=$.mk("em").addClass("color-darkblue").text("empty"):"boolean"==typeof s[1]?n=$.mk("span").addClass("color-"+(s[1]?"green":"red")).text(s[1]?"yes":"no"):$.isArray(s[1])?(n=void 0,i.html(i.html().replace(/:\s$/,""))):n=s[1],e.append($.mk("div").append(i,n))}),e.insertAfter(t).slideDown(),Time.Update(),t.addClass("typcn-minus color-darkblue")})).always(function(){e=!1,t.removeClass("typcn-refresh")}).fail(n)}}).on("click",".server-init",function(){t.find('[name="by"]').val($(this).text().trim()),t.trigger("submit")}).on("click",".search-ip",function(){var e=$(this);t.find('[name="by"]').val(e.hasClass("your-ip")?"my IP":e.siblings(".address").text().trim()),t.trigger("submit")}).on("click",".search-user",function(){var e=$(this);t.find('[name="by"]').val(e.hasClass("your-name")?"me":e.siblings(".name").text().trim()),t.trigger("submit")}).on("click",".dynt-el",function(){if($w.width()>=650)return!0;var e=$(this).parent(),t=e.parent(),s=t.children(".ip");s.children("a").length&&(s=s.clone(!0,!0)).children(".self").html(function(){return $(this).text()});var n=s.contents(),i=$.mk("span").attr("class","modal-ip").append("<br><b>Initiator:</b> ",n.eq(0));n.length>1&&i.append("<br><b>IP Address:</b> "+n.get(2).textContent),$.Dialog.info("Hidden details of entry #"+t.children(".entryid").text(),$.mk("div").append("<b>Timestamp:</b> "+e.children("time").html().trim().replace(/<br>/," "),i))});var n=[{className:"darkblue",showins:!0,showdel:!0,title:"diff"},{className:"green",showins:!0,showdel:!1,title:"new"},{className:"red",showins:!1,showdel:!0,title:"old"}];s.on("click contextmenu",".btn.view-switch",function(e){var t="contextmenu"===e.type;if(t&&e.shiftKey)return!0;e.preventDefault();for(var s=$(e.target),i=s.next(),a=s.attr("class").match(/\b(darkblue|green|red)\b/)[1],l=void 0,r=0;r<n.length;r++)n[r].className===a&&(l=n[r+(t?-1:1)]);void 0===l&&(l=n[t?n.length-1:0]),i.find("ins")[l.showins?"show":"hide"](),i.find("del")[l.showdel?"show":"hide"](),i[l.showins&&l.showdel?"removeClass":"addClass"]("no-colors"),i[0===i.contents().filter(function(){return!/^(del|ins)$/.test(this.nodeName.toLowerCase())||"none"!==this.style.display}).length?"addClass":"removeClass"]("empty"),s.removeClass(a).addClass(l.className).text(l.title)})});
//# sourceMappingURL=/js/min/pages/admin/log.js.map
