"use strict";$(function(){var t=window.username;$("#recalc-button").on("click",function(e){e.preventDefault(),$.Dialog.confirm("Recalculate PCG slot history","<p>This will wipe all PCG slot history related to "+t+" and recalculate the slots based on the currently available data.</p>\n\t\t\t<p>If they had slot gains disabled in the past this will not take that into account.</p>\n\t\t\t<p>Are you sure you want to proceed with the recalculation?</p>",function(e){e&&($.Dialog.wait(!1,"Recalculating"),$.post("/@"+t+"/cg/point-history/recalc",$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);$.Navigation.reload(!0)})))})}),$("#pending-gifts-button").on("click",function(e){e.preventDefault(),$.Dialog.wait("Pending gifts for "+t,"Checking for pending gifts"),$.post("/user/pending-gifts/"+t,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);if(!this.pendingGifts)return $.Dialog.info(!1,this.message);var e=$.mk("tbody"),n=$.mk("table").append('<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>From</th>\n\t\t\t\t\t\t\t<th>Amount</th>\n\t\t\t\t\t\t\t<th>Sent</th>\n\t\t\t\t\t\t\t<th class="refund">Refund?</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>',e),a=$.mk("form","refund-gifts-form").append("<p>Here you can select specific gifts that "+t+" hasn't claimed yet and are available to be refunded.</p>","<p>You should generally avoid refunding anything that's less than 2 weeks old unless you're absolute certain that "+t+" won't be able to accept or reject the gift themselves within that timeframe.</p>",$.mk("div").append(n));$.each(this.pendingGifts,function(t,n){var a;e.append($.mk("tr").append("<td>"+n.from+"</td>\n\t\t\t\t\t\t<td>"+n.amount+"</td>\n\t\t\t\t\t\t<td>"+n.sent+"</td>",(a=n,$.mk("td").attr("class","refund unselected").append($.mk("input").attr({type:"checkbox",value:a.id}).on("change click",function(t){var e=$(t.target).closest("td");e.removeClass(t.target.checked?"unselected":"selected"),e.addClass(t.target.checked?"selected":"unselected")})).on("click",function(t){"td"===t.target.nodeName.toLowerCase()&&t.target.childNodes[0].click()}))))}),$.Dialog.request(!1,a,"Refund selected",function(t){t.on("submit",function(e){e.preventDefault();var n=[];if(t.find("input:checked").each(function(t,e){n.push(e.value)}),0===n.length)return $.Dialog.fail(!1,"You have to select at least one gift");$.Dialog.wait(!1,"Refunding selected gifts"),$.post("/user/refund-gifts",{giftids:n.join(",")},$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(!1,this.message);$.Dialog.success(!1,this.message,!0)}))})})}))})});
//# sourceMappingURL=/js/min/pages/user/pcgslots.js.map
