"use strict";$(function(){if(void 0!==window.ROLES){var e=$content.children(".briefing"),t=e.find(".username").text().trim(),n=e.find(".rolelabel").text().trim(),i=$.mk("form").attr("id","rolemod").html('<select name="newrole" required><optgroup label="Possible roles"></optgroup></select>'),a=i.find("optgroup"),o=$("#ban-toggle"),s=$("#change-role");$.each(window.ROLES,function(e,t){a.append("<option value="+e+">"+t+"</option>")}),s.on("click",function(){$.Dialog.request("Change group",i.clone(),"Change",function(e){var i=e.find("option").filter(function(){return this.innerHTML===n}).attr("selected",!0);e.on("submit",function(n){if(n.preventDefault(),e.children("select").val()===i.attr("value"))return $.Dialog.close();var a=e.mkData();$.Dialog.wait(!1,"Moving user to the new group"),$.post("/user/setgroup/"+t,a,$.mkAjaxHandler(function(){return!0===this.already_in?$.Dialog.close():this.status?void $.Navigation.reload(!0):$.Dialog.fail(!1,this.message)}))})})}),o.on("click",function(){var e=(o.hasClass("un-banish")?"Un-ban":"Ban")+"ish",n=e.toLowerCase(),i=e+"ing "+t+("banish"===n?" to the moon":"");$.Dialog.request(i,$.mk("form",n+"-form").html("<p>"+e+"ing "+t+" will "+("banish"===n?"immediately sign them out of every session and won’t allow them to log in again. Please, only do this if it’s absolutely necessary.":"allow them to sign in to the site again.")+"</p>\n\t\t\t\t<p>You must provide a reason (5-255 chars.) for the "+n.replace(/ish$/,"")+' which will be added to the log entry and appear in the user’s banishment history.</p>\n\t\t\t\t<input type="text" name="reason" placeholder="Enter a reason" required pattern="^.{5,255}$" value="'+e+'ing because ">\n\t\t\t\t'+("banish"===n?'<img src="/img/pre-ban.svg" alt="Sad twilight">':"")),e,function(e){e.on("submit",function(e){e.preventDefault();var a=$(this).mkData();$.Dialog.wait(!1,"Gathering the Elements of Harmony"),$.post("/user/"+n+"/"+t,a,$.mkAjaxHandler(function(){if(!this.status)return $.Dialog.fail(i,this.message);var e=this.message;"banish"===n&&(e='<p>What had to be done, has been done.</p><img src="/img/post-ban.svg">'),$.DIalog.segway(i,e)}))})})})}});
//# sourceMappingURL=/js/min/pages/user/manage.js.map
