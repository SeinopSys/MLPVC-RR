{"version":3,"sources":["dyntime.js"],"names":["$","timeDifference","now","timestamp","substract","getTime","d","past","time","Math","abs","target","day","floor","one","hour","minute","second","week","month","year","createTimeStr","delta","str","console","groupCollapsed","i","toISOString","log","each","order","_","unit","value","left","groupEnd","startval","window","DT_START","timePad","isNaN","parseInt","toString","months","undefined","weekdays","dateformat","orderwd","date","postfix","lastDigit","weekday","wd","m","y","update","filter","getFullDate","fulldate","replace","k","$this","this","attr","Date","TypeError","Error","hasClass","addClass","getDate","getFullYear","mo","getMonth","getDay","h","getHours","mi","getMinutes","s","getSeconds","timestr","$elapsedHolder","parent","children","updateHandler","data","result","diff","length","html","getTimeDiff","apply","arguments","updateTimesF","noAutoUpdateTimes","updateTimes","setInterval","jQuery"],"mappings":"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","file":"dyntime.min.js","sourcesContent":["(function($){\r\n\tvar startval = window.DT_START || 'just now';\r\n\tvar timePad = function(i){if(!isNaN(i)){i=parseInt(i);if (i<10&&i>=0)i='0'+i;else if(i<0)i='-0'+Math.abs(i);else i=i.toString()}return i};\r\n\tvar months = [ undefined,\r\n\t\t\"Januaray\",\r\n\t\t\"February\",\r\n\t\t\"March\",\r\n\t\t\"April\",\r\n\t\t\"May\",\r\n\t\t\"June\",\r\n\t\t\"July\",\r\n\t\t\"August\",\r\n\t\t\"September\",\r\n\t\t\"October\",\r\n\t\t\"November\",\r\n\t\t\"December\"\r\n\t];\r\n\tvar weekdays = [\r\n\t\t\"Sunday\",\r\n\t\t\"Monday\",\r\n\t\t\"Tuesday\",\r\n\t\t\"Wednesday\",\r\n\t\t\"Thursday\",\r\n\t\t\"Friday\",\r\n\t\t\"Saturday\"\r\n\t];\r\n\tvar dateformat = {\r\n\t\torderwd: '{{wd}}, {{d}} {{mo}}, {{y}} {{h}}:{{mi}}:{{s}}',\r\n\t\torder: '{{d}} {{mo}} {{y}}, {{h}}:{{mi}}:{{s}}',\r\n\t\tday: function(date){\r\n\t\t\tvar lastDigit = date % 10,\r\n\t\t\t\tpostfix;\r\n\t\t\tif (lastDigit == 0 || lastDigit > 3 || date == 11 || date == 12) postfix = 'th';\r\n\t\t\telse if (lastDigit == 1) postfix = 'st';\r\n\t\t\telse if (lastDigit == 2) postfix = 'nd';\r\n\t\t\telse if (lastDigit == 3) postfix = 'rd';\r\n\t\t\treturn date.toString() + postfix;\r\n\t\t},\r\n\t\tweekday: function(wd){ return weekdays[parseInt(wd)] },\r\n\t\tmonth: function(m){ return months[parseInt(m)] },\r\n\t\tyear: function(y){ return y },\r\n\t};\r\n\tvar timeparts = function(unit, num){\r\n\t\treturn num+' '+unit+(num>1?'s':'');\r\n\t};\r\n\tvar update = function(){\r\n\t\t$('time').filter(':not(.nodt)').each(function(){\r\n\t\t\tvar $this = $(this),\r\n\t\t\t\tdate = $this.attr('datetime'),\r\n\t\t\t\ttimestamp = new Date(date);\r\n\t\t\tif (typeof date !== 'string') throw new TypeError('Invalid date data type: \"'+(typeof date)+'\"');\r\n\t\t\tif (isNaN(timestamp.getTime())){\r\n\t\t\t\tconsole.log(this);\r\n\t\t\t\tthrow new Error('Invalid date format: \"'+date+'\"');\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tif (!$this.hasClass('dynt')) $this.addClass('dynt');\r\n\t\t\t\r\n\t\t\tdate = {\r\n\t\t\t\td: dateformat.day(timestamp.getDate()),\r\n\t\t\t\ty: dateformat.year(timestamp.getFullYear()),\r\n\t\t\t\tmo: dateformat.month(timestamp.getMonth()+1),\r\n\t\t\t\twd: dateformat.weekday(timestamp.getDay()),\r\n\t\t\t\th: timePad(timestamp.getHours()),\r\n\t\t\t\tmi: timePad(timestamp.getMinutes()),\r\n\t\t\t\ts: timePad(timestamp.getSeconds()),\r\n\t\t\t\torder: dateformat.order,\r\n\t\t\t\torderwd: dateformat.orderwd,\r\n\t\t\t};\r\n\r\n\t\t\tfunction getFullDate(fulldate){\r\n\t\t\t\treturn fulldate.replace(/\\{\\{([a-z]{1,2})}}/g,function(_,k){\r\n\t\t\t\t\treturn date[k];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar timestr = createTimeStr(new Date,timestamp),\r\n\t\t\t\t$elapsedHolder = $this.parent().children('.dynt-el'),\r\n\t\t\t\tupdateHandler = $this.data('dyntime-beforeupdate');\r\n\r\n\t\t\tif (typeof updateHandler === 'function'){\r\n\t\t\t\tvar result = updateHandler(diff);\r\n\t\t\t\tif (result === false) return;\r\n\t\t\t}\r\n\r\n\t\t\tif ($elapsedHolder.length > 0){\r\n\t\t\t\t$this.html(getFullDate(date['order'+(\r\n\t\t\t\t\ttypeof $this.data('noweekday') !== 'undefined'\r\n\t\t\t\t\t?''\r\n\t\t\t\t\t:'wd'\r\n\t\t\t\t)]));\r\n\t\t\t\t$elapsedHolder.html(timestr);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$this.attr('title', getFullDate(date.order));\r\n\t\t\t\t$this.html(timestr);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\twindow.getTimeDiff = function(){ return timeDifference.apply(this, arguments) };\r\n\tfunction timeDifference(now, timestamp) {\r\n\t\tvar substract = (now.getTime() - timestamp.getTime())/1000,\r\n\t\t\td = {\r\n\t\t\t\tpast: substract > 0,\r\n\t\t\t\ttime: Math.abs(substract),\r\n\t\t\t\ttarget: timestamp\r\n\t\t\t},\r\n\t\t\ttime = d.time;\r\n\r\n\t\td.day = Math.floor(time/one.day);\r\n\t\ttime -= d.day * one.day;\r\n\t\t\r\n\t\td.hour = Math.floor(time/one.hour);\r\n\t\ttime -= d.hour * one.hour;\r\n\t\t\r\n\t\td.minute = Math.floor(time/one.minute);\r\n\t\ttime -= d.minute * one.minute;\r\n\t\t\r\n\t\td.second = Math.floor(time);\r\n\t\t\r\n\t\tif (d.day >= 7){\r\n\t\t\td.week = Math.floor(d.day/7);\r\n\t\t\td.day -= d.week*7;\r\n\t\t}\r\n\t\tif (d.week >= 4){\r\n\t\t\td.month = Math.floor(d.week/4);\r\n\t\t\td.week -= d.month*4;\r\n\t\t}\r\n\t\tif (d.month >= 12){\r\n\t\t\td.year = Math.floor(d.month/12);\r\n\t\t\td.month -= d.year*12;\r\n\t\t}\r\n\t\t\r\n\t\treturn d;\r\n\t}\r\n\tvar one = {\r\n\t\t'year':   31557600,\r\n\t\t'month':  2592000,\r\n\t\t'week':   604800,\r\n\t\t'day':    86400,\r\n\t\t'hour':   3600,\r\n\t\t'minute': 60,\r\n\t\t'second': 1,\r\n\t}, order = ['year', 'month', 'week', 'day', 'hour', 'minute', 'second'], i = 0;\r\n\twindow.one = (function(one){return one})(one);\r\n\r\n\twindow.createTimeStr = function(){ return createTimeStr.apply(this, arguments) };\r\n\tfunction createTimeStr(now, timestamp){\r\n\t\tvar delta = (now.getTime() - timestamp.getTime())/1000,\r\n\t\t\tpast = delta > 0,\r\n\t\t\tstr = false;\r\n\t\tif (!past) delta *= -1;\r\n\r\n\t\tconsole.groupCollapsed('#'+(i++)+' '+timestamp.toISOString());\r\n\t\tconsole.log('delta: '+delta);\r\n\r\n\t\t$.each(order, function(_, unit){\r\n\t\t\tvar value = one[unit];\r\n\t\t\tconsole.log(delta/value, delta >= value, unit);\r\n\t\t\tif (delta >= value){\r\n\t\t\t\tvar left = Math.floor(delta / value);\r\n\t\t\t\tdelta -= (left * value);\r\n\t\t\t\tif (!past && unit === 'minute')\r\n\t\t\t\t\tleft++;\r\n\t\t\t\tstr = left!=1?left+' '+unit+'s':(unit=='hour'?'an':'a')+' '+unit;\r\n\t\t\t\tconsole.groupEnd();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (str === false) return startval;\r\n\r\n\t\tif (str === '1 day') return past ? 'yesterday' : 'tomorrow';\r\n\t\telse return past ? str+' ago' : 'in '+str;\r\n\t}\r\n\tupdate();\r\n\twindow.updateTimesF = function(){\r\n\t\tupdate.apply(update,arguments);\r\n\t};\r\n\tif (window.noAutoUpdateTimes !== true) window.updateTimes = window.setInterval(update,10000);\r\n})(jQuery);\r\n"],"sourceRoot":"/source/"}