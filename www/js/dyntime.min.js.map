{"version":3,"sources":["dyntime.js"],"names":["$","TimeUpdate","addClass","each","$this","this","date","attr","TypeError","Timestamp","moment","isValid","console","log","Error","Now","showDayOfWeek","timeAgoStr","from","$elapsedHolder","parent","children","updateHandler","data","result","timeDifference","toDate","length","html","format","dateformat","orderwd","order","now","timestamp","substract","getTime","d","past","time","Math","abs","target","day","floor","one","hour","minute","second","week","month","year","window","getTimeDiff","apply","arguments","updateTimes","timeUpdateInterval","setInterval","jQuery"],"mappings":"CAAA,SAAUA,GAIT,QAASC,KACRD,EAAE,6BAA6BE,SAAS,QAAQC,KAAK,WACpD,GAAIC,GAAQJ,EAAEK,MACbC,EAAOF,EAAMG,KAAK,WACnB,IAAoB,gBAATD,GAAmB,KAAM,IAAIE,WAAU,kCAAoCF,GAAM,IAE5F,IAAIG,GAAYC,OAAOJ,EACvB,KAAKG,EAAUE,UAEd,KADAC,SAAQC,IAAIR,MACN,GAAIS,OAAM,yBAAyBR,EAAK,IAG/C,IAAIS,GAAML,SACTM,GAAiBZ,EAAMG,KAAK,kBAC5BU,EAAaR,EAAUS,KAAKH,GAC5BI,EAAiBf,EAAMgB,SAASC,SAAS,YACzCC,EAAgBlB,EAAMmB,KAAK,uBAE5B,IAA6B,kBAAlBD,GAA6B,CACvC,GAAIE,GAASF,EAAcG,EAAeV,EAAIW,SAAUjB,EAAUiB,UAClE,IAAIF,KAAW,EAAO,OAGnBL,EAAeQ,OAAS,GAC3BvB,EAAMwB,KAAKnB,EAAUoB,OAAOb,EAAgBc,EAAWC,QAAUD,EAAWE,QAC5Eb,EAAeS,KAAKX,IAEhBb,EAAMG,KAAK,QAASE,EAAUoB,OAAOC,EAAWE,QAAQJ,KAAKX,KAIpE,QAASQ,GAAeQ,EAAKC,GAC5B,GAAIC,IAAaF,EAAIG,UAAYF,EAAUE,WAAW,IACrDC,GACCC,KAAMH,EAAY,EAClBI,KAAMC,KAAKC,IAAIN,GACfO,OAAQR,GAETK,EAAOF,EAAEE,IA0BV,OAxBAF,GAAEM,IAAMH,KAAKI,MAAML,EAAKM,EAAIF,KAC5BJ,GAAQF,EAAEM,IAAME,EAAIF,IAEpBN,EAAES,KAAON,KAAKI,MAAML,EAAKM,EAAIC,MAC7BP,GAAQF,EAAES,KAAOD,EAAIC,KAErBT,EAAEU,OAASP,KAAKI,MAAML,EAAKM,EAAIE,QAC/BR,GAAQF,EAAEU,OAASF,EAAIE,OAEvBV,EAAEW,OAASR,KAAKI,MAAML,GAElBF,EAAEM,KAAO,IACZN,EAAEY,KAAOT,KAAKI,MAAMP,EAAEM,IAAI,GAC1BN,EAAEM,KAAc,EAAPN,EAAEY,MAERZ,EAAEY,MAAQ,IACbZ,EAAEa,MAAQV,KAAKI,MAAMP,EAAEY,KAAK,GAC5BZ,EAAEY,MAAgB,EAARZ,EAAEa,OAETb,EAAEa,OAAS,KACdb,EAAEc,KAAOX,KAAKI,MAAMP,EAAEa,MAAM,IAC5Bb,EAAEa,OAAgB,GAAPb,EAAEc,MAGPd,EAnER,GAAIP,IAAeE,MAAO,wBAC1BF,GAAWC,QAAU,SAASD,EAAWE,MAoEzCoB,OAAOC,YAAc,WAAY,MAAO5B,GAAe6B,MAAMjD,KAAMkD,WAEnE,IAAIV,IACHM,KAAU,SACVD,MAAU,OACVD,KAAU,OACVN,IAAU,MACVG,KAAU,KACVC,OAAU,GACVC,OAAU,EAEXI,QAAOP,IAAM,WAAY,MAAOA,MAEhC5C,IACAmD,OAAOI,YAAc,WAAYvD,EAAWqD,MAAMjD,KAAMkD,YACxDH,OAAOK,mBAAqBL,OAAOM,YAAYzD,EAAY,MACzD0D","file":"dyntime.min.js","sourcesContent":["(function($){\r\n\tvar dateformat = { order: 'Do MMMM YYYY, H:mm:ss' };\r\n\tdateformat.orderwd = 'dddd, '+dateformat.order;\r\n\r\n\tfunction TimeUpdate(){\r\n\t\t$('time[datetime]:not(.nodt)').addClass('dynt').each(function(){\r\n\t\t\tvar $this = $(this),\r\n\t\t\t\tdate = $this.attr('datetime');\r\n\t\t\tif (typeof date !== 'string') throw new TypeError('Invalid date data type: \"'+(typeof date)+'\"');\r\n\r\n\t\t\tvar Timestamp = moment(date);\r\n\t\t\tif (!Timestamp.isValid()){\r\n\t\t\t\tconsole.log(this);\r\n\t\t\t\tthrow new Error('Invalid date format: \"'+date+'\"');\r\n\t\t\t}\r\n\r\n\t\t\tvar Now = moment(),\r\n\t\t\t\tshowDayOfWeek = !$this.attr('data-noweekday'),\r\n\t\t\t\ttimeAgoStr = Timestamp.from(Now),\r\n\t\t\t\t$elapsedHolder = $this.parent().children('.dynt-el'),\r\n\t\t\t\tupdateHandler = $this.data('dyntime-beforeupdate');\r\n\r\n\t\t\tif (typeof updateHandler === 'function'){\r\n\t\t\t\tvar result = updateHandler(timeDifference(Now.toDate(), Timestamp.toDate()));\r\n\t\t\t\tif (result === false) return;\r\n\t\t\t}\r\n\r\n\t\t\tif ($elapsedHolder.length > 0){\r\n\t\t\t\t$this.html(Timestamp.format(showDayOfWeek ? dateformat.orderwd : dateformat.order));\r\n\t\t\t\t$elapsedHolder.html(timeAgoStr);\r\n\t\t\t}\r\n\t\t\telse $this.attr('title', Timestamp.format(dateformat.order)).html(timeAgoStr);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction timeDifference(now, timestamp) {\r\n\t\tvar substract = (now.getTime() - timestamp.getTime())/1000,\r\n\t\t\td = {\r\n\t\t\t\tpast: substract > 0,\r\n\t\t\t\ttime: Math.abs(substract),\r\n\t\t\t\ttarget: timestamp\r\n\t\t\t},\r\n\t\t\ttime = d.time;\r\n\r\n\t\td.day = Math.floor(time/one.day);\r\n\t\ttime -= d.day * one.day;\r\n\t\t\r\n\t\td.hour = Math.floor(time/one.hour);\r\n\t\ttime -= d.hour * one.hour;\r\n\t\t\r\n\t\td.minute = Math.floor(time/one.minute);\r\n\t\ttime -= d.minute * one.minute;\r\n\t\t\r\n\t\td.second = Math.floor(time);\r\n\t\t\r\n\t\tif (d.day >= 7){\r\n\t\t\td.week = Math.floor(d.day/7);\r\n\t\t\td.day -= d.week*7;\r\n\t\t}\r\n\t\tif (d.week >= 4){\r\n\t\t\td.month = Math.floor(d.week/4);\r\n\t\t\td.week -= d.month*4;\r\n\t\t}\r\n\t\tif (d.month >= 12){\r\n\t\t\td.year = Math.floor(d.month/12);\r\n\t\t\td.month -= d.year*12;\r\n\t\t}\r\n\t\t\r\n\t\treturn d;\r\n\t}\r\n\twindow.getTimeDiff = function(){ return timeDifference.apply(this, arguments) };\r\n\r\n\tvar one = {\r\n\t\t'year':   31557600,\r\n\t\t'month':  2592000,\r\n\t\t'week':   604800,\r\n\t\t'day':    86400,\r\n\t\t'hour':   3600,\r\n\t\t'minute': 60,\r\n\t\t'second': 1,\r\n\t};\r\n\twindow.one = (function(){return one})();\r\n\r\n\tTimeUpdate();\r\n\twindow.updateTimes = function(){ TimeUpdate.apply(this, arguments) };\r\n\twindow.timeUpdateInterval = window.setInterval(TimeUpdate, 10e3);\r\n})(jQuery);\r\n"],"sourceRoot":"/source/"}