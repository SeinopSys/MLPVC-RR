{"version":3,"sources":["index.js"],"names":["DocReady","push","Bind","$li","id","type","children","off","on","$this","$","this","title","Dialog","wait","post","mkAjaxHandler","status","close","nextAll","remove","btnhtml","insertAfter","fail","message","confirm","sure","closest","e","preventDefault","handlehash","hash","history","replaceState","href","$actions","find","filter","parent","prev","addBack","appendTo","request","$form","$ErrorNotice","hide","deviation","val","handleError","html","show","$w","trigger","attr","length","Error","data","updateSection","call","callback","success","SEASON","EPISODE","$unfinishBtn","deleteOnly","hasClass","Type","charAt","toUpperCase","substring","$unbind","prepend","first","checked","css","append","unbind","prop","$btn","mk","class","dis","replace","$section","$newChilds","render","empty","rebindHandlers","formBind","window","updateTimesF","location","reload","hlhash","$anchor","removeClass","addClass","setTimeout","$body","animate","scrollTop","offset","top","$navbar","outerHeight","document","body","$content","idstr","name","placeholder","$yt","$dm","yt","dm","center","$epSection","epsection","insertBefore","$voting","$voteButton","$both","siblings","value","epid","vote","newhtml","diff","past","removeData","fn","each","parseInt","fluidbox","immediateOpen","imgCheckDisabler","disable","prevurl","$formImgInput","samevalue","trim","$formImgCheck","removeAttr","outgoing","test","$formImgPreview","$formDescInput","$formTitleInput","$notice","noticeHTML","$previewIMG","Image","is","focus","CHECK_BTN","url","image_url","load","attempts","preview","screwchanges","sanityCheck","triggerHandler","label","$type","indexOf","mkData","what","episode","season","$imgs","total","loaded","$progress","max","display","width","marginTop","last","imagesLoaded","progress","_","img","isLoaded","always"],"mappings":"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","file":"index.min.js","sourcesContent":["DocReady.push(function Index(){\n\tvar $w = $(window),\n\t\t$body = $(document.body),\n\t\t$navbar = $('header nav'),\n\t\t$content = $('#content'),\n\t\tSEASON = window.SEASON,\n\t\tEPISODE = window.EPISODE,\n\t\tidstr = 'S'+SEASON+'E'+EPISODE;\n\n\t$('#video').on('click',function(){\n\t\tvar title = 'Video links';\n\t\t$.Dialog.wait(title, 'Requesting links from the server');\n\n\t\t$.post('/episode/getvideos/'+idstr,$.mkAjaxHandler(function(){\n\t\t\tvar data = this;\n\n\t\t\tif (!data.status) $.Dialog.fail(title, data.message);\n\n\t\t\tvar $form = $.mk('form').attr('id','vidlinks').append(\n\t\t\t\t$.mk('input').attr({name:'yt',placeholder:'YouTube'}),\n\t\t\t\t$.mk('input').attr({name:'dm',placeholder:'Dailymotion'})\n\t\t\t);\n\t\t\t$.Dialog.request(title, $form,'vidlinks','Save',function($form){\n\t\t\t\tvar $yt = $form.find('[name=yt]'),\n\t\t\t\t\t$dm = $form.find('[name=dm]');\n\t\t\t\tif (data.yt) $yt.val(data.yt);\n\t\t\t\tif (data.dm) $dm.val(data.dm);\n\t\t\t\tif (data.yt || data.dm){\n\t\t\t\t\t$form.find('p').show();\n\t\t\t\t\t$.Dialog.center();\n\t\t\t\t}\n\t\t\t\t$form.on('submit',function(e){\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t$.Dialog.wait(title, 'Saving links');\n\t\t\t\t\t\n\t\t\t\t\t$.post('/episode/setvideos/'+idstr,{yt: $yt.val(), dm: $dm.val()},$.mkAjaxHandler(function(){\n\t\t\t\t\t\tif (this.status){\n\t\t\t\t\t\t\tvar $epSection = $content.children('section.episode');\n\t\t\t\t\t\t\tif (this.epsection){\n\t\t\t\t\t\t\t\tif (!$epSection.length)\n\t\t\t\t\t\t\t\t\t$epSection = $.mk('section')\n\t\t\t\t\t\t\t\t\t\t.addClass('episode')\n\t\t\t\t\t\t\t\t\t\t.insertBefore($content.children('section').first());\n\t\t\t\t\t\t\t\t$epSection.html($(this.epsection).filter('section').html());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ($epSection.length) $epSection.remove();\n\t\t\t\t\t\t\t$.Dialog.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse $.Dialog.fail(title, this.message);\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t});\n\t\t}));\n\t});\n\n\tvar $voting = $('#voting'),\n\t\t$voteButton = $voting.find('button');\n\t$voting.on('click','button',function(e){\n\t\te.preventDefault();\n\t\tvar $this = $(this),\n\t\t\t$both = $this.siblings('button').addBack(),\n\t\t\tvalue = $this.hasClass('green') ? 1 : -1,\n\t\t\tepid = ''+idstr,\n\t\t\ttitle = (value > 0?'Up':'Down')+'voting '+epid;\n\n\t\t$both.attr('disabled', true);\n\n\t\t$.post('/episode/vote/'+epid,{vote:value},$.mkAjaxHandler(function(){\n\t\t\tif (this.status){\n\t\t\t\t$.Dialog.close();\n\t\t\t\tvar $section = $this.closest('section');\n\t\t\t\t$section.children('h2').nextAll().remove();\n\t\t\t\t$section.append(this.newhtml);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$.Dialog.fail(title,this.message);\n\t\t\t\t$both.attr('disabled', false);\n\t\t\t}\n\t\t}));\n\t});\n\n\t$voting.find('time').data('dyntime-beforeupdate',function(diff){\n\t\tif (diff.past !== true) return;\n\n\t\tif (!$voteButton.length){\n\t\t\t$.post('/episode/vote/'+idstr+'?html',$.mkAjaxHandler(function(){\n\t\t\t\tif (this.status){\n\t\t\t\t\t$voting.children('h2').nextAll().remove();\n\t\t\t\t\t$voting.append(this.html);\n\t\t\t\t}\n\t\t\t\telse $.Dialog.fail('Display voting buttons',this.message);\n\t\t\t}));\n\t\t\t$(this).removeData('dyntime-beforeupdate');\n\t\t\treturn false;\n\t\t}\n\t});\n\n\t$.fn.rebindHandlers = function(){\n\t\tvar $this = $(this);\n\t\t$this.find('li[id]').each(function(){\n\t\t\tvar $li = $(this),\n\t\t\t\tid = parseInt($li.attr('id').replace(/\\D/g,'')),\n\t\t\t\ttype = $li.closest('section[id]').attr('id');\n\t\t\t\t\n\t\t\t$('section .unfinished .screencap > a')\n\t\t\t\t.fluidbox({ immediateOpen: true })\n\t\t\t\t.on('openstart',function(){\n\t\t\t\t\t$body.addClass('no-distractions');\n\t\t\t\t})\n\t\t\t\t.on('closestart', function() {\n\t\t\t\t\t$body.removeClass('no-distractions');\n\t\t\t\t});\n\n\t\t\tBind($li, id, type);\n\t\t});\n\t\treturn $this;\n\t};\n\t$('#requests, #reservations').rebindHandlers();\n\tfunction Bind($li, id, type){\n\t\t$li.children('button.reserve-request').off('click').on('click',function(){\n\t\t\tvar $this = $(this),\n\t\t\t\ttitle = 'Reserving request';\n\n\t\t\t$.Dialog.wait(title,'Sending reservation to the server');\n\n\t\t\t$.post(\"/reserving/request/\"+id,$.mkAjaxHandler(function(){\n\t\t\t\tif (this.status){\n\t\t\t\t\t$.Dialog.close();\n\t\t\t\t\t$this.nextAll().remove();\n\t\t\t\t\t$(this.btnhtml).insertAfter($this);\n\t\t\t\t\tBind($li, id, type);\n\t\t\t\t\t$this.remove();\n\t\t\t\t}\n\t\t\t\telse $.Dialog.fail(title,this.message);\n\t\t\t}));\n\t\t});\n\t\t$li.children('button.delete').on('click',function(){\n\t\t\tvar $this = $(this),\n\t\t\t\ttitle = 'Deleteing request';\n\n\t\t\t$.Dialog.confirm(title, 'You are about to permanently delete this request.<br>Are you sure about this?', function(sure){\n\t\t\t\tif (!sure) return;\n\n\t\t\t\t$.post('/reserving/request/'+id+'?delete',$.mkAjaxHandler(function(){\n\t\t\t\t\tif (this.status){\n\t\t\t\t\t\t$.Dialog.close();\n\t\t\t\t\t\t$this.closest('li').remove();\n\t\t\t\t\t}\n\t\t\t\t\telse $.Dialog.fail(title,this.message);\n\t\t\t\t}));\n\t\t\t});\n\t\t});\n\t\t$li.children('em').children('a').on('click',function(e){\n\t\t\te.preventDefault();\n\t\t\thandlehash(this.hash);\n\t\t\thistory.replaceState({},'',this.href);\n\t\t});\n\t\tvar $actions = $li.find('.reserver-actions').children();\n\t\t$actions.filter('.cancel').off('click').on('click',function(){\n\t\t\tvar $this = $(this),\n\t\t\t\ttitle = 'Cancel reservation';\n\n\t\t\t$.Dialog.confirm(title,'Are you sure you want to cancel this reservation?',function(sure){\n\t\t\t\tif (!sure) return;\n\n\t\t\t\t$.Dialog.wait(title,'Cancelling reservation');\n\n\t\t\t\t$.post('/reserving/'+type+'/'+id+'?cancel',$.mkAjaxHandler(function(){\n\t\t\t\t\tif (this.status){\n\t\t\t\t\t\t$.Dialog.close();\n\t\t\t\t\t\tif (this.remove === true) return $li.remove();\n\t\t\t\t\t\t$this.parent().prev().nextAll().addBack().remove();\n\t\t\t\t\t\t$(this.btnhtml).appendTo($li);\n\n\t\t\t\t\t\tBind($li, id, type);\n\t\t\t\t\t}\n\t\t\t\t\telse $.Dialog.fail(title,this.message);\n\t\t\t\t}));\n\t\t\t});\n\t\t});\n\t\t$actions.filter('.finish').off('click').on('click',function(){\n\t\t\tvar title = 'Finish reservation';\n\n\t\t\t$.Dialog.request(title,'<form id=\"finish-res\"><div class=\"notice fail\"><label>Error</label><p></p></div><input type=\"text\" name=\"deviation\" placeholder=\"Deviation URL\"></form>','finish-res','Finish',function(){\n\t\t\t\tvar $form = $('#finish-res'),\n\t\t\t\t\t$ErrorNotice = $form.find('.notice p');\n\t\t\t\t$ErrorNotice.parent().hide();\n\t\t\t\t$form.on('submit',function(e){\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tvar deviation = $form.find('[name=deviation]').val(),\n\t\t\t\t\t\thandleError = function(e){\n\t\t\t\t\t\t\t$ErrorNotice.html(e.message).parent().show();\n\t\t\t\t\t\t\t$w.trigger('resize');\n\t\t\t\t\t\t\t$form.find('input').attr('disabled', false);\n\t\t\t\t\t\t};\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (typeof deviation !== 'string' || deviation.length === 0)\n\t\t\t\t\t\t\tthrow new Error('Please enter a deviation URL');\n\n\t\t\t\t\t\t$.post('/reserving/'+type+'/'+id+'?finish',{deviation:deviation},$.mkAjaxHandler(function(){\n\t\t\t\t\t\t\tvar data = this;\n\t\t\t\t\t\t\tif (data.status) updateSection.call({callback:function(){\n\t\t\t\t\t\t\t\tif (typeof data.message === 'string')\n\t\t\t\t\t\t\t\t\t$.Dialog.success(title,data.message,true);\n\t\t\t\t\t\t\t\telse $.Dialog.close();\n\t\t\t\t\t\t\t}}, type, SEASON, EPISODE);\n\t\t\t\t\t\t\telse handleError(data);\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e){ handleError(e) }\n\t\t\t\t});\n\t\t\t})\n\t\t});\n\t\t$actions.filter('.unfinish').off('click').on('click',function(){\n\t\t\tvar $unfinishBtn = $(this),\n\t\t\t\tdeleteOnly = $unfinishBtn.hasClass('delete-only'),\n\t\t\t\ttitle = (deleteOnly?'Delete':'Un-finish')+' reservation',\n\t\t\t\tType = type.charAt(0).toUpperCase()+type.substring(1);\n\n\t\t\t$.Dialog.request(title,'<form id=\"unbind-check\"><p>Are you sure you want to '+(deleteOnly?'delete this reservation':'mark this reservation as unfinished')+'?</p><hr><label><input type=\"checkbox\" name=\"unbind\"> Unbind reservation from user</label></form>','unbind-check','Un-finish',function(){\n\t\t\t\tvar $form = $('#unbind-check'),\n\t\t\t\t\t$unbind = $form.find('[name=unbind]');\n\n\t\t\t\tif (!deleteOnly)\n\t\t\t\t\t$form.prepend('<div class=\"notice info\">By removing the \"finished\" flag, the deviation will be moved back to the \"List of '+Type+'\" section</div>');\n\n\t\t\t\tif (type === 'reservations'){\n\t\t\t\t\t$unbind.on('click',function(){\n\t\t\t\t\t\t$('#dialogButtons').children().first().val(this.checked ? 'Delete' : 'Un-finish')\n\t\t\t\t\t});\n\t\t\t\t\tif (deleteOnly)\n\t\t\t\t\t\t$unbind.trigger('click').off('click').on('click keydown touchstart', function(){return false}).css('pointer-events','none').parent().hide();\n\t\t\t\t\t$form.append('<div class=\"notice warn\">Because this '+(!deleteOnly?'is a reservation, unbinding it from the user will <strong>delete</strong> it permanently.':'reservation was added directly, it cannot be marked un-finished, only deleted.')+'</div>');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\t$form.append('<div class=\"notice info\">If this is checked, any user will be able to reserve this request again afterwards. If left unchecked, only the current reserver <em>(and Vector Inspectors)</em> will be able to mark it as finished until the reservation is cancelled.</div>');\n\t\t\t\t$w.trigger('resize');\n\t\t\t\t$form.on('submit',function(e){\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tvar unbind = $unbind.prop('checked');\n\n\t\t\t\t\t$.Dialog.wait(title,'Removing \"finished\" flag'+(unbind?' & unbinding from user':''));\n\n\t\t\t\t\t$.post('/reserving/'+type+'/'+id+'?unfinish'+(unbind?'&unbind':''),$.mkAjaxHandler(function(){\n\t\t\t\t\t\tif (this.status){\n\t\t\t\t\t\t\t$.Dialog.success(title, typeof this.message !== 'undefined' ? this.message : '\"finished\" flag removed successfully');\n\t\t\t\t\t\t\tupdateSection(type, SEASON, EPISODE);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse $.Dialog.fail(title,this.message);\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\t$actions.filter('.lock').off('click').on('click',function(){\n\t\t\tvar title = 'Approve post',\n\t\t\t\t$btn = $(this);\n\n\t\t\t$.Dialog.confirm(title, \"By approving this post, you can prevent any additional modifications, such as un-finishing. This mark is <strong>permanent</strong>, and can only be removed by the developer. <strong>This should be used when the image has been added to the group gallery.</strong><br><br>After approving the post, it'll count towards the user's badges/achievements/points/whatever (once implemented) and the image will receive a small green checkmark on the site. <strong>This action will be logged.</strong><br><br>Are you <em>absolutely</em> sure you want to approve this post, and with that, prevent futher actions?\",['Approve it','Nevermind'],function(sure){\n\t\t\t\tif (!sure) return;\n\n\t\t\t\t$.Dialog.wait(title, 'Approving post');\n\n\t\t\t\t$.post('/reserving/'+type+'/'+id+'?lock', $.mkAjaxHandler(function(){\n\t\t\t\t\tif (!this.status) return $.Dialog.fail(title, data.message);\n\n\t\t\t\t\t$btn.closest('li').children('.image').children('a').append(\n\t\t\t\t\t\t$.mk('span').attr({\n\t\t\t\t\t\t\t'class': 'typcn typcn-tick',\n\t\t\t\t\t\t\ttitle: \"This submission has been accepted into the group gallery\"\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\t$btn.parent().remove();\n\n\t\t\t\t\tif (this.message){\n\t\t\t\t\t\t$.Dialog.success(title, data.message, true);\n\t\t\t\t\t}\n\t\t\t\t\telse $.Dialog.close();\n\t\t\t\t}));\n\t\t\t});\n\t\t});\n\t}\n\n\t$.fn.formBind = function (){\n\t\tvar $form = $(this),\n\t\t\t$formImgCheck = $form.find('.check-img'),\n\t\t\t$formImgPreview = $form.find('.img-preview'),\n\t\t\t$formDescInput = $form.find('[name=label]'),\n\t\t\t$formImgInput = $form.find('[name=image_url]'),\n\t\t\t$formTitleInput = $form.find('[name=label]'),\n\t\t\t$notice = $formImgPreview.children('.notice'),\n\t\t\tnoticeHTML = $notice.html(),\n\t\t\t$previewIMG = $formImgPreview.children('img'),\n\t\t\ttype = $form.data('type'), Type = type.charAt(0).toUpperCase()+type.substring(1);\n\n\t\tif ($previewIMG.length === 0) $previewIMG = $(new Image()).appendTo($formImgPreview);\n\t\t$('#'+type+'-btn').on('click',function(){\n\t\t\tif (!$form.is(':visible')){\n\t\t\t\t$form.show();\n\t\t\t\t$formDescInput.focus();\n\t\t\t\t$body.animate({scrollTop: $form.offset().top - $navbar.outerHeight() - 10 }, 500);\n\t\t\t}\n\t\t});\n\t\tif (type === 'reservation') $('#add-reservation-btn').on('click',function(){\n\t\t\tvar title = 'Add a reservation';\n\t\t\t$.Dialog.request(title,'<form id=\"add-reservation\"><div class=\"notice fail\"><label>Error</label><p></p></div><div class=\"notice info\">This feature should only be used when the vector was made before the episode was displayed here, and all you want to do is link your already-made vector under the newly posted episode.</div><div class=\"notice warn\">If you already posted the reservation, use the <strong class=\"typcn typcn-attachment\">I\\'m done</strong> button to mark it as finished instead of adding it here.</div><input type=\"text\" name=\"deviation\" placeholder=\"Deviation URL\"></form>','add-reservation','Finish',function(){\n\t\t\t\tvar $form = $('#add-reservation'),\n\t\t\t\t\t$ErrorNotice = $form.find('.notice.fail').hide().children('p');\n\t\t\t\t$form.on('submit',function(e){\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tvar deviation = $form.find('[name=deviation]').val(),\n\t\t\t\t\t\thandleError = function(e){\n\t\t\t\t\t\t\t$ErrorNotice.html(e.message).parent().show();\n\t\t\t\t\t\t\t$w.trigger('resize');\n\t\t\t\t\t\t\t$form.find('input').attr('disabled', false);\n\t\t\t\t\t\t};\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (typeof deviation !== 'string' || deviation.length === 0)\n\t\t\t\t\t\t\tthrow new Error('Please enter a deviation URL');\n\n\t\t\t\t\t\t$.post('/reserving/reservation?add='+idstr,{deviation:deviation},$.mkAjaxHandler(function(){\n\t\t\t\t\t\t\tif (this.status){\n\t\t\t\t\t\t\t\t$.Dialog.success(title,this.message);\n\t\t\t\t\t\t\t\tupdateSection(type, SEASON, EPISODE);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse  handleError(this);\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e){ handleError(e) }\n\t\t\t\t});\n\t\t\t})\n\t\t});\n\t\t$formImgInput.on('keyup change paste',imgCheckDisabler);\n\t\tvar outgoing =  /^https?:\\/\\/www\\.deviantart\\.com\\/users\\/outgoing\\?/;\n\t\tfunction imgCheckDisabler(disable){\n\t\t\tvar prevurl = $formImgInput.data('prev-url'),\n\t\t\t\tsamevalue = typeof prevurl === 'string' && prevurl.trim() === $formImgInput.val().trim();\n\t\t\t$formImgCheck.attr('disabled',disable === true || samevalue);\n\t\t\tif (disable === true || samevalue) $formImgCheck.attr('title', 'You need to change the URL before chacking again.');\n\t\t\telse $formImgCheck.removeAttr('title');\n\n\t\t\tif (disable.type === 'keyup'){\n\t\t\t\tvar val = $formImgInput.val();\n\t\t\t\tif (outgoing.test(val))\n\t\t\t\t\t$formImgInput.val($formImgInput.val().replace(outgoing,''));\n\t\t\t}\n\t\t}\n\t\tvar CHECK_BTN = '<strong class=\"typcn typcn-arrow-repeat\" style=display:inline-block>Check image</strong>';\n\t\t$formImgCheck.on('click',function(e){\n\t\t\te.preventDefault();\n\n\t\t\t$formImgCheck.removeClass('red');\n\t\t\timgCheckDisabler(true);\n\t\t\tvar url = $formImgInput.val(),\n\t\t\t\ttitle = Type+' process';\n\n\t\t\t$.Dialog.wait(Type+' process','Checking image');\n\n\t\t\t$.post('/post', { image_url: url }, $.mkAjaxHandler(function(){\n\t\t\t\tvar data = this;\n\t\t\t\tif (!data.status){\n\t\t\t\t\t$notice.html(data.message).show();\n\t\t\t\t\t$previewIMG.hide();\n\t\t\t\t\treturn $.Dialog.close();\n\t\t\t\t}\n\n\t\t\t\tfunction load(data, attempts){\n\t\t\t\t\t$.Dialog.wait(title,'Checking image availability');\n\n\t\t\t\t\t$previewIMG.attr('src',data.preview).show().off('load error').on('load',function(){\n\t\t\t\t\t\t$notice.hide();\n\n\t\t\t\t\t\t$formImgInput.data('prev-url', url);\n\n\t\t\t\t\t\tif (!!data.title && !$formTitleInput.val().trim())\n\t\t\t\t\t\t\t$.Dialog.confirm(\n\t\t\t\t\t\t\t\t'Confirm '+type+' title',\n\t\t\t\t\t\t\t\t'The image you just checked had the following title:<br><br><p class=align-center><strong>'+data.title+'</strong></p>'\n\t\t\t\t\t\t\t\t +'<br>Would you like to use this as the '+type+'\\'s description?<br>Keep in mind that it should describe the thing(s) '\n\t\t\t\t\t\t\t\t +(type==='request'?'being requested':'you plan to vector')+'.'\n\t\t\t\t\t\t\t\t +'<p>This dialog will not appear if you give your '+type+' a description before clicking the '+CHECK_BTN+' button.</p>',\n\t\t\t\t\t\t\t\tfunction(sure){\n\t\t\t\t\t\t\t\t\tif (!sure) return $form.find('input[name=label]').focus();\n\t\t\t\t\t\t\t\t\t$formTitleInput.val(data.title);\n\t\t\t\t\t\t\t\t\t$.Dialog.close();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\telse $.Dialog.close(function(){\n\t\t\t\t\t\t\t$form.find('input[name=label]').focus();\n\t\t\t\t\t\t});\n\t\t\t\t\t}).on('error',function(){\n\t\t\t\t\t\tvar title = \"Can't load image\";\n\t\t\t\t\t\tif (attempts < 1){\n\t\t\t\t\t\t\t$.Dialog.wait(title,'Image could not be loaded, retrying in 2 seconds...');\n\t\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\t\tload(data, attempts+1);\n\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$.Dialog.fail(title,\"There was an error while attempting to load the image. Make sure the URL is correct and try again!\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tload(data, 0);\n\t\t\t}));\n\t\t});\n\t\t$form.on('submit',function(e, screwchanges, sanityCheck){\n\t\t\te.preventDefault();\n\t\t\tvar title = Type+' process';\n\n\t\t\tif (!screwchanges && $formImgInput.data('prev-url') !== $formImgInput.val())\n\t\t\t\treturn $.Dialog.confirm(\n\t\t\t\t\ttitle,\n\t\t\t\t\t'You modified the image URL without clicking the '+CHECK_BTN+' button.<br>Do you want to continue with the last checked URL?',\n\t\t\t\t\tfunction(sure){\n\t\t\t\t\t\tif (!sure) return;\n\n\t\t\t\t\t\t$form.triggerHandler('submit',[true]);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\tif (typeof $formImgInput.data('prev-url') === 'undefined')\n\t\t\t\treturn $.Dialog.fail(title, 'Please click the '+CHECK_BTN+' button before submitting your '+type+'!');\n\n\t\t\tif (!sanityCheck && type === 'request'){\n\t\t\t\tvar label = $formDescInput.val(),\n\t\t\t\t\t$type = $form.find('select');\n\n\t\t\t\tif (label.indexOf('character') > -1 && $type.val() !== 'chr')\n\t\t\t\t\treturn $.Dialog.confirm(title, 'Your request label contains the word \"character\", but the request type isn\\'t set to Character.<br>Are you sure you\\'re not requesting one (or more) character(s)?',['Let me change the type', 'Carray on'],function(sure){\n\t\t\t\t\t\tif (!sure) return $form.triggerHandler('submit',[screwchanges, true]);\n\n\t\t\t\t\t\t$.Dialog.close(function(){\n\t\t\t\t\t\t\t$type.focus();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar data = $form.mkData({\n\t\t\t\twhat: type,\n\t\t\t\tepisode: EPISODE,\n\t\t\t\tseason: SEASON,\n\t\t\t\timage_url: $formImgInput.data('prev-url'),\n\t\t\t});\n\n\t\t\t$.Dialog.wait(title,'Submitting '+type);\n\n\t\t\t$.post('/post',data,$.mkAjaxHandler(function(){\n\t\t\t\tif (this.status){\n\t\t\t\t\t$.Dialog.success(title, Type+' posted successfully');\n\t\t\t\t\tupdateSection(type, SEASON, EPISODE);\n\t\t\t\t}\n\t\t\t\telse $.Dialog.fail(title, this.message);\n\t\t\t}));\n\t\t}).on('reset',function(){\n\t\t\t$formImgCheck.attr('disabled', false).addClass('red');\n\t\t\t$notice.html(noticeHTML).show();\n\t\t\t$previewIMG.hide();\n\t\t\t$formImgInput.removeData('prev-url');\n\t\t\t$(this).hide();\n\t\t});\n\t};\n\tfunction updateSection(type, SEASON, EPISODE){\n\t\tvar Type = type.charAt(0).toUpperCase()+type.substring(1), dis = this;\n\t\t$.Dialog.wait(Type, 'Updating list');\n\t\t$.post('/episode/'+type.replace(/([^s])$/,'$1s')+'/S'+SEASON+'E'+EPISODE,$.mkAjaxHandler(function(){\n\t\t\tif (this.status){\n\t\t\t\tvar $section = $('#'+type.replace(/([^s])$/,'$1s')),\n\t\t\t\t\t$newChilds = $(this.render).filter('section').children();\n\t\t\t\t$section.empty().append($newChilds).rebindHandlers();\n\t\t\t\t$section.find('.post-form').data('type',type).formBind();\n\t\t\t\twindow.updateTimesF();\n\t\t\t\tif (typeof dis === 'object' && typeof dis.callback == 'function') dis.callback();\n\t\t\t\telse $.Dialog.close();\n\t\t\t}\n\t\t\telse window.location.reload();\n\t\t}));\n\t}\n\t$('.post-form').each($.fn.formBind);\n\n\tfunction hlhash(e){\n\t\tif (typeof e === 'object' && typeof e.preventDefault === 'function')\n\t\t\te.preventDefault();\n\n\t\t$.Dialog.close();\n\n\t\thandlehash(location.hash, e);\n\t}\n\tfunction handlehash(hash, e){\n\t\tvar $anchor = $(hash);\n\n\t\t$('.highlight').removeClass('highlight');\n\t\tif (!$anchor.length) return;\n\n\t\t$anchor.addClass('highlight');\n\t\tsetTimeout(function(){\n\t\t\t$body.animate({scrollTop: $anchor.offset().top - $navbar.outerHeight() - 10 }, 500,function(){\n\t\t\t\tif (typeof e === 'object' && e.type === 'load') $.Dialog.close();\n\t\t\t});\n\t\t}, 1);\n\t}\n\t$w.on('hashchange', hlhash);\n\tif (location.hash.length){\n\t\tvar $imgs = $content.find('img'),\n\t\t\ttotal = $imgs.length, loaded = 0;\n\n\t\tif (total > 0){\n\t\t\t$.Dialog.wait('Scroll post into view','Waiting for page to load');\n\t\t\tvar $progress = $.mk('progress').attr({max:total,value:0}).css({display:'block',width:'100%',marginTop:'5px'});\n\t\t\t$('#dialogContent').children('div:not([id])').last().addClass('align-center').append($progress);\n\t\t\t$content.imagesLoaded()\n\t\t\t\t.progress(function(_, img){\n\t\t\t\t\tif (img.isLoaded){\n\t\t\t\t\t\tloaded++;\n\t\t\t\t\t\t$progress.attr('value', loaded);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ttotal--;\n\t\t\t\t\t\t$progress.attr('max', total);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.always(function(){\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t$.Dialog.close();\n\t\t\t\t\t\thlhash({type:'load'});\n\t\t\t\t\t},1);\n\t\t\t\t});\n\t\t}\n\t\telse hlhash();\n\t}\n});\n"],"sourceRoot":"/source/"}