!function(e,t){function o(e,t,o,n){return{color:e,draggable:"undefined"==typeof t?!1:t,overlay:"undefined"==typeof o?!0:o,closeButton:"undefined"==typeof n?!1:n}}function n(){return e(document.createElement("div"))}var i,a,f,s,r,u=e("html"),c={fail:o("red"),success:o("green"),wait:o("blue"),request:o("yellow",!0),confirm:o("orange"),info:o("darkblue")},l={fail:"Error",success:"Success",wait:"Sending request",request:"Input required",confirm:"Confirmation",info:"Info"},d={fail:"There was an issue while processing the request.",success:"Whatever you just did, it was completed successfully.",request:"The request did not require any additional info.",confirm:"Are you sure?",info:"No message provided."},p={fail:{color:"#E11"},success:{color:"#128023"},wait:{color:"#4390df"},request:{color:"#c29008"},confirm:{color:"#bf5a15"},info:{color:"#16499a"}},g=e(window);e.Dialog={open:t,fail:function(t,o,n){e.Dialog.display("fail",t,o,{Close:{action:function(){e.Dialog.close()}}},n)},success:function(o,n,i,a){e.Dialog.display("success",o,n,i===!0?{Close:{action:function(){e.Dialog.close()}}}:t,a)},wait:function(t,o,n){"function"==typeof o&&"undefined"===n&&(n=o),("string"!=typeof o||o.length<2)&&(o="Sending request"),e.Dialog.display("wait",t,o[0].toUpperCase()+o.substring(1)+"...",n)},request:function(t,o,n,i,a){"function"==typeof i&&"undefined"==typeof a&&(a=i,i="ElkÃ¼ld");var f={};f[i]={submit:!0,form:n},f.Cancel={action:function(){e.Dialog.close()}},e.Dialog.display("request",t,o,f,a)},confirm:function(t,o,n,i){"function"==typeof n&&"undefined"==typeof i&&(i=n),"function"!=typeof i&&(i=new Function),e.isArray(n)||(n=["Eeyup","Nope"]);var a={};a[n[0]]={action:function(){i(!0)}},a[n[1]]={action:function(){i(!1),e.Dialog.close()}},e.Dialog.display("confirm",t,o,a)},info:function(t,o,n){e.Dialog.display("info",t,o,{Close:{action:function(){e.Dialog.close()}}},n)},display:function(o,y,h,m,v,w){function b(){var o=e(":focus");o.length>0?window._focusedElement=o.last():window._focusedElement=t;var n=e("#dialogContent").find("input,select,textarea").filter(":visible"),i=e("#dialogButtons").children();n.length>0?n.first().focus():i.length>0&&i.first().focus()}function D(c){var d=n();if(c===!0)i=e("#dialogOverlay"),s=e("#dialogBox"),f=e("#dialogHeader"),a=e("#dialogContent"),r=e("#dialogButtons"),"string"==typeof v.title&&f.text(v.title),a.find("input, select, textarea").attr("disabled",!0),"object"==typeof p[o]&&d.css(p[o]),a.append(d.html(v.content)),v.buttons&&0===r.length?r=n().attr("id","dialogButtons").insertAfter(a):v.buttons||0===r.length?r.empty():r.remove(),s.stop(),setTimeout(function(){s.css({left:(g.width()-s.outerWidth())/2,top:(g.height()-s.outerHeight())/2,opacity:1})},10);else{i=n().attr("id","dialogOverlay"),f=n().attr("id","dialogHeader").text(v.title||l[o]),a=n().attr("id","dialogContent"),s=n().attr("id","dialogBox"),d.html(v.content),"object"==typeof p[o]&&d.css(p[o]),a.append(d),s.append(f).append(a),v.buttons&&(r=n().attr("id","dialogButtons").insertAfter(a)),i.appendTo(document.body).css("opacity",.5).show(),s.css("opacity",0).appendTo(i);var y=g.height()-s.outerHeight();setTimeout(function(){s.is(":animated")||(s.css({top:y/3,left:y/2}).animate({top:y/2,opacity:1},350,b),i.fadeTo(350,1))},100);var h=u.css("overflow");u.attr("data-overflow",h).css("overflow","hidden")}f.attr("class",v.color+"-bg"),v.buttons&&e.each(v.buttons,function(o,n){var i=e(document.createElement("input"));if(n.submit?i.attr("type","submit"):i.attr("type","button"),i.attr("class",v.color+"-bg"),n.form){var f=e("#"+n.form);1==f.length&&(i.click(function(){f.find("input[type=submit]").trigger("click")}),f.prepend(e(document.createElement("input")).attr("type","submit").hide()))}i.val(o).on("keydown",function(e){if(-1!==[13,32].indexOf(e.keyCode))e.preventDefault(),e.stopPropagation(),i.trigger("click");else if(9===e.keyCode){e.preventDefault(),e.stopPropagation();var t=r.children(),o=t.filter(":focus"),n=a.find(":input");o.length?e.shiftKey?o.prev().length?o.prev().focus():(n.length>0?n:t).last().focus():o.next().length?o.next().focus():n.add(t).first().focus():n.add(t)[e.shiftKey?"last":"first"]().focus()}}).on("click",function(o){o.preventDefault(),o.stopPropagation(),"function"==typeof n.action&&n.action(o),"close"===n.type&&e.Dialog.close("function"==typeof n.callback?n.callback:t)}),r.append(i)}),setTimeout(function(){s.css({top:(g.height()-s.outerHeight())/2,left:(g.width()-s.outerWidth())/2})},100),v.draggable&&f.css("cursor","move").on("mousedown",function(e){e.preventDefault(),e.stopPropagation();var t=s.outerHeight(),o=s.outerWidth(),n=s.offset().top+t-e.pageY,a=s.offset().left+o-e.pageX;i.on("mousemove",function(e){var i=e.pageY>0?e.pageY+n-t:0,f=e.pageX>0?e.pageX+a-o:0;i>=0&&i<=window.innerHeight+e.pageY&&s.offset({top:i}),f>=0&&f<=window.innerWidth+e.pageY&&s.offset({left:f})})}).on("click",function(e){e.preventDefault(),e.stopPropagation(),i.off("mousemove")}),b(),"function"==typeof w&&w()}if("string"!=typeof o||"undefined"==typeof c[o])throw new TypeError("Invalid dialog type: "+typeof o);"function"==typeof m&&"undefined"==typeof v&&"undefined"==typeof w?w=m:"object"==typeof m&&"function"==typeof v&&"undefined"==typeof w&&(w=v),"undefined"==typeof v&&(v={}),"undefined"==typeof y?y=l[o]:y===!1&&(y=t),"undefined"==typeof h&&(h=d[o]),v=e.extend(!0,{type:o,title:y,content:h,buttons:m},c[o],v),"undefined"==typeof e.Dialog.open?(e.Dialog.open=v,D()):D(!!e.Dialog.open)},close:function(t){if("undefined"==typeof e.Dialog.open)return"function"==typeof t?t():!1;i.fadeOut(350,function(){e.Dialog.open=void 0,e(this).remove(),window._focusedElement instanceof jQuery&&window._focusedElement.focus(),"function"==typeof t&&t()}),s.animate({top:(g.height()-s.outerHeight())/3*2,opacity:0},350);var o=u.attr("data-overflow");"undefined"!=typeof o&&(u.css("overflow",o),u.removeAttr("data-overflow"))}},g.on("resize",function(){"undefined"!=typeof e.Dialog.open&&(s.css("top",(g.height()-s.outerHeight())/2),s.css("left",(g.width()-s.outerWidth())/2))}).on("ajaxerror",function(){e.Dialog.fail(!1,"There was an error while processing your request. You may find additional details in the browser's console.")}),e(document.body).on("keydown",function(t){if(9===t.keyCode&&"undefined"!=typeof e.Dialog.open){var o=e(t.target),n=e("#dialogContent").find(":input"),i=o.index("#dialogContent :input");t.shiftKey&&0===i?(t.preventDefault(),e("#dialogButtons").find(":last").focus()):1!==n.filter(":focus").length&&(t.preventDefault(),n.first().focus())}})}(jQuery);