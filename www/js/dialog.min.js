!function(e,t){"use strict";function n(t){return e.mk("div").attr("id",t)}var i={fail:"red",success:"green",wait:"blue",request:"yellow",confirm:"orange",info:"darkblue"},o={fail:"fail",success:"success",wait:"info",request:"warn",confirm:"caution",info:"info"},a={fail:"Error",success:"Success",wait:"Sending request",request:"Input required",confirm:"Confirmation",info:"Info"},f={fail:"There was an issue while processing the request.",success:"Whatever you just did, it was completed successfully.",request:"The request did not require any additional info.",confirm:"Are you sure?",info:"No message provided."},r=e("#dialogOverlay"),l=e("#dialogContent"),s=e("#dialogHeader"),u=e("#dialogBox"),c=e("#dialogButtons");e.Dialog=function(){function d(){if(!("undefined"!=typeof w&&w instanceof jQuery)){var n=e(":focus");w=n.length>0?n.last():t}}function p(){"undefined"!=typeof w&&w instanceof jQuery&&(w.focus(),w=t)}function y(){var t=e("#dialogContent").find("input,select,textarea").filter(":visible"),n=e("#dialogButtons").children();t.length>0?t.first().focus():n.length>0&&n.first().focus()}function g(e){l.children(":not(:last-child)").find("input, select, textarea").attr("disabled",e)}function h(p,h,v,w,K){if("string"!=typeof p||"undefined"==typeof i[p])throw new TypeError("Invalid dialog type: "+typeof p);"function"==typeof w&&"undefined"==typeof K&&(K=w),"undefined"==typeof h?h=a[p]:h===!1&&(h=t),"undefined"==typeof v&&(v=f[p]);var q,x={type:p,title:h,content:v||f[p],buttons:w,color:i[p]},B=Boolean(b),T=n().addClass(x.color).append(x.content),D=B&&"request"===b.type&&["fail","wait"].includes(x.type);if(B)if(r=e("#dialogOverlay"),u=e("#dialogBox"),s=e("#dialogHeader"),"string"==typeof x.title&&s.text(x.title),l=e("#dialogContent"),D){q=l.children(":not(#dialogButtons)").last();var O=q.children(".notice");O.length||(O=e.mk("div").append(e.mk("p")),q.append(O)),O.attr("class","notice "+o[x.type]).children("p").html(x.content),g("wait"===x.type?k:C)}else b=x,c=e("#dialogButtons").empty(),g(k),l.append(T),x.buttons&&(0===c.length&&(c=n("dialogButtons")),c.appendTo(l));else d(),b=x,r=n("dialogOverlay"),s=n("dialogHeader").text(x.title||a[p]),l=n("dialogContent"),u=n("dialogBox"),l.append(T),c=n("dialogButtons").appendTo(l),u.append(s).append(l),r.append(u).appendTo($body),$body.addClass("dialog-open");D||(s.attr("class",x.color+"-bg"),l.attr("class",x.color+"-border")),!D&&x.buttons&&e.each(x.buttons,function(t,n){var i=e.mk("input").attr({type:"button","class":x.color+"-bg"});"function"==typeof n?n={action:n}:n.form&&(q=e("#"+n.form),1===q.length&&(i.on("click",function(){q.find("input[type=submit]").trigger("click")}),q.prepend(e.mk("input").attr("type","submit").hide()))),i.val(t).on("keydown",function(t){if(-1!==[Key.Enter,Key.Space].indexOf(t.keyCode))t.preventDefault(),i.trigger("click");else if([Key.Tab,Key.LeftArrow,Key.RightArrow].includes(t.keyCode)){t.preventDefault();var n=c.children(),o=n.filter(":focus"),a=l.find(":input");e.isKey(Key.LeftArrow,t)&&(t.shiftKey=!0),o.length?t.shiftKey?o.prev().length?o.prev().focus():e.isKey(Key.Tab,t)&&(a.length>0?a:n).filter(":visible").last().focus():o.next().length?o.next().focus():e.isKey(Key.Tab,t)&&a.add(n).filter(":visible").first().focus():a.add(n)[t.shiftKey?"last":"first"]().focus()}}).on("click",function(t){t.preventDefault(),e.callCallback(n.action,[t])}),c.append(i)}),m.center(),y(),e.callCallback(K,[q])}function v(n){return m.isOpen()?(r.remove(),b=t,p(),e.callCallback(n),void $body.removeClass("dialog-open")):e.callCallback(n,!1)}var b=l.length?{}:t,m={isOpen:function(){return"object"==typeof b}};m.fail=function(e,t,n){h("fail",e,t,{Close:function(){v()}},n)},m.success=function(e,n,i,o){h("success",e,n,i===!0?{Close:function(){v()}}:t,o)},m.wait=function(t,n,i){"function"==typeof n&&"undefined"===i&&(i=n),("string"!=typeof n||n.length<2)&&(n="Sending request");var o=e.capitalize(n)+"&hellip;";h("wait",t,o,i)},m.request=function(e,n,i,o,a){"function"==typeof o&&"undefined"==typeof a&&(a=o,o=t);var f={};i&&(f[o||"Submit"]={submit:!0,form:i}),f.Cancel=function(){v()},h("request",e,n,f,a)},m.confirm=function(t,n,i,o){"function"==typeof i&&"undefined"==typeof o&&(o=i),"function"!=typeof o&&(o=function(){v()}),e.isArray(i)||(i=["Eeyup","Nope"]);var a={};a[i[0]]=function(){o(!0)},a[i[1]]=function(){o(!1),v.call()},h("confirm",t,n,a)},m.info=function(e,t,n){h("info",e,t,{Close:function(){v()}},n)};var w;m.setFocusedElement=function(e){e instanceof jQuery&&(w=e)};var k=!0,C=!1;return m.close=function(){v.apply(m,arguments)},m.center=function(){if("undefined"!=typeof b){var e={w:r.width(),h:r.height()},t={w:u.outerWidth(!0),h:u.outerHeight(!0)};u.css({top:Math.max((e.h-t.h)/2,0),left:Math.max((e.w-t.w)/2,0)})}},m}(),$w.on("resize",e.Dialog.center),$body.on("keydown",function(t){if(!e.Dialog.isOpen()||t.keyCode!==Key.Tab)return!0;var n=l.find(":input"),i=n.filter(t.target),o=n.index(i);if(0===i.length)t.preventDefault(),n.first().focus();else if(t.shiftKey)if(0===o)t.preventDefault(),c.find(":last").focus();else{var a=i.parent();if(!a.is(c))return!0;a.children().first().is(i)&&(t.preventDefault(),n.eq(n.index(i)-1).focus())}})}(jQuery);
//# sourceMappingURL=dialog.min.js.map
