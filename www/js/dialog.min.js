!function(e,t){function o(e,t,o,n){return{color:e,draggable:"undefined"==typeof t?!1:t,overlay:"undefined"==typeof o?!0:o,closeButton:"undefined"==typeof n?!1:n}}function n(){return e(document.createElement("div"))}var i,f,a,s,r,u=e("html"),c={fail:o("red"),success:o("green"),wait:o("blue"),request:o("yellow",!0),confirm:o("orange"),info:o("darkblue")},l={fail:"Error",success:"Success",wait:"Sending request",request:"Input required",confirm:"Confirmation",info:"Info"},d={fail:"There was an issue while processing the request.",success:"Whatever you just did, it was completed successfully.",request:"The request did not require any additional info.",confirm:"Are you sure?",info:"No message provided."},p={fail:{color:"#E11"},success:{color:"#128023"},wait:{color:"#4390df"},request:{color:"#c29008"},confirm:{color:"#bf5a15"},info:{color:"#16499a"}},g=e(window);e.Dialog={open:t,fail:function(t,o,n){e.Dialog.display("fail",t,o,{Close:{action:function(){e.Dialog.close()}}},n)},success:function(o,n,i,f){e.Dialog.display("success",o,n,i===!0?{Close:{action:function(){e.Dialog.close()}}}:t,f)},wait:function(t,o,n){"function"==typeof o&&"undefined"===n&&(n=o),("string"!=typeof o||o.length<2)&&(o="Sending request"),e.Dialog.display("wait",t,o[0].toUpperCase()+o.substring(1)+"...",n)},request:function(t,o,n,i,f){"function"==typeof i&&"undefined"==typeof f&&(f=i,i="ElkÃ¼ld");var a={};a[i]={submit:!0,form:n},a.Cancel={action:function(){e.Dialog.close()}},e.Dialog.display("request",t,o,a,f)},confirm:function(t,o,n,i){"function"==typeof n&&"undefined"==typeof i&&(i=n),"function"!=typeof i&&(i=new Function),e.isArray(n)||(n=["Eeyup","Nope"]);var f={};f[n[0]]={action:function(){i(!0)}},f[n[1]]={action:function(){i(!1),e.Dialog.close()}},e.Dialog.display("confirm",t,o,f)},info:function(t,o,n){e.Dialog.display("info",t,o,{Close:{action:function(){e.Dialog.close()}}},n)},display:function(o,y,h,v,m,w){function b(){var o=e(":focus");o.length>0?window._focusedElement=o.last():window._focusedElement=t;var n=e("#dialogContent").find("input,select,textarea").filter(":visible"),i=e("#dialogButtons").children();n.length>0?n.first().focus():i.length>0&&i.first().focus()}function D(c){var d=n();if(c===!0)i=e("#dialogOverlay"),s=e("#dialogBox"),a=e("#dialogHeader"),f=e("#dialogContent"),r=e("#dialogButtons"),"string"==typeof m.title&&a.text(m.title),f.find("input, select, textarea").attr("disabled",!0),"object"==typeof p[o]&&d.css(p[o]),f.append(d.html(m.content)),m.buttons&&0===r.length?r=n().attr("id","dialogButtons").insertAfter(f):m.buttons||0===r.length?r.empty():r.remove(),s.stop(),setTimeout(function(){s.css({left:(g.width()-s.outerWidth())/2,top:(g.height()-s.outerHeight())/2,opacity:1})},10);else{i=n().attr("id","dialogOverlay"),a=n().attr("id","dialogHeader").text(m.title||l[o]),f=n().attr("id","dialogContent"),s=n().attr("id","dialogBox"),d.html(m.content),"object"==typeof p[o]&&d.css(p[o]),f.append(d),s.append(a).append(f),m.buttons&&(r=n().attr("id","dialogButtons").insertAfter(f)),i.appendTo(document.body).css("opacity",.5).show(),s.css("opacity",0).appendTo(i);var y=g.height()-s.outerHeight(),h=g.width()-s.outerWidth();s.css({top:y/2,left:h/2,opacity:1}),b(),i.fadeTo(350,1);var v=u.css("overflow");u.attr("data-overflow",v).css("overflow","hidden")}a.attr("class",m.color+"-bg"),m.buttons&&e.each(m.buttons,function(o,n){var i=e(document.createElement("input"));if(n.submit?i.attr("type","submit"):i.attr("type","button"),i.attr("class",m.color+"-bg"),n.form){var a=e("#"+n.form);1==a.length&&(i.click(function(){a.find("input[type=submit]").trigger("click")}),a.prepend(e(document.createElement("input")).attr("type","submit").hide()))}i.val(o).on("keydown",function(e){if(-1!==[13,32].indexOf(e.keyCode))e.preventDefault(),e.stopPropagation(),i.trigger("click");else if(9===e.keyCode){e.preventDefault(),e.stopPropagation();var t=r.children(),o=t.filter(":focus"),n=f.find(":input");o.length?e.shiftKey?o.prev().length?o.prev().focus():(n.length>0?n:t).last().focus():o.next().length?o.next().focus():n.add(t).first().focus():n.add(t)[e.shiftKey?"last":"first"]().focus()}}).on("click",function(o){o.preventDefault(),o.stopPropagation(),"function"==typeof n.action&&n.action(o),"close"===n.type&&e.Dialog.close("function"==typeof n.callback?n.callback:t)}),r.append(i)}),s.css({top:(g.height()-s.outerHeight())/2,left:(g.width()-s.outerWidth())/2}),m.draggable&&a.css("cursor","move").on("mousedown",function(e){e.preventDefault(),e.stopPropagation();var t=s.outerHeight(),o=s.outerWidth(),n=s.offset().top+t-e.pageY,f=s.offset().left+o-e.pageX;i.on("mousemove",function(e){var i=e.pageY>0?e.pageY+n-t:0,a=e.pageX>0?e.pageX+f-o:0;i>=0&&i<=window.innerHeight+e.pageY&&s.offset({top:i}),a>=0&&a<=window.innerWidth+e.pageY&&s.offset({left:a})})}).on("click",function(e){e.preventDefault(),e.stopPropagation(),i.off("mousemove")}),b(),"function"==typeof w&&w()}if("string"!=typeof o||"undefined"==typeof c[o])throw new TypeError("Invalid dialog type: "+typeof o);"function"==typeof v&&"undefined"==typeof m&&"undefined"==typeof w?w=v:"object"==typeof v&&"function"==typeof m&&"undefined"==typeof w&&(w=m),"undefined"==typeof m&&(m={}),"undefined"==typeof y?y=l[o]:y===!1&&(y=t),"undefined"==typeof h&&(h=d[o]),m=e.extend(!0,{type:o,title:y,content:h,buttons:v},c[o],m),"undefined"==typeof e.Dialog.open?(e.Dialog.open=m,D()):D(!!e.Dialog.open)},close:function(t){if("undefined"==typeof e.Dialog.open)return"function"==typeof t?t():!1;i.fadeOut(350,function(){e.Dialog.open=void 0,e(this).remove(),window._focusedElement instanceof jQuery&&window._focusedElement.focus(),"function"==typeof t&&t()});var o=u.attr("data-overflow");"undefined"!=typeof o&&(u.css("overflow",o),u.removeAttr("data-overflow"))}},g.on("resize",function(){"undefined"!=typeof e.Dialog.open&&(s.css("top",(g.height()-s.outerHeight())/2),s.css("left",(g.width()-s.outerWidth())/2))}).on("ajaxerror",function(){e.Dialog.fail(!1,"There was an error while processing your request. You may find additional details in the browser's console.")}),e(document.body).on("keydown",function(t){if(9===t.keyCode&&"undefined"!=typeof e.Dialog.open){var o=e(t.target),n=e("#dialogContent").find(":input"),i=o.index("#dialogContent :input");t.shiftKey&&0===i?(t.preventDefault(),e("#dialogButtons").find(":last").focus()):1!==n.filter(":focus").length&&(t.preventDefault(),n.first().focus())}})}(jQuery);