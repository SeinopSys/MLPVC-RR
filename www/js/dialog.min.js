"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}();!function(e,t){var o={fail:"red",success:"green",wait:"blue",request:"",confirm:"orange",info:"darkblue"},i={fail:"fail",success:"success",wait:"info",request:"warn",confirm:"caution",info:"info"},n={fail:"Error",success:"Success",wait:"Sending request",request:"Input required",confirm:"Confirmation",info:"Info"},s={fail:"There was an issue while processing the request.",success:"Whatever you just did, it was completed successfully.",request:"The request did not require any additional info.",confirm:"Are you sure?",info:"No message provided."},l=function(){function l(){_classCallCheck(this,l),this.$dialogOverlay=e("#dialogOverlay"),this.$dialogContent=e("#dialogContent"),this.$dialogHeader=e("#dialogHeader"),this.$dialogBox=e("#dialogBox"),this.$dialogWrap=e("#dialogWrap"),this.$dialogScroll=e("#dialogScroll"),this.$dialogButtons=e("#dialogButtons"),this._open=this.$dialogContent.length?{}:t,this._CloseButton={Close:function(){e.Dialog.close()}},this._$focusedElement=t}return _createClass(l,[{key:"isOpen",value:function(){return"object"===_typeof(this._open)}},{key:"_display",value:function(l,a,d,r,u){if("string"!=typeof l||"undefined"==typeof o[l])throw new TypeError("Invalid dialog type: "+("undefined"==typeof l?"undefined":_typeof(l)));"function"==typeof r&&"function"!=typeof u&&(u=r,r=t);var f=!1;"boolean"==typeof u?(f=u,u=t):"boolean"==typeof r&&"undefined"==typeof u&&(f=r,r=t),"undefined"==typeof a?a=n[l]:a===!1&&(a=t),d||(d=s[l]);var c={type:l,title:a,content:d||s[l],buttons:r,color:o[l]},p=Boolean(this._open),h=e.mk("div").append(c.content),g=p&&"request"===this._open.type&&["fail","wait"].includes(c.type),y=void 0;if(c.color.length&&h.addClass(c.color),p)if(this.$dialogOverlay=e("#dialogOverlay"),this.$dialogBox=e("#dialogBox"),this.$dialogHeader=e("#dialogHeader"),"string"==typeof c.title&&this.$dialogHeader.text(c.title),this.$dialogContent=e("#dialogContent"),g&&!f){y=this.$dialogContent.children(":not(#dialogButtons)").last();var v=y.children(".notice");v.length||(v=e.mk("div").append(e.mk("p")),y.append(v)),v.attr("class","notice "+i[c.type]).children("p").html(c.content).show(),this._controlInputs("wait"===c.type)}else this._open=c,this.$dialogButtons=e("#dialogButtons").empty(),this._controlInputs(!0),this.$dialogContent.append(h),c.buttons&&(0===this.$dialogButtons.length&&(this.$dialogButtons=e.mk("div","dialogButtons")),this.$dialogButtons.appendTo(this.$dialogContent));else this._storeFocus(),this._open=c,this.$dialogOverlay=e.mk("div","dialogOverlay"),this.$dialogHeader=e.mk("div","dialogHeader").text(c.title||n[l]),this.$dialogContent=e.mk("div","dialogContent"),this.$dialogBox=e.mk("div","dialogBox"),this.$dialogScroll=e.mk("div","dialogScroll"),this.$dialogWrap=e.mk("div","dialogWrap"),this.$dialogContent.append(h),this.$dialogButtons=e.mk("div","dialogButtons").appendTo(this.$dialogContent),this.$dialogBox.append(this.$dialogHeader).append(this.$dialogContent),this.$dialogOverlay.append(this.$dialogScroll.append(this.$dialogWrap.append(this.$dialogBox))).appendTo($body),$body.addClass("dialog-open");!g&&c.color&&(this.$dialogHeader.attr("class",c.color+"-bg"),this.$dialogContent.attr("class",c.color+"-border"));var $=this;!g&&c.buttons&&e.each(c.buttons,function(t,o){var i=e.mk("input").attr({type:"button","class":c.color+"-bg"});"function"==typeof o?o={action:o}:o.form&&(y=e("#"+o.form),1===y.length&&(i.on("click",function(){y.find("input[type=submit]").first().trigger("click")}),y.prepend(e.mk("input").attr("type","submit").hide()))),i.val(t).on("keydown",function(t){if([Key.Enter,Key.Space].includes(t.keyCode))t.preventDefault(),i.trigger("click");else if([Key.Tab,Key.LeftArrow,Key.RightArrow].includes(t.keyCode)){t.preventDefault();var o=$.$dialogButtons.children(),n=o.filter(":focus"),s=$.$dialogContent.find(":input");e.isKey(Key.LeftArrow,t)&&(t.shiftKey=!0),n.length?t.shiftKey?n.prev().length?n.prev().focus():e.isKey(Key.Tab,t)&&(s.length>0?s:o).filter(":visible").last().focus():n.next().length?n.next().focus():e.isKey(Key.Tab,t)&&s.add(o).filter(":visible").first().focus():s.add(o)[t.shiftKey?"last":"first"]().focus()}}).on("click",function(t){t.preventDefault(),e.callCallback(o.action,[t])}),$.$dialogButtons.append(i)}),this._setFocus(),$w.trigger("dialog-opened"),e.callCallback(u,[y])}},{key:"fail",value:function(e,t,o){this._display("fail",e,t,this._CloseButton,o===!0)}},{key:"success",value:function(e,o,i,n){this._display("success",e,o,i===!0?this._CloseButton:t,n)}},{key:"wait",value:function(o,i,n){"boolean"==typeof i&&"undefined"==typeof n&&(n=i,i=t),"string"!=typeof i&&(i="Sending request"),this._display("wait",o,e.capitalize(i)+"&hellip;",n===!0)}},{key:"request",value:function(e,o,i,n){"function"==typeof i&&"undefined"==typeof n&&(n=i,i=t);var s={},l=void 0;if(o instanceof jQuery)l=o.attr("id");else{var a=o.match(/<form\sid=["']([^"']+)["']/);a&&(l=a[1])}i!==!1?(l&&(s[i||"Submit"]={submit:!0,form:l}),s.Cancel=this._CloseButton.Close):s.Close={action:this._CloseButton.Close,form:l},this._display("request",e,o,s,n)}},{key:"confirm",value:function(t,o,i,n){"function"==typeof i&&"undefined"==typeof n&&(n=i),"function"!=typeof n&&(n=this._CloseButton.Close),e.isArray(i)||(i=["Eeyup","Nope"]);var s={},l=this;s[i[0]]=function(){n(!0)},s[i[1]]=function(){n(!1),l._CloseButton.Close()},this._display("confirm",t,o,s)}},{key:"info",value:function(e,t,o){this._display("info",e,t,this._CloseButton,o)}},{key:"setFocusedElement",value:function(e){e instanceof jQuery&&(this._$focusedElement=e)}},{key:"_storeFocus",value:function(){if(!("undefined"!=typeof this._$focusedElement&&this._$focusedElement instanceof jQuery)){var o=e(":focus");this._$focusedElement=o.length>0?o.last():t}}},{key:"_restoreFocus",value:function(){"undefined"!=typeof this._$focusedElement&&this._$focusedElement instanceof jQuery&&(this._$focusedElement.focus(),this._$focusedElement=t)}},{key:"_setFocus",value:function(){var e=this.$dialogContent.find("input,select,textarea").filter(":visible"),t=this.$dialogButtons.children();e.length>0?e.first().focus():t.length>0&&t.first().focus()}},{key:"_controlInputs",value:function(e){var t=this.$dialogContent.children(":not(#dialogButtons)").last().add(this.$dialogButtons).find("input, button, select, textarea");e?t.filter(":not(:disabled)").addClass("temp-disable").disable():t.filter(".temp-disable").removeClass("temp-disable").enable()}},{key:"close",value:function(o){return this.isOpen()?(this.$dialogOverlay.remove(),this._open=t,this._restoreFocus(),e.callCallback(o),void $body.removeClass("dialog-open")):e.callCallback(o,!1)}},{key:"clearNotice",value:function(e){var t=this.$dialogContent.find(".notice");return!!t.length&&(!("undefined"!=typeof e&&!e.test(t.html()))&&(t.hide(),this._controlInputs(!1),!0))}}]),l}();e.Dialog=new l,$body.on("keydown",function(t){if(!e.Dialog.isOpen()||t.keyCode!==Key.Tab)return!0;var o=e.Dialog.$dialogContent.find(":input"),i=o.filter(t.target),n=o.index(i);if(0===i.length)t.preventDefault(),o.first().focus();else if(t.shiftKey)if(0===n)t.preventDefault(),e.Dialog.$dialogButtons.find(":last").focus();else{var s=i.parent();if(!s.is(e.Dialog.$dialogButtons))return!0;s.children().first().is(i)&&(t.preventDefault(),o.eq(o.index(i)-1).focus())}})}(jQuery);
//# sourceMappingURL=/js/dialog.min.js.map
