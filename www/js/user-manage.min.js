$(function(){if(null!=typeof window.ROLES){var e=$(window),o=window.ROLES,t=$("#content").children("h1"),n=t.text(),r=t.next(),l=r.children("span").text(),a=$(document.createElement("form")).attr("id","rolemod").html('<select name=newrole required><optgroup label="Possible roles"></optgroup></select>'),i=a.find("optgroup");$.each(o,function(e,o){i.append("<option value="+e+">"+o+"</option>")});var c=i.children().filter(function(){return $(this).text()===l});1===c.length?c.attr("selected",!0):i.parent().prepend('<option value="" selected style=display:none>Select a group!</option>'),$("#change-role").on("click",function(){var t="Change group";$.Dialog.request(t,a.clone(),"rolemod","Change",function(){$("#rolemod").on("submit",function(a){a.preventDefault();var i=$(this).serializeArray(),c={};$.each(i,function(e,o){c[o.name]=o.value}),$.Dialog.wait(t,"Moving user to the new group"),$.ajax({method:"POST",url:"/u/newgroup/"+n,data:c,success:function(n){return"object"!=typeof n?console.log(n)&&e.trigger("ajaxerror"):void(n.status?(r.children("span").text(l=o[n.ng]),$.Dialog.close()):$.Dialog.fail(t,n.message))}})})})})}});