$(function(){if(null!=typeof window.ROLES){var e=$(window),t=$("#content"),o=window.ROLES,n=t.children("h1"),r=n.text(),a=t.find(".avatar-wrap").children(".badge"),i=n.next(),l=i.children("span").text(),c=$(document.createElement("form")).attr("id","rolemod").html('<select name=newrole required><optgroup label="Possible roles"></optgroup></select>'),u=c.find("optgroup");$.each(o,function(e,t){u.append("<option value="+e+">"+t+"</option>")}),$("#change-role").on("click",function(){var t="Change group";$.Dialog.request(t,c.clone(),"rolemod","Change",function(){$("#rolemod").on("submit",function(n){n.preventDefault();var c=$(this).serializeArray(),u={};$.each(c,function(e,t){u[t.name]=t.value}),$.Dialog.wait(t,"Moving user to the new group"),$.ajax({method:"POST",url:"/u/newgroup/"+r,data:u,success:function(n){return"object"!=typeof n?console.log(n)&&e.trigger("ajaxerror"):void(n.status?(i.children("span").text(l=o[n.ng]),a.text(n.badge),$.Dialog.close()):$.Dialog.fail(t,n.message))}})}).find("optgroup").children().filter(function(){return $(this).text()===l}).attr("selected",!0)})})}});