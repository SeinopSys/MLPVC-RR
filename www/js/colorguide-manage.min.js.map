{"version":3,"sources":["colorguide-manage.js"],"names":["$","copyToClipboard","text","document","queryCommandSupported","prompt","$helper","createElement","success","css","opacity","width","height","position","left","top","display","appendTo","focus","get","select","execCommand","e","Dialog","fail","setTimeout","remove","Color","window","color","TAG_TYPES_ASSOC","find","on","info","next","$tagEditForm","attr","append","$_typeSelect","each","type","label","children","ctxmenu","addItem","this","icon","click","$tag","tagName","trim","tagID","match","title","wait","post","data","console","log","$w","trigger","status","request","clone","$form","$this","val","preventDefault","tempdata","serializeArray","i","el","name","value","$affected","tid","qtip","removeAttr","tooltips","close","message","$li","closest","ponyID","replace","ponyName","center","parent","prevAll","triggerHandler","$el","first","off","innerHTML","default","triggerItem"],"mappings":"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","file":"colorguide-manage.min.js","sourcesContent":["$(function(){\r\n\tvar Color = window.Color, color = window.color, TAG_TYPES_ASSOC = window.TAG_TYPES_ASSOC;\r\n\r\n\tfunction copyToClipboard(text){\r\n\t\tif (!document.queryCommandSupported('copy')){\r\n\t\t\tprompt('Copy with Ctrl+C, close with Enter', text);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tvar $helper = $(document.createElement('textarea')),\r\n\t\t\tsuccess = false;\r\n\t\t$helper\r\n\t\t\t.css({\r\n\t\t\t\topacity: 0,\r\n\t\t\t\twidth: 0,\r\n\t\t\t\theight: 0,\r\n\t\t\t\tposition: 'absolute',\r\n\t\t\t\tleft: '-10px',\r\n\t\t\t\ttop: '-10px',\r\n\t\t\t\tdisplay: 'block',\r\n\t\t\t})\r\n\t\t\t.text(text)\r\n\t\t\t.appendTo('body')\r\n\t\t\t.focus();\r\n\t\t$helper.get(0).select();\r\n\r\n\t\ttry {\r\n\t\t\tsuccess = document.execCommand('copy');\r\n\t\t} catch(e){}\r\n\r\n\t\tif (!success)\r\n\t\t\t$.Dialog.fail('Copy to clipboard', 'Copying text to clipboard failed!');\r\n\t\tsetTimeout(function(){\r\n\t\t\t$helper.remove();\r\n\t\t}, 1);\r\n\t}\r\n\r\n\t$('#list').find('button.edit').on('click',function(){\r\n\t\t$.Dialog.info('Edit mode triggered', 'yay');\r\n\t}).next().on('click',function(){\r\n\t\t// TODO Confirmation\r\n\t\t$.Dialog.info('Delete pony triggered', 'yay');\r\n\t});\r\n\r\n\tvar $tagEditForm = $(document.createElement('form')).attr('id', 'edit-tag');\r\n\t$tagEditForm\r\n\t\t.append('<label><span>Tag name (4-30 chars.)</span><input type=text name=name required pattern=^.{4,30}$ maxlength=30></label>');\r\n\tvar $_typeSelect = $(document.createElement('select')).attr('name', 'type');\r\n\t$_typeSelect.append('<option value=\"\" selected>No special type</option>');\r\n\t$.each(TAG_TYPES_ASSOC,function(type, label){\r\n\t\t$_typeSelect.append('<option value='+type+'>'+label+'</option>');\r\n\t});\r\n\t$tagEditForm.append($(document.createElement('label')).append('<span>Tag type</span><br>',$_typeSelect));\r\n\t$tagEditForm.append($(document.createElement('label')).append('<span>Tag description (max 255 chars., optional)</span><br><textarea name=title maxlength=255></textarea>'));\r\n\r\n\t$('.tags').children().each(function(){\r\n\t\t$.ctxmenu.addItem($(this), {text: 'Edit tag', icon: 'pencil', click: function(){\r\n\t\t\tvar $tag = $(this),\r\n\t\t\t\ttagName = $tag.text().trim(),\r\n\t\t\t\ttagID = $tag.attr('class').match(/tag\\-(\\d+)(?:\\s|$)/)[1],\r\n\t\t\t\ttitle = 'Editing tag: '+tagName;\r\n\r\n\t\t\t$.Dialog.wait(title, 'Retrieveing tag details from server');\r\n\r\n\t\t\t$.post('/colorguide/gettag/'+tagID,{},function(data){\r\n\t\t\t\tif (typeof data !== 'object') return console.log(data) && $w.trigger('ajaxerror');\r\n\r\n\t\t\t\tif (data.status){\r\n\t\t\t\t\t$.Dialog.request(title,$tagEditForm.clone(),'edit-tag','Save',function(){\r\n\t\t\t\t\t\tvar $form = $('#edit-tag');\r\n\t\t\t\t\t\t$form.find('input[name], select[name], textarea[name]').each(function(){\r\n\t\t\t\t\t\t\tvar $this = $(this);\r\n\t\t\t\t\t\t\t$this.val(data[$this.attr('name')]);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t$form.on('submit', function(e){\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t\tvar tempdata = $(this).serializeArray(), data = {};\r\n\t\t\t\t\t\t\t$.each(tempdata,function(i,el){\r\n\t\t\t\t\t\t\t\tdata[el.name] = el.value;\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$.Dialog.wait(title, 'Saving changes');\r\n\r\n\t\t\t\t\t\t\t$.post('/colorguide/settag/'+tagID,data,function(data){\r\n\t\t\t\t\t\t\t\tif (typeof data !== 'object') return console.log(data) && $w.trigger('ajaxerror');\r\n\r\n\t\t\t\t\t\t\t\tif (data.status){\r\n\t\t\t\t\t\t\t\t\tvar $affected = $('.tag-'+data.tid);\r\n\t\t\t\t\t\t\t\t\tconsole.log($affected);\r\n\t\t\t\t\t\t\t\t\t$affected.qtip('destroy', true);\r\n\t\t\t\t\t\t\t\t\tif (data.title) $affected.attr('title', data.title);\r\n\t\t\t\t\t\t\t\t\telse $affected.removeAttr('title');\r\n\t\t\t\t\t\t\t\t\t$affected\r\n\t\t\t\t\t\t\t\t\t\t.attr('class', 'tag-'+data.tid+' typ-'+data.type)\r\n\t\t\t\t\t\t\t\t\t\t.text(data.name);\r\n\t\t\t\t\t\t\t\t\twindow.tooltips();\r\n\t\t\t\t\t\t\t\t\t$.Dialog.close();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse $.Dialog.fail(title, data.message);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse $.Dialog.fail(title, data.message);\r\n\t\t\t})\r\n\t\t}},{text: 'Delete tag (TBI)', icon: 'trash', click: function(){\r\n\t\t\t$.Dialog.info('Delete tag triggred', 'yay');\r\n\t\t}}, true, {text: 'Create new tag', icon: 'plus', click: function(){\r\n\t\t\tvar title = 'Create new tag',\r\n\t\t\t\t$tag = $(this),\r\n\t\t\t\t$li = $tag.closest('li'),\r\n\t\t\t\tponyID = $li.attr('id').replace(/\\D/g, ''),\r\n\t\t\t\tponyName = $tag.closest('div:not([class])').children('strong').text().trim();\r\n\r\n\t\t\t$.Dialog.request(title,$tagEditForm.clone(),'edit-tag','Create',function(){\r\n\t\t\t\tvar $form = $('#edit-tag');\r\n\t\t\t\t$form.append(\r\n\t\t\t\t\t$(document.createElement('label'))\r\n\t\t\t\t\t\t.append('<input type=checkbox name=addto value='+ponyID+'> Add this tag to the appearance \"'+ponyName+'\" after creation')\r\n\t\t\t\t);\r\n\t\t\t\t$.Dialog.center();\r\n\t\t\t\t$form.on('submit', function(e){\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\tvar tempdata = $form.serializeArray(), data = {};\r\n\t\t\t\t\t$.each(tempdata,function(i,el){\r\n\t\t\t\t\t\tdata[el.name] = el.value;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$.Dialog.wait(title, 'Adding tag');\r\n\r\n\t\t\t\t\t$.post('/colorguide/maketag',data,function(data){\r\n\t\t\t\t\t\tif (typeof data !== 'object') return console.log(data) && $w.trigger('ajaxerror');\r\n\r\n\t\t\t\t\t\tif (data.status) $.Dialog.success(title, data.message, true);\r\n\t\t\t\t\t\telse $.Dialog.fail(title, data.message);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t}}, {text: 'Enable edit mode (TBI)', icon: 'edit', click: function(){\r\n\t\t\t$(this).parent().prevAll('strong').children('button.edit').triggerHandler('click');\r\n\t\t}});\r\n\t});\r\n\r\n\t$('ul.colors').children('li').ctxmenu(\r\n\t\t[\r\n\t\t\t{text: \"Edit \"+color+\" group (TBI)\", icon: 'pencil', click: function(){\r\n\t\t\t\t$.Dialog.info('Edit '+color+' group triggered', 'yay');\r\n\t\t\t}},\r\n\t\t\t{text: \"Delete \"+color+\" group (TBI)\", icon: 'trash', click: function(){\r\n\t\t\t\t// TODO Confirmation\r\n\t\t\t\t$.Dialog.info('Delete '+color+' group triggered', 'yay');\r\n\t\t\t}},\r\n\t\t\t{text: \"Add new group (TBI)\", icon: 'folder-add', click: function(){\r\n\t\t\t\t$.Dialog.info('Add new group triggered', 'yay');\r\n\t\t\t}},\r\n\t\t\t{text: \"Add new \"+color+' (TBI)', icon: 'plus', click: function(){\r\n\t\t\t\t$.Dialog.info('Add new color triggered', 'yay');\r\n\t\t\t}}\r\n\t\t],\r\n\t\tfunction($el){ return Color+' group: '+$el.children().first().text().trim().replace(':','') }\r\n\t).children('span:not(:first-child)').off('click').on('click',function(e){\r\n\t\te.preventDefault();\r\n\r\n\t\tcopyToClipboard(this.innerHTML.trim());\r\n\t}).ctxmenu(\r\n\t\t[\r\n\t\t\t{text: \"Copy \"+color, icon: 'clipboard', 'default': true, click: function(){\r\n\t\t\t\tcopyToClipboard(this.innerHTML.trim());\r\n\t\t\t}},\r\n\t\t\t{text: \"Edit \"+color+' (TBI)', icon: 'pencil (TBI)', click: function(){\r\n\t\t\t\t$.Dialog.info('Edit '+color+' triggered', 'yay');\r\n\t\t\t}},\r\n\t\t\ttrue,\r\n\t\t\t{text: \"Edit \"+color+\" group (TBI)\", icon: 'pencil', click: function(){\r\n\t\t\t\t$.ctxmenu.triggerItem($(this).parent(), 1);\r\n\t\t\t}},\r\n\t\t\t{text: \"Delete \"+color+\" group (TBI)\", icon: 'trash', click: function(){\r\n\t\t\t\t$.ctxmenu.triggerItem($(this).parent(), 2);\r\n\t\t\t}},\r\n\t\t\t{text: \"Add new group (TBI)\", icon: 'folder-add', click: function(){\r\n\t\t\t\t$.ctxmenu.triggerItem($(this).parent(), 3);\r\n\t\t\t}},\r\n\t\t\t{text: \"Add new \"+color+' (TBI)', icon: 'plus', click: function(){\r\n\t\t\t\t$.ctxmenu.triggerItem($(this).parent(), 4);\r\n\t\t\t}}\r\n\t\t],\r\n\t\tfunction($el){ return 'Color: '+$el.attr('oldtitle') }\r\n\t);\r\n});\r\n"],"sourceRoot":"/source/"}