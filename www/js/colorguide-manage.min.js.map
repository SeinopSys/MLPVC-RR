{"version":3,"sources":["colorguide-manage.js"],"names":["$","copyToClipboard","text","document","queryCommandSupported","prompt","$helper","createElement","success","css","opacity","width","height","position","left","top","display","appendTo","focus","get","select","execCommand","e","Dialog","fail","setTimeout","remove","reorder","$this","children","sort","a","b","regex","className","replace","innerHTML","trim","localeCompare","ctxmenus","$tags","ctxmenu","icon","click","$tag","this","tagName","tagID","attr","match","title","wait","post","data","console","log","$w","trigger","status","request","$tagEditForm","clone","$form","find","type","prop","each","val","on","preventDefault","tempdata","serializeArray","i","el","name","value","$affected","tid","qtip","removeAttr","parent","window","tooltips","close","message","confirm","sure","$li","closest","$div","$tagsDiv","ponyID","ponyName","append","center","tags","html","prevAll","triggerHandler","$el","$colorGroups","filter","color","info","Color","first","off","default","triggerItem","TAG_TYPES_ASSOC","next","$_typeSelect","addClass","label","$lbl","$chx","checked","siblings"],"mappings":"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","file":"colorguide-manage.min.js","sourcesContent":["$(function(){\r\n\tvar Color = window.Color, color = window.color, TAG_TYPES_ASSOC = window.TAG_TYPES_ASSOC, $colorGroups;\r\n\r\n\tfunction copyToClipboard(text){\r\n\t\tif (!document.queryCommandSupported('copy')){\r\n\t\t\tprompt('Copy with Ctrl+C, close with Enter', text);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tvar $helper = $(document.createElement('textarea')),\r\n\t\t\tsuccess = false;\r\n\t\t$helper\r\n\t\t\t.css({\r\n\t\t\t\topacity: 0,\r\n\t\t\t\twidth: 0,\r\n\t\t\t\theight: 0,\r\n\t\t\t\tposition: 'absolute',\r\n\t\t\t\tleft: '-10px',\r\n\t\t\t\ttop: '-10px',\r\n\t\t\t\tdisplay: 'block',\r\n\t\t\t})\r\n\t\t\t.text(text)\r\n\t\t\t.appendTo('body')\r\n\t\t\t.focus();\r\n\t\t$helper.get(0).select();\r\n\r\n\t\ttry {\r\n\t\t\tsuccess = document.execCommand('copy');\r\n\t\t} catch(e){}\r\n\r\n\t\tif (!success)\r\n\t\t\t$.Dialog.fail('Copy to clipboard', 'Copying text to clipboard failed!');\r\n\t\tsetTimeout(function(){\r\n\t\t\t$helper.remove();\r\n\t\t}, 1);\r\n\t}\r\n\r\n\t$('#list').find('button.edit').on('click',function(){\r\n\t\t$.Dialog.info('Edit mode triggered', 'yay');\r\n\t}).next().on('click',function(){\r\n\t\t// TODO Confirmation\r\n\t\t$.Dialog.info('Delete pony triggered', 'yay');\r\n\t});\r\n\r\n\tvar $tagEditForm = $(document.createElement('form')).attr('id', 'edit-tag');\r\n\t$tagEditForm\r\n\t\t.append('<label><span>Tag name (4-30 chars.)</span><input type=text name=name required pattern=^.{4,30}$ maxlength=30></label>');\r\n\tvar $_typeSelect = $(document.createElement('div')).addClass('type-selector');\r\n\t$.each(TAG_TYPES_ASSOC,function(type, label){\r\n\t\tvar $lbl = $(document.createElement('label')),\r\n\t\t\t$chx = $(document.createElement('input'))\r\n\t\t\t\t.attr({\r\n\t\t\t\t\ttype: 'checkbox',\r\n\t\t\t\t\tname: 'type',\r\n\t\t\t\t\tvalue: type\r\n\t\t\t\t}).on('click',function(){\r\n\t\t\t\t\tif (this.checked)\r\n\t\t\t\t\t\t$(this).parent().siblings().find('input').prop('checked', false);\r\n\t\t\t\t});\r\n\t\t$lbl.append($chx, $(document.createElement('span')).addClass('tag typ-'+type).text(label)).appendTo($_typeSelect);\r\n\t});\r\n\t$tagEditForm.append($(document.createElement('div')).addClass('align-center').append('<span>Tag type (optional)</span><br>',$_typeSelect));\r\n\t$tagEditForm.append($(document.createElement('label')).append('<span>Tag description (max 255 chars., optional)</span><br><textarea name=title maxlength=255></textarea>'));\r\n\r\n\tvar $tags = $('.tags');\r\n\tfunction reorder($this){\r\n\t\t$this.children().sort(function(a, b){\r\n\t\t\tvar regex = /^.*typ-([a-z]+).*$/;\r\n\t\t\ta = [a.className.replace(regex,'$1'), a.innerHTML.trim()],\r\n\t\t\tb = [b.className.replace(regex,'$1'), b.innerHTML.trim()];\r\n\r\n\t\t\tif (a[0] === b[0])\r\n\t\t\t\treturn a[1].localeCompare(b[1]);\r\n\t\t\treturn a[0].localeCompare(b[0]);\r\n\t\t}).appendTo($this);\r\n\t};\r\n\r\n\tfunction ctxmenus(){\r\n\t\t$tags.children(':not(.ctxmenu-bound)').ctxmenu([\r\n\t\t\t{text: 'Edit tag', icon: 'pencil', click: function(){\r\n\t\t\t\tvar $tag = $(this),\r\n\t\t\t\t\ttagName = $tag.text().trim(),\r\n\t\t\t\t\ttagID = $tag.attr('class').match(/id-(\\d+)(?:\\s|$)/)[1],\r\n\t\t\t\t\ttitle = 'Editing tag: '+tagName;\r\n\r\n\t\t\t\t$.Dialog.wait(title, 'Retrieveing tag details from server');\r\n\r\n\t\t\t\t$.post('/colorguide/gettag/'+tagID,{},function(data){\r\n\t\t\t\t\tif (typeof data !== 'object') return console.log(data) && $w.trigger('ajaxerror');\r\n\r\n\t\t\t\t\tif (data.status){\r\n\t\t\t\t\t\t$.Dialog.request(title,$tagEditForm.clone(true, true),'edit-tag','Save',function(){\r\n\t\t\t\t\t\t\tvar $form = $('#edit-tag');\r\n\t\t\t\t\t\t\t$form.find('input[name=type][value='+data.type+']').prop('checked', true);\r\n\t\t\t\t\t\t\t$form.find('input[type=text][name], textarea[name]').each(function(){\r\n\t\t\t\t\t\t\t\tvar $this = $(this);\r\n\t\t\t\t\t\t\t\t$this.val(data[$this.attr('name')]);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t$form.on('submit', function(e){\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t\t\tvar tempdata = $(this).serializeArray(), data = {};\r\n\t\t\t\t\t\t\t\t$.each(tempdata,function(i,el){\r\n\t\t\t\t\t\t\t\t\tdata[el.name] = el.value;\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$.Dialog.wait(title, 'Saving changes');\r\n\r\n\t\t\t\t\t\t\t\t$.post('/colorguide/settag/'+tagID,data,function(data){\r\n\t\t\t\t\t\t\t\t\tif (typeof data !== 'object') return console.log(data) && $w.trigger('ajaxerror');\r\n\r\n\t\t\t\t\t\t\t\t\tif (data.status){\r\n\t\t\t\t\t\t\t\t\t\tvar $affected = $('.id-'+data.tid);\r\n\t\t\t\t\t\t\t\t\t\t$affected.qtip('destroy', true);\r\n\t\t\t\t\t\t\t\t\t\tif (data.title) $affected.attr('title', data.title);\r\n\t\t\t\t\t\t\t\t\t\telse $affected.removeAttr('title');\r\n\t\t\t\t\t\t\t\t\t\t$affected\r\n\t\t\t\t\t\t\t\t\t\t\t.attr('class', 'tag id-'+data.tid+(data.type?' typ-'+data.type:''))\r\n\t\t\t\t\t\t\t\t\t\t\t.text(data.name);\r\n\t\t\t\t\t\t\t\t\t\t$affected.parent().each(function(){\r\n\t\t\t\t\t\t\t\t\t\t\treorder($(this));\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\twindow.tooltips();\r\n\t\t\t\t\t\t\t\t\t\t$.Dialog.close();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse $.Dialog.fail(title, data.message);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse $.Dialog.fail(title, data.message);\r\n\t\t\t\t})\r\n\t\t\t}},\r\n\t\t\t{text: 'Delete tag', icon: 'trash', click: function(){\r\n\t\t\t\tvar $tag = $(this),\r\n\t\t\t\t\ttagName = $tag.text().trim(),\r\n\t\t\t\t\ttagID = $tag.attr('class').match(/id-(\\d+)(?:\\s|$)/)[1],\r\n\t\t\t\t\ttitle = 'Detele tag: '+tagName;\r\n\r\n\t\t\t\t$.Dialog.confirm(title,\"By deleting this tag, it'll be removed from every appearance where it's been used.<br>Are you sure?\",['Delete it','Nope'],function(sure){\r\n\t\t\t\t\tif (!sure) return;\r\n\r\n\t\t\t\t\t$.Dialog.wait(title,'Sending removal request');\r\n\r\n\t\t\t\t\t$.post('/colorguide/deltag/'+tagID,{},function(data){\r\n\t\t\t\t\t\tif (typeof data !== 'object') return console.log(data) && $w.trigger('ajaxerror');\r\n\r\n\t\t\t\t\t\tif (data.status){\r\n\t\t\t\t\t\t\tvar $affected = $('.id-'+tagID);\r\n\t\t\t\t\t\t\t$affected.qtip('destroy', true);\r\n\t\t\t\t\t\t\t$affected.remove();\r\n\t\t\t\t\t\t\t$.Dialog.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse $.Dialog.fail(title,data.message);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}},\r\n\t\t\ttrue,\r\n\t\t\t{text: 'Create new tag', icon: 'plus', click: function(){\r\n\t\t\t\tvar title = 'Create new tag',\r\n\t\t\t\t\t$tag = $(this),\r\n\t\t\t\t\t$li = $tag.closest('li'),\r\n\t\t\t\t\t$div = $tag.closest('div:not([class])'),\r\n\t\t\t\t\t$tagsDiv = $div.children('.tags'),\r\n\t\t\t\t\tponyID = $li.attr('id').replace(/\\D/g, ''),\r\n\t\t\t\t\tponyName = $div.children('strong').text().trim();\r\n\r\n\t\t\t\t$.Dialog.request(title,$tagEditForm.clone(true, true),'edit-tag','Create',function(){\r\n\t\t\t\t\tvar $form = $('#edit-tag');\r\n\t\t\t\t\t$form.append(\r\n\t\t\t\t\t\t$(document.createElement('label'))\r\n\t\t\t\t\t\t\t.append('<input type=checkbox name=addto value='+ponyID+'> Add this tag to the appearance \"'+ponyName+'\" after creation')\r\n\t\t\t\t\t);\r\n\t\t\t\t\t$.Dialog.center();\r\n\t\t\t\t\t$form.on('submit', function(e){\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tvar tempdata = $form.serializeArray(), data = {};\r\n\t\t\t\t\t\t$.each(tempdata,function(i,el){\r\n\t\t\t\t\t\t\tdata[el.name] = el.value;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$.Dialog.wait(title, 'Creating tag');\r\n\r\n\t\t\t\t\t\t$.post('/colorguide/maketag',data,function(data){\r\n\t\t\t\t\t\t\tif (typeof data !== 'object') return console.log(data) && $w.trigger('ajaxerror');\r\n\r\n\t\t\t\t\t\t\tif (data.status){\r\n\t\t\t\t\t\t\t\tif (data.tags){\r\n\t\t\t\t\t\t\t\t\t$tagsDiv.children('[data-hasqtip]').qtip('destroy', true);\r\n\t\t\t\t\t\t\t\t\t$tagsDiv.html(data.tags);\r\n\t\t\t\t\t\t\t\t\twindow.tooltips();\r\n\t\t\t\t\t\t\t\t\tctxmenus();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t$.Dialog.close();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse $.Dialog.fail(title, data.message);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t}},\r\n\t\t\t{text: 'Enable edit mode (TBI)', icon: 'edit', click: function(){\r\n\t\t\t\t$(this).parent().prevAll('strong').children('button.edit').triggerHandler('click');\r\n\t\t\t}}\r\n\t\t], function($el){ return 'Tag: '+$el.text().trim() });\r\n\r\n\t\t$colorGroups = $('ul.colors').children('li');\r\n\t\t$colorGroups.filter(':not(.ctxmenu-bound)').ctxmenu(\r\n\t\t\t[\r\n\t\t\t\t{text: \"Edit \"+color+\" group (TBI)\", icon: 'pencil', click: function(){\r\n\t\t\t\t\t$.Dialog.info('Edit '+color+' group triggered', 'yay');\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Delete \"+color+\" group (TBI)\", icon: 'trash', click: function(){\r\n\t\t\t\t\t// TODO Confirmation\r\n\t\t\t\t\t$.Dialog.info('Delete '+color+' group triggered', 'yay');\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Add new group (TBI)\", icon: 'folder-add', click: function(){\r\n\t\t\t\t\t$.Dialog.info('Add new group triggered', 'yay');\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Add new \"+color+' (TBI)', icon: 'plus', click: function(){\r\n\t\t\t\t\t$.Dialog.info('Add new color triggered', 'yay');\r\n\t\t\t\t}}\r\n\t\t\t],\r\n\t\t\tfunction($el){ return Color+' group: '+$el.children().first().text().trim().replace(':','') }\r\n\t\t);\r\n\t\t$colorGroups.children('span:not(:first-child)').off('click').on('click',function(e){\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tcopyToClipboard(this.innerHTML.trim());\r\n\t\t}).filter(':not(.ctxmenu-bound)').ctxmenu(\r\n\t\t\t[\r\n\t\t\t\t{text: \"Copy \"+color, icon: 'clipboard', 'default': true, click: function(){\r\n\t\t\t\t\tcopyToClipboard(this.innerHTML.trim());\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Edit \"+color+' (TBI)', icon: 'pencil (TBI)', click: function(){\r\n\t\t\t\t\t$.Dialog.info('Edit '+color+' triggered', 'yay');\r\n\t\t\t\t}},\r\n\t\t\t\ttrue,\r\n\t\t\t\t{text: \"Edit \"+color+\" group (TBI)\", icon: 'pencil', click: function(){\r\n\t\t\t\t\t$.ctxmenu.triggerItem($(this).parent(), 1);\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Delete \"+color+\" group (TBI)\", icon: 'trash', click: function(){\r\n\t\t\t\t\t$.ctxmenu.triggerItem($(this).parent(), 2);\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Add new group (TBI)\", icon: 'folder-add', click: function(){\r\n\t\t\t\t\t$.ctxmenu.triggerItem($(this).parent(), 3);\r\n\t\t\t\t}},\r\n\t\t\t\t{text: \"Add new \"+color+' (TBI)', icon: 'plus', click: function(){\r\n\t\t\t\t\t$.ctxmenu.triggerItem($(this).parent(), 4);\r\n\t\t\t\t}}\r\n\t\t\t],\r\n\t\t\tfunction($el){ return 'Color: '+$el.attr('oldtitle') }\r\n\t\t);\r\n\t}\r\n\tctxmenus();\r\n\twindow.ctxmenus = function(){ctxmenus()};\r\n});\r\n"],"sourceRoot":"/source/"}